{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\utils\\hooks.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\utils\\hooks.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:KGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZW50ZXJNb2R1bGUgOiB1bmRlZmluZWQ7CiAgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsKfSkoKTsKCnZhciBfX3NpZ25hdHVyZV9fID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmRlZmF1bHQuc2lnbmF0dXJlIDogZnVuY3Rpb24gKGEpIHsKICByZXR1cm4gYTsKfTsKCi8qKgogKiDlhaznlKjnmoRob29rcyDlsIHoo4UKICovCmltcG9ydCBwcm9kdWNlIGZyb20gJ2ltbWVyJzsKaW1wb3J0IHsgaXNBcnJheSB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VSZWYsIHVzZUVmZmVjdCwgdXNlUmVkdWNlciwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IHN1YnNjcmliZSwgSGFuZGxlciB9IGZyb20gIi4vbWVzc2FnZSI7CmV4cG9ydCBmdW5jdGlvbiB1c2VJbW1lcihpbml0aWFsVmFsdWUpIHsKICB2YXIgW3ZhbCwgdXBkYXRlVmFsdWVdID0gdXNlU3RhdGUoaW5pdGlhbFZhbHVlKTsKICByZXR1cm4gW3ZhbCwgdXNlQ2FsbGJhY2sodXBkYXRlciA9PiB7CiAgICB1cGRhdGVWYWx1ZShwcm9kdWNlKHVwZGF0ZXIpKTsKICB9LCBbXSldOwp9CgpfX3NpZ25hdHVyZV9fKHVzZUltbWVyLCAidXNlU3RhdGV7W3ZhbCwgdXBkYXRlVmFsdWVdKGluaXRpYWxWYWx1ZSl9XG51c2VDYWxsYmFja3t9Iik7CgpleHBvcnQgZnVuY3Rpb24gdXNlSW1tZXJSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxTdGF0ZSwgaW5pdGlhbEFjdGlvbikgewogIHZhciBjYWNoZWRSZWR1Y2VyID0gdXNlQ2FsbGJhY2socHJvZHVjZShyZWR1Y2VyKSwgW3JlZHVjZXJdKTsKICByZXR1cm4gdXNlUmVkdWNlcihjYWNoZWRSZWR1Y2VyLCBpbml0aWFsU3RhdGUsIGluaXRpYWxBY3Rpb24pOwp9CgpfX3NpZ25hdHVyZV9fKHVzZUltbWVyUmVkdWNlciwgInVzZUNhbGxiYWNre2NhY2hlZFJlZHVjZXJ9XG51c2VSZWR1Y2Vyeyhpbml0aWFsU3RhdGUpfSIpOwoKZXhwb3J0IGZ1bmN0aW9uIHVzZVN1YnNjcmliZXIoa2V5LCBoYW5kbGVyKSB7CiAgdmFyIGRlcHMgPSBpc0FycmF5KGtleSkgPyBrZXkgOiBba2V5XTsKICB1c2VFZmZlY3QoKCkgPT4gewogICAgdmFyIHsKICAgICAgdW5zdWJzY3JpYmUKICAgIH0gPSBzdWJzY3JpYmUoa2V5LCBoYW5kbGVyKTsKICAgIHJldHVybiB1bnN1YnNjcmliZTsKICB9LCBkZXBzKTsKfQoKX19zaWduYXR1cmVfXyh1c2VTdWJzY3JpYmVyLCAidXNlRWZmZWN0e30iKTsKCmV4cG9ydCBmdW5jdGlvbiB1c2VQZXJzaXN0Rm4oZm4pIHsKICB2YXIgcmVmID0gdXNlUmVmKCgpID0+IHsKICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNhbGwgZnVuY3Rpb24gd2hpbGUgcmVuZGVyaW5nLicpOwogIH0pOwogIHJlZi5jdXJyZW50ID0gZm47CiAgdmFyIHBlcnNpc3RGbiA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiByZWYuY3VycmVudCguLi5hcmd1bWVudHMpOwogIH0sIFtyZWZdKTsKICByZXR1cm4gcGVyc2lzdEZuOwp9CgpfX3NpZ25hdHVyZV9fKHVzZVBlcnNpc3RGbiwgInVzZVJlZntyZWZ9XG51c2VDYWxsYmFja3twZXJzaXN0Rm59Iik7Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciByZWFjdEhvdExvYWRlciA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5kZWZhdWx0IDogdW5kZWZpbmVkOwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3Rlcih1c2VJbW1lciwgInVzZUltbWVyIiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcdXRpbHNcXGhvb2tzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIodXNlSW1tZXJSZWR1Y2VyLCAidXNlSW1tZXJSZWR1Y2VyIiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcdXRpbHNcXGhvb2tzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIodXNlU3Vic2NyaWJlciwgInVzZVN1YnNjcmliZXIiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFx1dGlsc1xcaG9va3MuanMiKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3Rlcih1c2VQZXJzaXN0Rm4sICJ1c2VQZXJzaXN0Rm4iLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFx1dGlsc1xcaG9va3MuanMiKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmxlYXZlTW9kdWxlIDogdW5kZWZpbmVkOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/utils/hooks.js"],"names":["produce","isArray","useCallback","useRef","useEffect","useReducer","useState","subscribe","Handler","useImmer","initialValue","val","updateValue","updater","useImmerReducer","reducer","initialState","initialAction","cachedReducer","useSubscriber","key","handler","deps","unsubscribe","usePersistFn","fn","ref","Error","current","persistFn"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA,OAAOA,OAAP,MAAoB,OAApB;AACA,SAASC,OAAT,QAAwB,QAAxB;AACA,SAASC,WAAT,EAAsBC,MAAtB,EAA8BC,SAA9B,EAAyCC,UAAzC,EAAqDC,QAArD,QAAqE,OAArE;AACA,SAASC,SAAT,EAAoBC,OAApB,QAAmC,WAAnC;AACA,OAAO,SAASC,QAAT,CAAkBC,YAAlB,EAAgC;AACnC,MAAM,CAACC,GAAD,EAAMC,WAAN,IAAqBN,QAAQ,CAACI,YAAD,CAAnC;AACA,SAAO,CACHC,GADG,EAEHT,WAAW,CAAEW,OAAD,IAAa;AACrBD,IAAAA,WAAW,CAACZ,OAAO,CAACa,OAAD,CAAR,CAAX;AACH,GAFU,EAER,EAFQ,CAFR,CAAP;AAMH;;cAReJ,Q;;AAShB,OAAO,SAASK,eAAT,CAAyBC,OAAzB,EAAkCC,YAAlC,EAAgDC,aAAhD,EAA+D;AAClE,MAAMC,aAAa,GAAGhB,WAAW,CAACF,OAAO,CAACe,OAAD,CAAR,EAAmB,CAACA,OAAD,CAAnB,CAAjC;AACA,SAAOV,UAAU,CAACa,aAAD,EAAgBF,YAAhB,EAA8BC,aAA9B,CAAjB;AACH;;cAHeH,e;;AAIhB,OAAO,SAASK,aAAT,CAAuBC,GAAvB,EAA4BC,OAA5B,EAAqC;AACxC,MAAMC,IAAI,GAAGrB,OAAO,CAACmB,GAAD,CAAP,GAAeA,GAAf,GAAqB,CAACA,GAAD,CAAlC;AACAhB,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAM;AAAEmB,MAAAA;AAAF,QAAkBhB,SAAS,CAACa,GAAD,EAAMC,OAAN,CAAjC;AACA,WAAOE,WAAP;AACH,GAHQ,EAGND,IAHM,CAAT;AAIH;;cANeH,a;;AAOhB,OAAO,SAASK,YAAT,CAAsBC,EAAtB,EAA0B;AAC7B,MAAMC,GAAG,GAAGvB,MAAM,CAAC,MAAM;AACrB,UAAM,IAAIwB,KAAJ,CAAU,uCAAV,CAAN;AACH,GAFiB,CAAlB;AAGAD,EAAAA,GAAG,CAACE,OAAJ,GAAcH,EAAd;AACA,MAAMI,SAAS,GAAG3B,WAAW,CAAE;AAAA,WAAawB,GAAG,CAACE,OAAJ,CAAY,YAAZ,CAAb;AAAA,GAAF,EAAsC,CAACF,GAAD,CAAtC,CAA7B;AACA,SAAOG,SAAP;AACH;;cAPeL,Y;;;;;;;;;;;0BApBAf,Q;0BASAK,e;0BAIAK,a;0BAOAK,Y","sourcesContent":["/**\n * 公用的hooks 封装\n */\nimport produce from 'immer';\nimport { isArray } from 'lodash';\nimport { useCallback, useRef, useEffect, useReducer, useState } from 'react';\nimport { subscribe, Handler } from \"./message\";\nexport function useImmer(initialValue) {\n    const [val, updateValue] = useState(initialValue);\n    return [\n        val,\n        useCallback((updater) => {\n            updateValue(produce(updater));\n        }, []),\n    ];\n}\nexport function useImmerReducer(reducer, initialState, initialAction) {\n    const cachedReducer = useCallback(produce(reducer), [reducer]);\n    return useReducer(cachedReducer, initialState, initialAction);\n}\nexport function useSubscriber(key, handler) {\n    const deps = isArray(key) ? key : [key];\n    useEffect(() => {\n        const { unsubscribe } = subscribe(key, handler);\n        return unsubscribe;\n    }, deps);\n}\nexport function usePersistFn(fn) {\n    const ref = useRef(() => {\n        throw new Error('Cannot call function while rendering.');\n    });\n    ref.current = fn;\n    const persistFn = useCallback(((...args) => ref.current(...args)), [ref]);\n    return persistFn;\n}\n"]}]}