{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--5-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\amis\\schema\\index.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\amis\\schema\\index.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgaXNFbXB0eSwgY2xvbmVEZWVwLCBpc09iamVjdCB9IGZyb20gJ2xvZGFzaCc7CmltcG9ydCBSZWFjdCwgeyB1c2VNZW1vLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IFRoZW1lQ29uc3VtZXIgfSBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7CmltcG9ydCB7IGFwcCB9IGZyb20gIi4uLy4uLy4uL2FwcCI7CmltcG9ydCB7IHVzZUFwcENvbnRleHQgfSBmcm9tICIuLi8uLi9hcHAvY29udGV4dCI7CmltcG9ydCB7IHN0b3JhZ2UgfSBmcm9tICIuLi8uLi8uLi9jb25zdGFudHMiOwppbXBvcnQgeyBnZXRHbG9iYWwsIHNldEdsb2JhbCB9IGZyb20gIi4uLy4uLy4uL3V0aWxzL3N0b3JlIjsKaW1wb3J0IEFtaXNDb21wb25lbnQgZnJvbSAiLi9hbWlzIjsKaW1wb3J0IHsgcmVzb2x2ZUxpYlNjaGVtYSwgd3JhcENzcyB9IGZyb20gIi4vZnVuYyI7IC8vIOaWh+ahoyBodHRwczovL2JhaWR1LmdpdGh1Yi5pby9hbWlzL2RvY3Mvc3RhcnQvZ2V0dGluZy1zdGFydGVkCi8vIOa6kOeggSBodHRwczovL2dpdGh1Yi5jb20vYmFpZHUvYW1pcy9ibG9iL21hc3Rlci9leGFtcGxlcy9jb21wb25lbnRzL0FwcC5qc3gKCmV4cG9ydCB2YXIgQW1pcyA9IHByb3BzID0+IHsKICB2YXIgewogICAgc2NoZW1hOiByYXdTY2hlbWEsCiAgICBwcm9wczogYW1pc1Byb3BzID0ge30sCiAgICBvcHRpb24gPSB7fQogIH0gPSBwcm9wczsKICB2YXIgY29kZVN0b3JlID0gZ2V0R2xvYmFsKHN0b3JhZ2UuZGV2LmNvZGUpIHx8IHt9OwogIHZhciB7CiAgICBlbmFibGVSb3V0ZVRhYnMsCiAgICBsb2NhbGUKICB9ID0gdXNlQXBwQ29udGV4dCgpOyAvLyDmlLnlj5jlm7rlrprnmoTpq5jluqYKICAvLyBAdHMtaWdub3JlCgogIGlmICghYW1pc1Byb3BzLmFmZml4T2Zmc2V0VG9wICYmIGdldEdsb2JhbChzdG9yYWdlLnN1cHBvcnRSb3V0ZVRhYnMpKSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICBhbWlzUHJvcHMuYWZmaXhPZmZzZXRUb3AgPSBlbmFibGVSb3V0ZVRhYnMgPyAxMDAgOiA1MDsKICB9CgogIHVzZUVmZmVjdCgoKSA9PiB7CiAgICByZXR1cm4gKCkgPT4gewogICAgICBpZiAoY29kZVN0b3JlLmVuYWJsZSkgewogICAgICAgIHNldEdsb2JhbChzdG9yYWdlLmRldi5jb2RlLCB7CiAgICAgICAgICBlbmFibGU6IHRydWUsCiAgICAgICAgICBzY2hlbWE6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CiAgfSwgW10pOwogIHZhciBlbnZTY2hlbWEgPSB1c2VNZW1vKCgpID0+IHsKICAgIGlmICghcmF3U2NoZW1hIHx8ICFpc09iamVjdChyYXdTY2hlbWEpIHx8IGlzRW1wdHkocmF3U2NoZW1hKSkgewogICAgICByZXR1cm4gewogICAgICAgIHR5cGU6ICdodG1sJywKICAgICAgICBodG1sOiAn6K+35Lyg5YWl5pyJ5pWI55qEIHNjaGVtYScKICAgICAgfTsKICAgIH0gLy8gQXZvaWQgbW9kaWZ5IHJhd1NjaGVtYSBvZiBwcm9wcwoKCiAgICB2YXIgc2NoZW1hID0gY2xvbmVEZWVwKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcmF3U2NoZW1hKSwgewogICAgICAvLyBNZXJnZSBhbWlzIGdsb2JhbCBkZWZpbml0aW9ucwogICAgICBjb25zdGFudHM6IGFwcC5hbWlzLmNvbnN0YW50cywKICAgICAgZGVmaW5pdGlvbnM6IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgYXBwLmFtaXMuZGVmaW5pdGlvbnMpLCByYXdTY2hlbWEuZGVmaW5pdGlvbnMpCiAgICB9KSk7CiAgICB2YXIgbGliU2NoZW1hID0gcmVzb2x2ZUxpYlNjaGVtYSh3cmFwQ3NzKHNjaGVtYSkpOwoKICAgIGlmIChjb2RlU3RvcmUuZW5hYmxlICYmIHNjaGVtYS50eXBlID09PSAncGFnZScpIHsKICAgICAgc2V0R2xvYmFsKHN0b3JhZ2UuZGV2LmNvZGUsIHsKICAgICAgICBlbmFibGU6IHRydWUsCiAgICAgICAgc2NoZW1hOiBsaWJTY2hlbWEKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIGxpYlNjaGVtYTsKICB9LCBbcmF3U2NoZW1hXSk7CiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRoZW1lQ29uc3VtZXIsIG51bGwsIHRoZW1lID0+IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEFtaXNDb21wb25lbnQsIHsKICAgIGtleTogdGhlbWUubmFtZSwKICAgIG9wdGlvbjogT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBvcHRpb24pLCB7CiAgICAgIHRoZW1lOiB0aGVtZS5uYW1lLAogICAgICBsb2NhbGUKICAgIH0pLAogICAgc2NoZW1hOiBlbnZTY2hlbWEsCiAgICBwcm9wczogYW1pc1Byb3BzCiAgfSkpOwp9Ow=="},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/components/amis/schema/index.js"],"names":["isEmpty","cloneDeep","isObject","React","useMemo","useEffect","ThemeConsumer","app","useAppContext","storage","getGlobal","setGlobal","AmisComponent","resolveLibSchema","wrapCss","Amis","props","schema","rawSchema","amisProps","option","codeStore","dev","code","enableRouteTabs","locale","affixOffsetTop","supportRouteTabs","enable","envSchema","type","html","Object","assign","constants","amis","definitions","libSchema","createElement","theme","key","name"],"mappings":"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","sourcesContent":["import { isEmpty, cloneDeep, isObject } from 'lodash';\nimport React, { useMemo, useEffect } from 'react';\nimport { ThemeConsumer } from 'styled-components';\nimport { app } from \"../../../app\";\nimport { useAppContext } from \"../../app/context\";\nimport { storage } from \"../../../constants\";\nimport { getGlobal, setGlobal } from \"../../../utils/store\";\nimport AmisComponent from \"./amis\";\nimport { resolveLibSchema, wrapCss } from \"./func\";\n// 文档 https://baidu.github.io/amis/docs/start/getting-started\n// 源码 https://github.com/baidu/amis/blob/master/examples/components/App.jsx\nexport const Amis = (props) => {\n    const { schema: rawSchema, props: amisProps = {}, option = {} } = props;\n    const codeStore = getGlobal(storage.dev.code) || {};\n    const { enableRouteTabs, locale } = useAppContext();\n    // 改变固定的高度\n    // @ts-ignore\n    if (!amisProps.affixOffsetTop && getGlobal(storage.supportRouteTabs)) {\n        // @ts-ignore\n        amisProps.affixOffsetTop = enableRouteTabs ? 100 : 50;\n    }\n    useEffect(() => {\n        return () => {\n            if (codeStore.enable) {\n                setGlobal(storage.dev.code, {\n                    enable: true,\n                    schema: false,\n                });\n            }\n        };\n    }, []);\n    const envSchema = useMemo(() => {\n        if (!rawSchema || !isObject(rawSchema) || isEmpty(rawSchema)) {\n            return {\n                type: 'html',\n                html: '请传入有效的 schema',\n            };\n        }\n        // Avoid modify rawSchema of props\n        const schema = cloneDeep(Object.assign(Object.assign({}, rawSchema), { \n            // Merge amis global definitions\n            constants: app.amis.constants, definitions: Object.assign(Object.assign({}, app.amis.definitions), rawSchema.definitions) }));\n        const libSchema = resolveLibSchema(wrapCss(schema));\n        if (codeStore.enable && schema.type === 'page') {\n            setGlobal(storage.dev.code, {\n                enable: true,\n                schema: libSchema,\n            });\n        }\n        return libSchema;\n    }, [rawSchema]);\n    return (React.createElement(ThemeConsumer, null, (theme) => (React.createElement(AmisComponent, { key: theme.name, option: Object.assign(Object.assign({}, option), { theme: theme.name, locale }), schema: envSchema, props: amisProps }))));\n};\n"]}]}