{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--5-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\app\\index.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\app\\index.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fYXdhaXRlciA9IHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgewogIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZXNvbHZlKHZhbHVlKTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgewogICAgICByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsKICAgIH0KCiAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7CiAgfSk7Cn07Ci8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovCgoKaW1wb3J0IHsgY3JlYXRlQnJvd3Nlckhpc3RvcnkgfSBmcm9tICdoaXN0b3J5JzsKaW1wb3J0IHsgZGVmYXVsdHNEZWVwLCBnZXQsIGlzRnVuY3Rpb24sIG1lcmdlLCBzZXQgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgeyBkZWZhdWx0RW52TW9kZSwgcm9vdFJvdXRlLCBzdG9yYWdlIH0gZnJvbSAiLi4vY29uc3RhbnRzIjsKaW1wb3J0IHsgUmVxdWVzdCB9IGZyb20gIi4uL3V0aWxzL3JlcXVlc3QiOwppbXBvcnQgeyBzZXRHbG9iYWwgfSBmcm9tICIuLi91dGlscy9zdG9yZSI7CmltcG9ydCB7IEFwcFRoZW1lIH0gZnJvbSAiLi90aGVtZSI7CnZhciBzb3VyY2UgPSB7fTsKdmFyIGluaXRDb25maWcgPSB7CiAgLy8gVE9ETzog5aSE55CG5p+Q5Lqb6K+35aS45LiL55qE5aSa5a6e5L6L5YiH5o2i77yM6ICM5LiN5piv5YWo5bGA5ZSv5LiA5a6e5L6LCiAgcmVxdWVzdDogbmV3IFJlcXVlc3QoKSwKICB0aGVtZTogbmV3IEFwcFRoZW1lKCksCiAgc3R5bGVkOiB7CiAgICBnbG9iYWxTdHlsZTogJycKICB9LAogIGVudjogewogICAgZGVmYXVsdDogewogICAgICBtb2RlOiBkZWZhdWx0RW52TW9kZSwKICAgICAgZG9tYWluczogewogICAgICAgIGFwaTogJ2h0dHA6Ly9zaXRlLWFwaS5jb20nCiAgICAgIH0KICAgIH0KICB9LAogIGNvbnN0YW50czogewogICAgcm91dGVQcmVmaXg6IHJvb3RSb3V0ZSwKICAgIHRvYXN0RHVyYXRpb246IDEyMDAsCiAgICByb290TGltaXRGbGFnOiAnKicsCiAgICBlbmFibGVCYWNrVG9wOiBmYWxzZSwKICAgIG5vdEZvdW5kOiB7CiAgICAgIHJvdXRlOiAnLzQwNCcsCiAgICAgIHBhZ2VQYXRoOiAnJwogICAgfQogIH0sCiAgZW50cnk6IFt7CiAgICB0eXBlOiAncm91dGUnLAogICAgcGF0aDogcm9vdFJvdXRlCiAgfV0sCiAgYW1pczogewogICAgYWZmaXhPZmZzZXRUb3A6IDUwCiAgfSwKICAvLyDlvILmraXmlbDmja7lrrnlmagKICBhc3luY1BhZ2U6IHsKICAgIHNjaGVtYToge30sCiAgICBwcmVzZXQ6IHt9LAogICAgbW9jazoge30KICB9LAogIGhvb2s6IHt9Cn07CgpmdW5jdGlvbiBjaGVja0FwcEdldHRlcihrZXksIHZhbHVlKSB7CiAgc3dpdGNoIChrZXkpIHsKICAgIGNhc2UgJ3RoZW1lJzoKICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBBcHBUaGVtZSkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBzaG91bGQgcmVnaXN0ZXIgdGhlbWUgd2l0aCBBcHBUaGVtZSBpbnN0YW5jZS4nKTsKICAgICAgfQoKICAgICAgYnJlYWs7CgogICAgY2FzZSAncmVxdWVzdEZ1bmMnOgogICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFJlcXVlc3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3Ugc2hvdWxkIHJlZ2lzdGVyIHJlcXVlc3Qgd2l0aCBSZXF1ZXN0IGluc3RhbmNlLicpOwogICAgICB9CgogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogIH0KfQoKY2xhc3MgQXBwUHJveHkgewogIGNvbnN0cnVjdG9yKCkgewogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgdmFyIHByb3h5ID0gbmV3IFByb3h5KHRoYXQsIHsKICAgICAgZ2V0KF8sIGtleSkgewogICAgICAgIHZhciB2YWx1ZSA9IGtleSBpbiB0aGF0ID8gdGhhdFtrZXldIDogZ2V0KHNvdXJjZSwga2V5KSB8fCBnZXQoaW5pdENvbmZpZywga2V5KTsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KCiAgICB9KTsKICAgIHJldHVybiBwcm94eTsKICB9Cgp9IC8vIFRPRE86IOWFgeiuuCBBUFAg5aSa5qyh6YeN5aSN5Yib5bu6CgoKY2xhc3MgQXBwIGV4dGVuZHMgQXBwUHJveHkgewogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoLi4uYXJndW1lbnRzKTsKICAgIHRoaXMucm91dGVQcmVmaXggPSByb290Um91dGU7CiAgfQoKICBjcmVhdGUoYXBwQ29uZmlnKSB7CiAgICB2YXIgX2EsIF9iLCBfYzsKCiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgewogICAgICB0aGlzLmluaXRTdGF0ZSgpOwogICAgICB2YXIgcHJldkJhc2VVcmwgPSBnZXQoc291cmNlLCAnY29uc3RhbnRzLnJvdXRlUHJlZml4JykgfHwgcm9vdFJvdXRlOyAvLyDnrYnlvoUgYmVmb3JlQ3JlYXRlIGhvb2vmiafooYzlrozmiJAKCiAgICAgIGlmICgoX2EgPSBhcHBDb25maWcuaG9vaykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmJlZm9yZUNyZWF0ZSkgewogICAgICAgIHlpZWxkIGFwcENvbmZpZy5ob29rLmJlZm9yZUNyZWF0ZS5iaW5kKHRoaXMsIHRoaXMsIGFwcENvbmZpZykoKTsKICAgICAgfSAvLyDlkIjlubblj4LmlbAKCgogICAgICBzb3VyY2UgPSBtZXJnZShpbml0Q29uZmlnLCBhcHBDb25maWcpOwogICAgICB0aGlzLnJvdXRlUHJlZml4ID0gdGhpcy5nZXRCYXNlVXJsKChfYiA9IGFwcENvbmZpZy5jb25zdGFudHMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5yb3V0ZVByZWZpeCk7CiAgICAgIHNldChzb3VyY2UsICdjb25zdGFudHMucm91dGVQcmVmaXgnLCB0aGlzLnJvdXRlUHJlZml4KTsKCiAgICAgIGlmICh0aGlzLmNoZWNrQmFzZVVybChwcmV2QmFzZVVybCwgdGhpcy5yb3V0ZVByZWZpeCkpIHsKICAgICAgICB0aGlzLmNyZWF0ZVJvdXRlckhpc3RvcnkoKTsKICAgICAgfQoKICAgICAgaWYgKHNvdXJjZS5lbnYpIHsKICAgICAgICB0aGlzLnNldEVudihzb3VyY2UuZW52KTsKICAgICAgfQoKICAgICAgaWYgKHNvdXJjZS5yZXF1ZXN0KSB7CiAgICAgICAgdGhpcy5zZXRSZXF1ZXN0KHNvdXJjZS5yZXF1ZXN0KTsKICAgICAgfSAvLyDnrYnlvoUgYWZ0ZXJDcmVhdGVkIGhvb2vmiafooYzlrozmiJAKCgogICAgICBpZiAoKF9jID0gc291cmNlLmhvb2spID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5hZnRlckNyZWF0ZWQpIHsKICAgICAgICB5aWVsZCBzb3VyY2UuaG9vay5hZnRlckNyZWF0ZWQuYmluZCh0aGlzLCB0aGlzLCBzb3VyY2UpKCk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgY3JlYXRlUm91dGVySGlzdG9yeSgpIHsKICAgIHRoaXMucm91dGVySGlzdG9yeSA9IGNyZWF0ZUJyb3dzZXJIaXN0b3J5KHRoaXMucm91dGVQcmVmaXggPT09IHJvb3RSb3V0ZSA/IHVuZGVmaW5lZCA6IHsKICAgICAgYmFzZW5hbWU6IHRoaXMucm91dGVQcmVmaXguc2xpY2UoMCwgLTEpCiAgICB9KTsKICB9CgogIGluaXRTdGF0ZSgpIHsKICAgIC8vIOmdniDng63mm7TmlrDmqKHlvI/kuIvvvIzmr4/mrKHliJvlu7rvvIzlsIbmuIXpmaTljp/mnInmlbDmja4KICAgIGlmICghcHJvY2Vzcy5lbnYuSE9UKSB7CiAgICAgIHNvdXJjZSA9IHt9OwogICAgICB0aGlzLnJvdXRlUHJlZml4ID0gcm9vdFJvdXRlOwogICAgICB0aGlzLnJvdXRlckhpc3RvcnkgPSB1bmRlZmluZWQ7CiAgICB9CiAgfQoKICBnZXRCYXNlVXJsKHVybEdlbikgewogICAgaWYgKGlzRnVuY3Rpb24odXJsR2VuKSkgewogICAgICByZXR1cm4gdXJsR2VuKCkgfHwgcm9vdFJvdXRlOwogICAgfQoKICAgIHJldHVybiB0eXBlb2YgdXJsR2VuID09PSAnc3RyaW5nJyA/IHVybEdlbiA6IHJvb3RSb3V0ZTsKICB9CgogIGNoZWNrQmFzZVVybChwcmV2QmFzZVVybCwgcm91dGVQcmVmaXgpIHsKICAgIGlmICh0eXBlb2Ygcm91dGVQcmVmaXggIT09ICdzdHJpbmcnIHx8IHJvdXRlUHJlZml4LnN1YnN0cigtMSkgIT09IHJvb3RSb3V0ZSB8fCByb3V0ZVByZWZpeFswXSAhPT0gcm9vdFJvdXRlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigicm91dGVQcmVmaXg6IFwiIi5jb25jYXQocm91dGVQcmVmaXgsICJcIiBpcyBub3QgYWxsb3dlZC4gVGhlIFwicm91dGVQcmVmaXhcIiBtdXN0IGJlIHN0cmluZyBzdGFydFdpdGggXCIvXCIgYW5kIGVuZFdpdGggXCIvXCIuIGVnOiBcIi9zdWJQYXRoL1wiIikpOwogICAgfQoKICAgIGlmICh0aGlzLnJvdXRlckhpc3RvcnkgJiYgcm91dGVQcmVmaXggIT09IHByZXZCYXNlVXJsKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcm91dGVQcmVmaXg7CiAgICB9CgogICAgcmV0dXJuICF0aGlzLnJvdXRlckhpc3Rvcnk7CiAgfQoKICBzZXRFbnYodmFsdWUpIHsKICAgIHZhciBtb2RlID0gcHJvY2Vzcy5lbnYuRU5WIHx8IGRlZmF1bHRFbnZNb2RlOwogICAgdmFyIGlzTW9jayA9IHByb2Nlc3MuZW52Lk1PQ0s7CiAgICB2YXIgaXNSZWxlYXNlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyAmJiBnZXQodmFsdWUsICIiLmNvbmNhdChtb2RlLCAiLmlzUHJvZCIpKTsKICAgIHZhciBlbnYgPSBkZWZhdWx0c0RlZXAoewogICAgICBpc01vY2ssCiAgICAgIG1vZGUKICAgIH0sIHZhbHVlW21vZGVdLCB7CiAgICAgIGlzUmVsZWFzZQogICAgfSwgdmFsdWUuZGVmYXVsdCwgaW5pdENvbmZpZy5lbnYuZGVmYXVsdCk7CiAgICBzZXQoc291cmNlLCAnZW52JywgZW52KTsKICB9CgogIHNldFJlcXVlc3QocmVxdWVzdElucykgewogICAgdmFyIGluaXRFbnYgPSBpbml0Q29uZmlnLmVudi5kZWZhdWx0OwogICAgY2hlY2tBcHBHZXR0ZXIoJ3JlcXVlc3RGdW5jJywgcmVxdWVzdElucyk7IC8vIOiuvue9riByZXF1ZXN0IOeOr+Wig+WPmOmHjwoKICAgIHZhciBlbnYgPSBzb3VyY2UuZW52IHx8IGluaXRFbnY7CiAgICByZXF1ZXN0SW5zLnNldENvbmZpZyh7CiAgICAgIGlzTW9jazogZW52LmlzTW9jayAmJiAhZW52LmlzUmVsZWFzZSwKICAgICAgZG9tYWluczogZW52LmRvbWFpbnMKICAgIH0pOwogICAgdmFyIHJlcXVlc3RIYW5kbGUgPSByZXF1ZXN0SW5zLnJlcXVlc3QuYmluZChyZXF1ZXN0SW5zKTsKICAgIHJlcXVlc3RIYW5kbGUuZ2V0VXJsQnlPcHRpb24gPSByZXF1ZXN0SW5zLmdldFVybEJ5T3B0aW9uLmJpbmQocmVxdWVzdElucyk7CiAgICBzZXQoc291cmNlLCAncmVxdWVzdCcsIHJlcXVlc3RIYW5kbGUpOwogIH0KCn0KCmV4cG9ydCB2YXIgYXBwID0gbmV3IEFwcCgpOwpzZXRHbG9iYWwoc3RvcmFnZS5hcHBJbnN0YW5jZSwgYXBwKTs="},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/app/index.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","createBrowserHistory","defaultsDeep","get","isFunction","merge","set","defaultEnvMode","rootRoute","storage","Request","setGlobal","AppTheme","source","initConfig","request","theme","styled","globalStyle","env","default","mode","domains","api","constants","routePrefix","toastDuration","rootLimitFlag","enableBackTop","notFound","route","pagePath","entry","type","path","amis","affixOffsetTop","asyncPage","schema","preset","mock","hook","checkAppGetter","key","Error","AppProxy","constructor","that","proxy","Proxy","_","App","arguments","create","appConfig","_a","_b","_c","initState","prevBaseUrl","beforeCreate","bind","getBaseUrl","checkBaseUrl","createRouterHistory","setEnv","setRequest","afterCreated","routerHistory","undefined","basename","slice","process","HOT","urlGen","substr","window","location","href","ENV","isMock","MOCK","isRelease","NODE_ENV","requestIns","initEnv","setConfig","requestHandle","getUrlByOption","app","appInstance"],"mappings":"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","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable max-classes-per-file */\nimport { createBrowserHistory } from 'history';\nimport { defaultsDeep, get, isFunction, merge, set } from 'lodash';\nimport { defaultEnvMode, rootRoute, storage } from \"../constants\";\nimport { Request } from \"../utils/request\";\nimport { setGlobal } from \"../utils/store\";\nimport { AppTheme } from \"./theme\";\nlet source = {};\nconst initConfig = {\n    // TODO: 处理某些请夸下的多实例切换，而不是全局唯一实例\n    request: new Request(),\n    theme: new AppTheme(),\n    styled: {\n        globalStyle: '',\n    },\n    env: {\n        default: {\n            mode: defaultEnvMode,\n            domains: {\n                api: 'http://site-api.com',\n            },\n        },\n    },\n    constants: {\n        routePrefix: rootRoute,\n        toastDuration: 1200,\n        rootLimitFlag: '*',\n        enableBackTop: false,\n        notFound: {\n            route: '/404',\n            pagePath: '',\n        },\n    },\n    entry: [\n        {\n            type: 'route',\n            path: rootRoute,\n        },\n    ],\n    amis: {\n        affixOffsetTop: 50,\n    },\n    // 异步数据容器\n    asyncPage: {\n        schema: {},\n        preset: {},\n        mock: {},\n    },\n    hook: {},\n};\nfunction checkAppGetter(key, value) {\n    switch (key) {\n        case 'theme':\n            if (!(value instanceof AppTheme)) {\n                throw new Error('You should register theme with AppTheme instance.');\n            }\n            break;\n        case 'requestFunc':\n            if (!(value instanceof Request)) {\n                throw new Error('You should register request with Request instance.');\n            }\n            break;\n        default:\n    }\n}\nclass AppProxy {\n    constructor() {\n        const that = this;\n        const proxy = new Proxy(that, {\n            get(_, key) {\n                const value = key in that ? that[key] : get(source, key) || get(initConfig, key);\n                return value;\n            },\n        });\n        return proxy;\n    }\n}\n// TODO: 允许 APP 多次重复创建\nclass App extends AppProxy {\n    constructor() {\n        super(...arguments);\n        this.routePrefix = rootRoute;\n    }\n    create(appConfig) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function* () {\n            this.initState();\n            const prevBaseUrl = get(source, 'constants.routePrefix') || rootRoute;\n            // 等待 beforeCreate hook执行完成\n            if ((_a = appConfig.hook) === null || _a === void 0 ? void 0 : _a.beforeCreate) {\n                yield appConfig.hook.beforeCreate.bind(this, this, appConfig)();\n            }\n            // 合并参数\n            source = merge(initConfig, appConfig);\n            this.routePrefix = this.getBaseUrl((_b = appConfig.constants) === null || _b === void 0 ? void 0 : _b.routePrefix);\n            set(source, 'constants.routePrefix', this.routePrefix);\n            if (this.checkBaseUrl(prevBaseUrl, this.routePrefix)) {\n                this.createRouterHistory();\n            }\n            if (source.env) {\n                this.setEnv(source.env);\n            }\n            if (source.request) {\n                this.setRequest(source.request);\n            }\n            // 等待 afterCreated hook执行完成\n            if ((_c = source.hook) === null || _c === void 0 ? void 0 : _c.afterCreated) {\n                yield source.hook.afterCreated.bind(this, this, source)();\n            }\n        });\n    }\n    createRouterHistory() {\n        this.routerHistory = createBrowserHistory(this.routePrefix === rootRoute\n            ? undefined\n            : {\n                basename: this.routePrefix.slice(0, -1),\n            });\n    }\n    initState() {\n        // 非 热更新模式下，每次创建，将清除原有数据\n        if (!process.env.HOT) {\n            source = {};\n            this.routePrefix = rootRoute;\n            this.routerHistory = undefined;\n        }\n    }\n    getBaseUrl(urlGen) {\n        if (isFunction(urlGen)) {\n            return urlGen() || rootRoute;\n        }\n        return typeof urlGen === 'string' ? urlGen : rootRoute;\n    }\n    checkBaseUrl(prevBaseUrl, routePrefix) {\n        if (typeof routePrefix !== 'string' ||\n            routePrefix.substr(-1) !== rootRoute ||\n            routePrefix[0] !== rootRoute) {\n            throw new Error(`routePrefix: \"${routePrefix}\" is not allowed. The \"routePrefix\" must be string startWith \"/\" and endWith \"/\". eg: \"/subPath/\"`);\n        }\n        if (this.routerHistory && routePrefix !== prevBaseUrl) {\n            window.location.href = routePrefix;\n        }\n        return !this.routerHistory;\n    }\n    setEnv(value) {\n        const mode = process.env.ENV || defaultEnvMode;\n        const isMock = process.env.MOCK;\n        const isRelease = process.env.NODE_ENV === 'production' && get(value, `${mode}.isProd`);\n        const env = defaultsDeep({\n            isMock,\n            mode,\n        }, value[mode], {\n            isRelease,\n        }, value.default, initConfig.env.default);\n        set(source, 'env', env);\n    }\n    setRequest(requestIns) {\n        const initEnv = initConfig.env.default;\n        checkAppGetter('requestFunc', requestIns);\n        // 设置 request 环境变量\n        const env = source.env || initEnv;\n        requestIns.setConfig({\n            isMock: env.isMock && !env.isRelease,\n            domains: env.domains,\n        });\n        const requestHandle = requestIns.request.bind(requestIns);\n        requestHandle.getUrlByOption = requestIns.getUrlByOption.bind(requestIns);\n        set(source, 'request', requestHandle);\n    }\n}\nexport const app = new App();\nsetGlobal(storage.appInstance, app);\n"]}]}