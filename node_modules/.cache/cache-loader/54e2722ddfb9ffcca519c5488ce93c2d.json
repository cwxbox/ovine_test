{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\editor\\lib\\components\\header\\index.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\editor\\lib\\components\\header\\index.js","mtime":1618319235155},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:KGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZW50ZXJNb2R1bGUgOiB1bmRlZmluZWQ7CiAgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsKfSkoKTsKCnZhciBfX3NpZ25hdHVyZV9fID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmRlZmF1bHQuc2lnbmF0dXJlIDogZnVuY3Rpb24gKGEpIHsKICByZXR1cm4gYTsKfTsKCmltcG9ydCB7IHRvYXN0LCBjb25maXJtIH0gZnJvbSAnYW1pcyc7CmltcG9ydCBjbHMgZnJvbSAnY2xhc3NuYW1lcyc7CmltcG9ydCBjb3B5IGZyb20gJ2NvcHktdG8tY2xpcGJvYXJkJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgb2JzZXJ2ZXIsIGluamVjdCB9IGZyb20gJ21vYngtcmVhY3QnOwppbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGFwcCB9IGZyb20gIi4uLy4uLy4uLy4uL2NvcmUvbGliL2FwcCI7CmltcG9ydCB7IHNhdmVUb0ZpbGUgfSBmcm9tICIuLi8uLi8uLi8uLi9jb3JlL2xpYi91dGlscy9maWxlIjsKaW1wb3J0IHsgZWRpdG9yU3RvcmUgfSBmcm9tICIuLi8uLi9zdG9yZXMvZWRpdG9yIjsKaW1wb3J0IHsgU3R5bGVkSGVhZGVyIH0gZnJvbSAiLi9zdHlsZWQiOyAvLyBUT0RPOiDkvJjljJYgZ2V0U2NoZW1hU3RyaW5nCgp2YXIgX2RlZmF1bHQgPSBpbmplY3QoJ3N0b3JlJykob2JzZXJ2ZXIoX19zaWduYXR1cmVfXyhwcm9wcyA9PiB7CiAgdmFyIHsKICAgIGlzUHJldmlldywKICAgIG9wdGlvbiwKICAgIGlzRGlydHksCiAgICBpc01vYmlsZSwKICAgIHRvZ2dsZVByZXZpZXcsCiAgICB0b2dnbGVWaWV3TW9kZSwKICAgIHNldExhc3RTYXZlZFNjaGVtYSwKICAgIGVkaXRvckluc3RhbmNlCiAgfSA9IHByb3BzLnN0b3JlOwogIHZhciB7CiAgICBicmVhZGNydW1iLAogICAgb25FeGl0LAogICAgb25TYXZlLAogICAgc2F2ZUFwaSwKICAgIHNhdmVJbnRlcnZhbAogIH0gPSBvcHRpb247CiAgdmFyIHRpbWVyUmVmID0gdXNlUmVmKDApOwogIHZhciBoYXNQcmV2U3RlcCA9IGVkaXRvckluc3RhbmNlLmNhblVuZG8oKTsKICB2YXIgaGFzTmV4dFN0ZXAgPSBlZGl0b3JJbnN0YW5jZS5jYW5SZWRvKCk7CgogIHZhciBnZXRCcmVhZGNydW1iSXRlbXMgPSAoKSA9PiB7CiAgICByZXR1cm4gdHlwZW9mIGJyZWFkY3J1bWIgPT09ICdzdHJpbmcnID8gW2JyZWFkY3J1bWJdIDogYnJlYWRjcnVtYjsKICB9OwoKICB2YXIgZ2V0U2NoZW1hU3RyaW5nID0gZXJyVGlwID0+IHsKICAgIHZhciB2YWx1ZSA9ICcnOwoKICAgIHRyeSB7CiAgICAgIHZhbHVlID0gSlNPTi5zdHJpbmdpZnkoZWRpdG9yU3RvcmUuc2NoZW1hKTsKICAgIH0gY2F0Y2ggKF9fKSB7CiAgICAgIHRvYXN0LmVycm9yKGVyclRpcCwgJ0pTT07op6PmnpDplJnor68nKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9OwoKICB2YXIgb25FeGl0RWRpdG9yID0gKCkgPT4gewogICAgaWYgKGlzUHJldmlldykgewogICAgICB0b2dnbGVQcmV2aWV3KCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgZXhpdCA9ICgpID0+IHsKICAgICAgdmFyIGV4aXRSZXMgPSB0cnVlOwoKICAgICAgaWYgKG9uRXhpdCkgewogICAgICAgIGV4aXRSZXMgPSBvbkV4aXQoKTsKICAgICAgfQoKICAgICAgaWYgKGV4aXRSZXMgIT09IGZhbHNlKSB7CiAgICAgICAgaWYgKGFwcC5yb3V0ZXJIaXN0b3J5Lmxlbmd0aCkgewogICAgICAgICAgYXBwLnJvdXRlckhpc3RvcnkuZ29CYWNrKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFwcC5yb3V0ZXJIaXN0b3J5LnJlcGxhY2UoJy8nKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgaWYgKGlzRGlydHkpIHsKICAgICAgY29uZmlybSgn5b2T5YmN5a2Y5Zyo5pyq5L+d5a2Y55qE5pS55Yqo77yM6YCA5Ye65bCG6KeG5Li65pS+5byD5pu05pS577yBJywgJ+ehruWumumAgOWHuue8lui+keWZqO+8nycpLnRoZW4oY2hvb3NlID0+IHsKICAgICAgICBpZiAoY2hvb3NlKSB7CiAgICAgICAgICBleGl0KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGV4aXQoKTsKICB9OwoKICB2YXIgb25Db3B5Q2xpY2sgPSAoKSA9PiB7CiAgICB2YXIgdmFsdWUgPSBnZXRTY2hlbWFTdHJpbmcoJ+WkjeWItuaTjeS9nOaJp+ihjOWksei0pe+8gScpOwoKICAgIGlmICh2YWx1ZSkgewogICAgICBjb3B5KHZhbHVlKTsKICAgICAgdG9hc3Quc3VjY2Vzcygn5aSN5Yi25oiQ5YqfJyk7CiAgICB9CiAgfTsKCiAgdmFyIG9uRG93bmxvYWRDbGljayA9ICgpID0+IHsKICAgIHZhciB2YWx1ZSA9IGdldFNjaGVtYVN0cmluZygn5LiL6L295pON5L2c5omn6KGM5aSx6LSl77yBJyk7CgogICAgaWYgKHZhbHVlKSB7CiAgICAgIHNhdmVUb0ZpbGUodmFsdWUsICd0ZXh0L3BsYWluJywgIiIuY29uY2F0KF8ubGFzdChnZXRCcmVhZGNydW1iSXRlbXMoKSksICIuanNvbiIpKTsKICAgICAgdG9hc3Quc3VjY2Vzcygn5paH5Lu25LiL6L295oiQ5YqfJyk7CiAgICB9CiAgfTsKCiAgdmFyIHJlbmRlckJyZWFkY3J1bWIgPSAoKSA9PiB7CiAgICBpZiAoIWJyZWFkY3J1bWIpIHsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIlx1NjcyQVx1NzdFNVx1OTg3NVx1OTc2MiIpOwogICAgfQoKICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgibmF2IiwgewogICAgICAiYXJpYS1sYWJlbCI6ICJicmVhZGNydW1iIgogICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoIm9sIiwgewogICAgICBjbGFzc05hbWU6ICJicmVhZGNydW1iICIKICAgIH0sIGdldEJyZWFkY3J1bWJJdGVtcygpLm1hcCgodGV4dCwgaW5kZXgpID0+IHsKICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJsaSIsIHsKICAgICAgICBrZXk6IGluZGV4LAogICAgICAgIGNsYXNzTmFtZTogImJyZWFkY3J1bWItaXRlbSB0ZXh0LWVsbGlwc2lzIgogICAgICB9LCB0ZXh0KTsKICAgIH0pKSk7CiAgfTsKCiAgdmFyIHNhdmVTY2hlbWFBcGkgPSBmdW5jdGlvbiBzYXZlU2NoZW1hQXBpKCkgewogICAgdmFyIG1vdW50ZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgdmFyIHZhbHVlID0gZWRpdG9yU3RvcmUuc2NoZW1hOwogICAgc2F2ZUFwaS5kYXRhID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBzYXZlQXBpLmRhdGEpLCB7CiAgICAgIHNjaGVtYTogdmFsdWUKICAgIH0pOwogICAgcmV0dXJuIGFwcC5yZXF1ZXN0KHNhdmVBcGkpLnRoZW4oc291cmNlID0+IHsKICAgICAgdmFyIHsKICAgICAgICBzdGF0dXMsCiAgICAgICAgbXNnCiAgICAgIH0gPSBzb3VyY2UuZGF0YTsKCiAgICAgIGlmICghbW91bnRlZCkgewogICAgICAgIGlmIChzdGF0dXMgPT09IDApIHsKICAgICAgICAgIHRvYXN0LnN1Y2Nlc3MobXNnIHx8ICfkv53lrZjmiJDlip8nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdG9hc3QuZXJyb3IobXNnIHx8ICfkv53lrZjlpLHotKUnKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChvblNhdmUpIHsKICAgICAgICBvblNhdmUodmFsdWUpOwogICAgICB9CgogICAgICBzZXRMYXN0U2F2ZWRTY2hlbWEodmFsdWUpOwogICAgICByZXR1cm4gc291cmNlOwogICAgfSkuY2F0Y2goc291cmNlID0+IHsKICAgICAgdG9hc3QuZXJyb3IoKHNvdXJjZSA9PT0gbnVsbCB8fCBzb3VyY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNvdXJjZS5tc2cpIHx8ICfkv53lrZjlpLHotKUnKTsKICAgIH0pOwogIH07CgogIHZhciBvblNhdmVDbGljayA9ICgpID0+IHsKICAgIHZhciB2YWx1ZSA9IGVkaXRvclN0b3JlLnNjaGVtYTsKCiAgICBpZiAoc2F2ZUFwaSkgewogICAgICBzYXZlU2NoZW1hQXBpKCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAob25TYXZlKSB7CiAgICAgIG9uU2F2ZSh2YWx1ZSk7CiAgICB9CgogICAgc2V0TGFzdFNhdmVkU2NoZW1hKHZhbHVlKTsKICAgIHRvYXN0LnN1Y2Nlc3MoJ+S/neWtmOaIkOWKnycpOwogIH07CgogIHVzZUVmZmVjdCgoKSA9PiB7CiAgICBpZiAoc2F2ZUFwaSAmJiBzYXZlSW50ZXJ2YWwgPiAyICogMTAwMCkgewogICAgICBpZiAodGltZXJSZWYuY3VycmVudCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJSZWYuY3VycmVudCk7CiAgICAgIH0KCiAgICAgIHRpbWVyUmVmLmN1cnJlbnQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgc2F2ZVNjaGVtYUFwaSh0cnVlKTsKICAgICAgfSwgc2F2ZUludGVydmFsKTsKICAgIH0KCiAgICByZXR1cm4gKCkgPT4gewogICAgICBpZiAodGltZXJSZWYuY3VycmVudCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJSZWYuY3VycmVudCk7CiAgICAgIH0KICAgIH07CiAgfSwgW10pOwogIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChTdHlsZWRIZWFkZXIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICBjbGFzc05hbWU6ICJ0b29sYmFyLWxlZnQiCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImkiLCB7CiAgICBjbGFzc05hbWU6ICJmYSBmYS1jaGV2cm9uLWxlZnQgYmFjay1pY29uIiwKICAgICJkYXRhLXRvb2x0aXAiOiAiXHU5MDAwXHU1MUZBIiwKICAgICJkYXRhLXBvc2l0aW9uIjogImJvdHRvbSIsCiAgICBvbkNsaWNrOiBvbkV4aXRFZGl0b3IKICB9KSwgcmVuZGVyQnJlYWRjcnVtYigpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIGNsYXNzTmFtZTogInRvb2xiYXItbWFpbiIKICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbScsIHsKICAgICAgYWN0aXZlOiBpc1ByZXZpZXcKICAgIH0pLAogICAgb25DbGljazogdG9nZ2xlUHJldmlldwogIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJpIiwgewogICAgY2xhc3NOYW1lOiAiZmEgIi5jb25jYXQoaXNQcmV2aWV3ID8gJ2ZhLWV5ZS1zbGFzaCcgOiAnZmEtZXllJykKICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAiXHU5ODg0XHU4OUM4IikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbSB2aWV3LW1vZGUnLCB7CiAgICAgIGFjdGl2ZTogIWlzUHJldmlldyAmJiBpc01vYmlsZQogICAgfSksCiAgICBvbkNsaWNrOiB0b2dnbGVWaWV3TW9kZQogIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJpIiwgewogICAgY2xhc3NOYW1lOiAiZmEgIi5jb25jYXQoaXNNb2JpbGUgPyAnZmEtbW9iaWxlJyA6ICdmYS1kZXNrdG9wJykKICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCBpc01vYmlsZSA/ICfnp7vliqjnq68nIDogJ1BD56uvJykpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbScsIHsKICAgICAgZGlzYWJsZWQ6IGlzUHJldmlldyB8fCAhaGFzUHJldlN0ZXAKICAgIH0pLAogICAgb25DbGljazogKCkgPT4gZWRpdG9ySW5zdGFuY2UudW5kbygpCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImkiLCB7CiAgICBjbGFzc05hbWU6ICJmYSBmYS1yZXBseSIKICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAiXHU2NEE0XHU5NTAwIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbScsIHsKICAgICAgZGlzYWJsZWQ6IGlzUHJldmlldyB8fCAhaGFzTmV4dFN0ZXAKICAgIH0pLAogICAgb25DbGljazogKCkgPT4gZWRpdG9ySW5zdGFuY2UucmVkbygpCiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImkiLCB7CiAgICBjbGFzc05hbWU6ICJmYSBmYS1zaGFyZSIKICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAiXHU1NkRFXHU5MDAwIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbScpLAogICAgb25DbGljazogb25Db3B5Q2xpY2sKICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaSIsIHsKICAgIGNsYXNzTmFtZTogImZhIGZhLWNvcHkiCiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgbnVsbCwgIlx1NTkwRFx1NTIzNiIpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIGNsYXNzTmFtZTogY2xzKCd0b29sYmFyLWl0ZW0nKSwKICAgIG9uQ2xpY2s6IG9uRG93bmxvYWRDbGljawogIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJpIiwgewogICAgY2xhc3NOYW1lOiAiZmEgZmEtc2F2ZSIKICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAiXHU1QkZDXHU1MUZBIikpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiBjbHMoJ3Rvb2xiYXItaXRlbScpLAogICAgb25DbGljazogb25TYXZlQ2xpY2sKICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaSIsIHsKICAgIGNsYXNzTmFtZTogImZhIGZhLWNsb3VkLXVwbG9hZCAgIgogIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJcdTRGRERcdTVCNTgiKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgY2xhc3NOYW1lOiAidG9vbGJhci1yaWdodCIKICB9KSk7Cn0sICJ1c2VSZWZ7dGltZXJSZWZ9XG51c2VFZmZlY3R7fSIpKSk7CgpleHBvcnQgZGVmYXVsdCBfZGVmYXVsdDsKOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgcmVhY3RIb3RMb2FkZXIgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZGVmYXVsdCA6IHVuZGVmaW5lZDsKCiAgaWYgKCFyZWFjdEhvdExvYWRlcikgewogICAgcmV0dXJuOwogIH0KCiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoX2RlZmF1bHQsICJkZWZhdWx0IiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGVkaXRvclxcbGliXFxjb21wb25lbnRzXFxoZWFkZXJcXGluZGV4LmpzIik7Cn0pKCk7Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciBsZWF2ZU1vZHVsZSA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5sZWF2ZU1vZHVsZSA6IHVuZGVmaW5lZDsKICBsZWF2ZU1vZHVsZSAmJiBsZWF2ZU1vZHVsZShtb2R1bGUpOwp9KSgpOw=="},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/editor/lib/components/header/index.js"],"names":["toast","confirm","cls","copy","_","observer","inject","React","useEffect","useRef","app","saveToFile","editorStore","StyledHeader","props","isPreview","option","isDirty","isMobile","togglePreview","toggleViewMode","setLastSavedSchema","editorInstance","store","breadcrumb","onExit","onSave","saveApi","saveInterval","timerRef","hasPrevStep","canUndo","hasNextStep","canRedo","getBreadcrumbItems","getSchemaString","errTip","value","JSON","stringify","schema","__","error","onExitEditor","exit","exitRes","routerHistory","length","goBack","replace","then","choose","onCopyClick","success","onDownloadClick","last","renderBreadcrumb","createElement","className","map","text","index","key","saveSchemaApi","mounted","data","Object","assign","request","source","status","msg","catch","onSaveClick","current","clearInterval","setInterval","onClick","active","disabled","undo","redo"],"mappings":"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","sourcesContent":["import { toast, confirm } from 'amis';\nimport cls from 'classnames';\nimport copy from 'copy-to-clipboard';\nimport _ from 'lodash';\nimport { observer, inject } from 'mobx-react';\nimport React, { useEffect, useRef } from 'react';\nimport { app } from \"../../../../core/lib/app\";\nimport { saveToFile } from \"../../../../core/lib/utils/file\";\nimport { editorStore } from \"../../stores/editor\";\nimport { StyledHeader } from \"./styled\";\n// TODO: 优化 getSchemaString\nexport default inject('store')(observer((props) => {\n    const { isPreview, option, isDirty, isMobile, togglePreview, toggleViewMode, setLastSavedSchema, editorInstance, } = props.store;\n    const { breadcrumb, onExit, onSave, saveApi, saveInterval } = option;\n    const timerRef = useRef(0);\n    const hasPrevStep = editorInstance.canUndo();\n    const hasNextStep = editorInstance.canRedo();\n    const getBreadcrumbItems = () => {\n        return typeof breadcrumb === 'string' ? [breadcrumb] : breadcrumb;\n    };\n    const getSchemaString = (errTip) => {\n        let value = '';\n        try {\n            value = JSON.stringify(editorStore.schema);\n        }\n        catch (__) {\n            toast.error(errTip, 'JSON解析错误');\n            return false;\n        }\n        return value;\n    };\n    const onExitEditor = () => {\n        if (isPreview) {\n            togglePreview();\n            return;\n        }\n        const exit = () => {\n            let exitRes = true;\n            if (onExit) {\n                exitRes = onExit();\n            }\n            if (exitRes !== false) {\n                if (app.routerHistory.length) {\n                    app.routerHistory.goBack();\n                }\n                else {\n                    app.routerHistory.replace('/');\n                }\n            }\n        };\n        if (isDirty) {\n            confirm('当前存在未保存的改动，退出将视为放弃更改！', '确定退出编辑器？').then((choose) => {\n                if (choose) {\n                    exit();\n                }\n            });\n            return;\n        }\n        exit();\n    };\n    const onCopyClick = () => {\n        const value = getSchemaString('复制操作执行失败！');\n        if (value) {\n            copy(value);\n            toast.success('复制成功');\n        }\n    };\n    const onDownloadClick = () => {\n        const value = getSchemaString('下载操作执行失败！');\n        if (value) {\n            saveToFile(value, 'text/plain', `${_.last(getBreadcrumbItems())}.json`);\n            toast.success('文件下载成功');\n        }\n    };\n    const renderBreadcrumb = () => {\n        if (!breadcrumb) {\n            return React.createElement(\"span\", null, \"\\u672A\\u77E5\\u9875\\u9762\");\n        }\n        return (React.createElement(\"nav\", { \"aria-label\": \"breadcrumb\" },\n            React.createElement(\"ol\", { className: \"breadcrumb \" }, getBreadcrumbItems().map((text, index) => {\n                return (React.createElement(\"li\", { key: index, className: \"breadcrumb-item text-ellipsis\" }, text));\n            }))));\n    };\n    const saveSchemaApi = (mounted = false) => {\n        const value = editorStore.schema;\n        saveApi.data = Object.assign(Object.assign({}, saveApi.data), { schema: value });\n        return app\n            .request(saveApi)\n            .then((source) => {\n            const { status, msg } = source.data;\n            if (!mounted) {\n                if (status === 0) {\n                    toast.success(msg || '保存成功');\n                }\n                else {\n                    toast.error(msg || '保存失败');\n                }\n            }\n            if (onSave) {\n                onSave(value);\n            }\n            setLastSavedSchema(value);\n            return source;\n        })\n            .catch((source) => {\n            toast.error((source === null || source === void 0 ? void 0 : source.msg) || '保存失败');\n        });\n    };\n    const onSaveClick = () => {\n        const value = editorStore.schema;\n        if (saveApi) {\n            saveSchemaApi();\n            return;\n        }\n        if (onSave) {\n            onSave(value);\n        }\n        setLastSavedSchema(value);\n        toast.success('保存成功');\n    };\n    useEffect(() => {\n        if (saveApi && saveInterval > 2 * 1000) {\n            if (timerRef.current) {\n                clearInterval(timerRef.current);\n            }\n            timerRef.current = setInterval(() => {\n                saveSchemaApi(true);\n            }, saveInterval);\n        }\n        return () => {\n            if (timerRef.current) {\n                clearInterval(timerRef.current);\n            }\n        };\n    }, []);\n    return (React.createElement(StyledHeader, null,\n        React.createElement(\"div\", { className: \"toolbar-left\" },\n            React.createElement(\"i\", { className: \"fa fa-chevron-left back-icon\", \"data-tooltip\": \"\\u9000\\u51FA\", \"data-position\": \"bottom\", onClick: onExitEditor }),\n            renderBreadcrumb()),\n        React.createElement(\"div\", { className: \"toolbar-main\" },\n            React.createElement(\"div\", { className: cls('toolbar-item', { active: isPreview }), onClick: togglePreview },\n                React.createElement(\"i\", { className: `fa ${isPreview ? 'fa-eye-slash' : 'fa-eye'}` }),\n                React.createElement(\"span\", null, \"\\u9884\\u89C8\")),\n            React.createElement(\"div\", { className: cls('toolbar-item view-mode', {\n                    active: !isPreview && isMobile,\n                }), onClick: toggleViewMode },\n                React.createElement(\"i\", { className: `fa ${isMobile ? 'fa-mobile' : 'fa-desktop'}` }),\n                React.createElement(\"span\", null, isMobile ? '移动端' : 'PC端')),\n            React.createElement(\"div\", { className: cls('toolbar-item', { disabled: isPreview || !hasPrevStep }), onClick: () => editorInstance.undo() },\n                React.createElement(\"i\", { className: \"fa fa-reply\" }),\n                React.createElement(\"span\", null, \"\\u64A4\\u9500\")),\n            React.createElement(\"div\", { className: cls('toolbar-item', { disabled: isPreview || !hasNextStep }), onClick: () => editorInstance.redo() },\n                React.createElement(\"i\", { className: \"fa fa-share\" }),\n                React.createElement(\"span\", null, \"\\u56DE\\u9000\")),\n            React.createElement(\"div\", { className: cls('toolbar-item'), onClick: onCopyClick },\n                React.createElement(\"i\", { className: \"fa fa-copy\" }),\n                React.createElement(\"span\", null, \"\\u590D\\u5236\")),\n            React.createElement(\"div\", { className: cls('toolbar-item'), onClick: onDownloadClick },\n                React.createElement(\"i\", { className: \"fa fa-save\" }),\n                React.createElement(\"span\", null, \"\\u5BFC\\u51FA\")),\n            React.createElement(\"div\", { className: cls('toolbar-item'), onClick: onSaveClick },\n                React.createElement(\"i\", { className: \"fa fa-cloud-upload  \" }),\n                React.createElement(\"span\", null, \"\\u4FDD\\u5B58\"))),\n        React.createElement(\"div\", { className: \"toolbar-right\" })));\n}));\n"]}]}