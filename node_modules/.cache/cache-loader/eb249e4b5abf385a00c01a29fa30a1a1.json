{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--5-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\assets\\scripts\\draggabilly.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\assets\\scripts\\draggabilly.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwovKiEKICogRHJhZ2dhYmlsbHkgUEFDS0FHRUQgdjIuMy4wCiAqIE1ha2UgdGhhdCBzaGl6IGRyYWdnYWJsZQogKiBodHRwczovL2RyYWdnYWJpbGx5LmRlc2FuZHJvLmNvbQogKiBNSVQgbGljZW5zZQogKi8KCi8qKgogKiBCcmlkZ2V0IG1ha2VzIGpRdWVyeSB3aWRnZXRzCiAqIHYyLjAuMQogKiBNSVQgbGljZW5zZQogKi8KCi8qIGpzaGludCBicm93c2VyOiB0cnVlLCBzdHJpY3Q6IHRydWUsIHVuZGVmOiB0cnVlLCB1bnVzZWQ6IHRydWUgKi8KCjsKCihmdW5jdGlvbiAod2luZG93LCBmYWN0b3J5KSB7CiAgLy8gdW5pdmVyc2FsIG1vZHVsZSBkZWZpbml0aW9uCgogIC8qanNoaW50IHN0cmljdDogZmFsc2UgKi8KCiAgLyogZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqLwogIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ECiAgICBkZWZpbmUoJ2pxdWVyeS1icmlkZ2V0L2pxdWVyeS1icmlkZ2V0JywgWydqcXVlcnknXSwgZnVuY3Rpb24gKGpRdWVyeSkgewogICAgICByZXR1cm4gZmFjdG9yeSh3aW5kb3csIGpRdWVyeSk7CiAgICB9KTsKICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHsKICAgIC8vIENvbW1vbkpTCiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnkod2luZG93LCByZXF1aXJlKCdqcXVlcnknKSk7CiAgfSBlbHNlIHsKICAgIC8vIGJyb3dzZXIgZ2xvYmFsCiAgICB3aW5kb3cualF1ZXJ5QnJpZGdldCA9IGZhY3Rvcnkod2luZG93LCB3aW5kb3cualF1ZXJ5KTsKICB9Cn0pKHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSh3aW5kb3csIGpRdWVyeSkgewogICd1c2Ugc3RyaWN0JzsgLy8gLS0tLS0gdXRpbHMgLS0tLS0gLy8KCiAgdmFyIGFycmF5U2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7IC8vIGhlbHBlciBmdW5jdGlvbiBmb3IgbG9nZ2luZyBlcnJvcnMKICAvLyAkLmVycm9yIGJyZWFrcyBqUXVlcnkgY2hhaW5pbmcKCiAgdmFyIGNvbnNvbGUgPSB3aW5kb3cuY29uc29sZTsKICB2YXIgbG9nRXJyb3IgPSB0eXBlb2YgY29uc29sZSA9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICgpIHt9IDogZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7CiAgfTsgLy8gLS0tLS0galF1ZXJ5QnJpZGdldCAtLS0tLSAvLwoKICBmdW5jdGlvbiBqUXVlcnlCcmlkZ2V0KG5hbWVzcGFjZSwgUGx1Z2luQ2xhc3MsICQpIHsKICAgICQgPSAkIHx8IGpRdWVyeSB8fCB3aW5kb3cualF1ZXJ5OwoKICAgIGlmICghJCkgewogICAgICByZXR1cm47CiAgICB9IC8vIGFkZCBvcHRpb24gbWV0aG9kIC0+ICQoKS5wbHVnaW4oJ29wdGlvbicsIHsuLi59KQoKCiAgICBpZiAoIVBsdWdpbkNsYXNzLnByb3RvdHlwZS5vcHRpb24pIHsKICAgICAgLy8gb3B0aW9uIHNldHRlcgogICAgICBQbHVnaW5DbGFzcy5wcm90b3R5cGUub3B0aW9uID0gZnVuY3Rpb24gKG9wdHMpIHsKICAgICAgICAvLyBiYWlsIG91dCBpZiBub3QgYW4gb2JqZWN0CiAgICAgICAgaWYgKCEkLmlzUGxhaW5PYmplY3Qob3B0cykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHRoaXMub3B0aW9ucywgb3B0cyk7CiAgICAgIH07CiAgICB9IC8vIG1ha2UgalF1ZXJ5IHBsdWdpbgoKCiAgICAkLmZuW25hbWVzcGFjZV0gPSBmdW5jdGlvbiAoYXJnMAogICAgLyosIGFyZzEgKi8KICAgICkgewogICAgICBpZiAodHlwZW9mIGFyZzAgPT0gJ3N0cmluZycpIHsKICAgICAgICAvLyBtZXRob2QgY2FsbCAkKCkucGx1Z2luKCAnbWV0aG9kTmFtZScsIHsgb3B0aW9ucyB9ICkKICAgICAgICAvLyBzaGlmdCBhcmd1bWVudHMgYnkgMQogICAgICAgIHZhciBhcmdzID0gYXJyYXlTbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICAgICAgcmV0dXJuIG1ldGhvZENhbGwodGhpcywgYXJnMCwgYXJncyk7CiAgICAgIH0gLy8ganVzdCAkKCkucGx1Z2luKHsgb3B0aW9ucyB9KQoKCiAgICAgIHBsYWluQ2FsbCh0aGlzLCBhcmcwKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OyAvLyAkKCkucGx1Z2luKCdtZXRob2ROYW1lJykKCgogICAgZnVuY3Rpb24gbWV0aG9kQ2FsbCgkZWxlbXMsIG1ldGhvZE5hbWUsIGFyZ3MpIHsKICAgICAgdmFyIHJldHVyblZhbHVlOwogICAgICB2YXIgcGx1Z2luTWV0aG9kU3RyID0gJyQoKS4nICsgbmFtZXNwYWNlICsgJygiJyArIG1ldGhvZE5hbWUgKyAnIiknOwogICAgICAkZWxlbXMuZWFjaChmdW5jdGlvbiAoaSwgZWxlbSkgewogICAgICAgIC8vIGdldCBpbnN0YW5jZQogICAgICAgIHZhciBpbnN0YW5jZSA9ICQuZGF0YShlbGVtLCBuYW1lc3BhY2UpOwoKICAgICAgICBpZiAoIWluc3RhbmNlKSB7CiAgICAgICAgICBsb2dFcnJvcihuYW1lc3BhY2UgKyAnIG5vdCBpbml0aWFsaXplZC4gQ2Fubm90IGNhbGwgbWV0aG9kcywgaS5lLiAnICsgcGx1Z2luTWV0aG9kU3RyKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBtZXRob2QgPSBpbnN0YW5jZVttZXRob2ROYW1lXTsKCiAgICAgICAgaWYgKCFtZXRob2QgfHwgbWV0aG9kTmFtZS5jaGFyQXQoMCkgPT0gJ18nKSB7CiAgICAgICAgICBsb2dFcnJvcihwbHVnaW5NZXRob2RTdHIgKyAnIGlzIG5vdCBhIHZhbGlkIG1ldGhvZCcpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gYXBwbHkgbWV0aG9kLCBnZXQgcmV0dXJuIHZhbHVlCgoKICAgICAgICB2YXIgdmFsdWUgPSBtZXRob2QuYXBwbHkoaW5zdGFuY2UsIGFyZ3MpOyAvLyBzZXQgcmV0dXJuIHZhbHVlIGlmIHZhbHVlIGlzIHJldHVybmVkLCB1c2Ugb25seSBmaXJzdCB2YWx1ZQoKICAgICAgICByZXR1cm5WYWx1ZSA9IHJldHVyblZhbHVlID09PSB1bmRlZmluZWQgPyB2YWx1ZSA6IHJldHVyblZhbHVlOwogICAgICB9KTsKICAgICAgcmV0dXJuIHJldHVyblZhbHVlICE9PSB1bmRlZmluZWQgPyByZXR1cm5WYWx1ZSA6ICRlbGVtczsKICAgIH0KCiAgICBmdW5jdGlvbiBwbGFpbkNhbGwoJGVsZW1zLCBvcHRpb25zKSB7CiAgICAgICRlbGVtcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtKSB7CiAgICAgICAgdmFyIGluc3RhbmNlID0gJC5kYXRhKGVsZW0sIG5hbWVzcGFjZSk7CgogICAgICAgIGlmIChpbnN0YW5jZSkgewogICAgICAgICAgLy8gc2V0IG9wdGlvbnMgJiBpbml0CiAgICAgICAgICBpbnN0YW5jZS5vcHRpb24ob3B0aW9ucyk7CgogICAgICAgICAgaW5zdGFuY2UuX2luaXQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gaW5pdGlhbGl6ZSBuZXcgaW5zdGFuY2UKICAgICAgICAgIGluc3RhbmNlID0gbmV3IFBsdWdpbkNsYXNzKGVsZW0sIG9wdGlvbnMpOwogICAgICAgICAgJC5kYXRhKGVsZW0sIG5hbWVzcGFjZSwgaW5zdGFuY2UpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgdXBkYXRlSlF1ZXJ5KCQpOwogIH0gLy8gLS0tLS0gdXBkYXRlSlF1ZXJ5IC0tLS0tIC8vCiAgLy8gc2V0ICQuYnJpZGdldCBmb3IgdjEgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkKCgogIGZ1bmN0aW9uIHVwZGF0ZUpRdWVyeSgkKSB7CiAgICBpZiAoISQgfHwgJCAmJiAkLmJyaWRnZXQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgICQuYnJpZGdldCA9IGpRdWVyeUJyaWRnZXQ7CiAgfQoKICB1cGRhdGVKUXVlcnkoalF1ZXJ5IHx8IHdpbmRvdy5qUXVlcnkpOyAvLyAtLS0tLSAgLS0tLS0gLy8KCiAgcmV0dXJuIGpRdWVyeUJyaWRnZXQ7Cn0pOwoKKGZ1bmN0aW9uICh3aW5kb3csIGZhY3RvcnkpIHsKICAndXNlIHN0cmljdCc7CgogIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ECiAgICBkZWZpbmUoJ2dldC1zaXplL2dldC1zaXplJywgW10sIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGZhY3RvcnkoKTsKICAgIH0pOwogIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgLy8gQ29tbW9uSlMKICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwogIH0gZWxzZSB7CiAgICAvLyBicm93c2VyIGdsb2JhbAogICAgd2luZG93LmdldFNpemUgPSBmYWN0b3J5KCk7CiAgfQp9KSh3aW5kb3csIGZ1bmN0aW9uIGZhY3RvcnkoKSB7CiAgJ3VzZSBzdHJpY3QnOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgLy8gZ2V0IGEgbnVtYmVyIGZyb20gYSBzdHJpbmcsIG5vdCBhIHBlcmNlbnRhZ2UKCiAgZnVuY3Rpb24gZ2V0U3R5bGVTaXplKHZhbHVlKSB7CiAgICB2YXIgbnVtID0gcGFyc2VGbG9hdCh2YWx1ZSk7IC8vIG5vdCBhIHBlcmNlbnQgbGlrZSAnMTAwJScsIGFuZCBhIG51bWJlcgoKICAgIHZhciBpc1ZhbGlkID0gdmFsdWUuaW5kZXhPZignJScpID09IC0xICYmICFpc05hTihudW0pOwogICAgcmV0dXJuIGlzVmFsaWQgJiYgbnVtOwogIH0KCiAgZnVuY3Rpb24gbm9vcCgpIHt9CgogIHZhciBsb2dFcnJvciA9IHR5cGVvZiBjb25zb2xlID09ICd1bmRlZmluZWQnID8gbm9vcCA6IGZ1bmN0aW9uIChtZXNzYWdlKSB7CiAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UpOwogIH07IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIG1lYXN1cmVtZW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwoKICB2YXIgbWVhc3VyZW1lbnRzID0gWydwYWRkaW5nTGVmdCcsICdwYWRkaW5nUmlnaHQnLCAncGFkZGluZ1RvcCcsICdwYWRkaW5nQm90dG9tJywgJ21hcmdpbkxlZnQnLCAnbWFyZ2luUmlnaHQnLCAnbWFyZ2luVG9wJywgJ21hcmdpbkJvdHRvbScsICdib3JkZXJMZWZ0V2lkdGgnLCAnYm9yZGVyUmlnaHRXaWR0aCcsICdib3JkZXJUb3BXaWR0aCcsICdib3JkZXJCb3R0b21XaWR0aCddOwogIHZhciBtZWFzdXJlbWVudHNMZW5ndGggPSBtZWFzdXJlbWVudHMubGVuZ3RoOwoKICBmdW5jdGlvbiBnZXRaZXJvU2l6ZSgpIHsKICAgIHZhciBzaXplID0gewogICAgICB3aWR0aDogMCwKICAgICAgaGVpZ2h0OiAwLAogICAgICBpbm5lcldpZHRoOiAwLAogICAgICBpbm5lckhlaWdodDogMCwKICAgICAgb3V0ZXJXaWR0aDogMCwKICAgICAgb3V0ZXJIZWlnaHQ6IDAKICAgIH07CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZWFzdXJlbWVudHNMZW5ndGg7IGkrKykgewogICAgICB2YXIgbWVhc3VyZW1lbnQgPSBtZWFzdXJlbWVudHNbaV07CiAgICAgIHNpemVbbWVhc3VyZW1lbnRdID0gMDsKICAgIH0KCiAgICByZXR1cm4gc2l6ZTsKICB9IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGdldFN0eWxlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCgogIC8qKgogICAqIGdldFN0eWxlLCBnZXQgc3R5bGUgb2YgZWxlbWVudCwgY2hlY2sgZm9yIEZpcmVmb3ggYnVnCiAgICogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NTQ4Mzk3CiAgICovCgoKICBmdW5jdGlvbiBnZXRTdHlsZShlbGVtKSB7CiAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW0pOwoKICAgIGlmICghc3R5bGUpIHsKICAgICAgbG9nRXJyb3IoJ1N0eWxlIHJldHVybmVkICcgKyBzdHlsZSArICcuIEFyZSB5b3UgcnVubmluZyB0aGlzIGNvZGUgaW4gYSBoaWRkZW4gaWZyYW1lIG9uIEZpcmVmb3g/ICcgKyAnU2VlIGh0dHA6Ly9iaXQubHkvZ2V0c2l6ZWJ1ZzEnKTsKICAgIH0KCiAgICByZXR1cm4gc3R5bGU7CiAgfSAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzZXR1cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwoKCiAgdmFyIGlzU2V0dXAgPSBmYWxzZTsKICB2YXIgaXNCb3hTaXplT3V0ZXI7CiAgLyoqCiAgICogc2V0dXAKICAgKiBjaGVjayBpc0JveFNpemVyT3V0ZXIKICAgKiBkbyBvbiBmaXJzdCBnZXRTaXplKCkgcmF0aGVyIHRoYW4gb24gcGFnZSBsb2FkIGZvciBGaXJlZm94IGJ1ZwogICAqLwoKICBmdW5jdGlvbiBzZXR1cCgpIHsKICAgIC8vIHNldHVwIG9uY2UKICAgIGlmIChpc1NldHVwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpc1NldHVwID0gdHJ1ZTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYm94IHNpemluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwoKICAgIC8qKgogICAgICogV2ViS2l0IG1lYXN1cmVzIHRoZSBvdXRlci13aWR0aCBvbiBzdHlsZS53aWR0aCBvbiBib3JkZXItYm94IGVsZW1zCiAgICAgKiBJRSAmIEZpcmVmb3g8MjkgbWVhc3VyZXMgdGhlIGlubmVyLXdpZHRoCiAgICAgKi8KCiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBkaXYuc3R5bGUud2lkdGggPSAnMjAwcHgnOwogICAgZGl2LnN0eWxlLnBhZGRpbmcgPSAnMXB4IDJweCAzcHggNHB4JzsKICAgIGRpdi5zdHlsZS5ib3JkZXJTdHlsZSA9ICdzb2xpZCc7CiAgICBkaXYuc3R5bGUuYm9yZGVyV2lkdGggPSAnMXB4IDJweCAzcHggNHB4JzsKICAgIGRpdi5zdHlsZS5ib3hTaXppbmcgPSAnYm9yZGVyLWJveCc7CiAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgYm9keS5hcHBlbmRDaGlsZChkaXYpOwogICAgdmFyIHN0eWxlID0gZ2V0U3R5bGUoZGl2KTsKICAgIGdldFNpemUuaXNCb3hTaXplT3V0ZXIgPSBpc0JveFNpemVPdXRlciA9IGdldFN0eWxlU2l6ZShzdHlsZS53aWR0aCkgPT0gMjAwOwogICAgYm9keS5yZW1vdmVDaGlsZChkaXYpOwogIH0gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZ2V0U2l6ZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwoKCiAgZnVuY3Rpb24gZ2V0U2l6ZShlbGVtKSB7CiAgICBzZXR1cCgpOyAvLyB1c2UgcXVlcnlTZWxldG9yIGlmIGVsZW0gaXMgc3RyaW5nCgogICAgaWYgKHR5cGVvZiBlbGVtID09ICdzdHJpbmcnKSB7CiAgICAgIGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW0pOwogICAgfSAvLyBkbyBub3QgcHJvY2VlZCBvbiBub24tb2JqZWN0cwoKCiAgICBpZiAoIWVsZW0gfHwgdHlwZW9mIGVsZW0gIT0gJ29iamVjdCcgfHwgIWVsZW0ubm9kZVR5cGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzdHlsZSA9IGdldFN0eWxlKGVsZW0pOyAvLyBpZiBoaWRkZW4sIGV2ZXJ5dGhpbmcgaXMgMAoKICAgIGlmIChzdHlsZS5kaXNwbGF5ID09ICdub25lJykgewogICAgICByZXR1cm4gZ2V0WmVyb1NpemUoKTsKICAgIH0KCiAgICB2YXIgc2l6ZSA9IHt9OwogICAgc2l6ZS53aWR0aCA9IGVsZW0ub2Zmc2V0V2lkdGg7CiAgICBzaXplLmhlaWdodCA9IGVsZW0ub2Zmc2V0SGVpZ2h0OwogICAgdmFyIGlzQm9yZGVyQm94ID0gc2l6ZS5pc0JvcmRlckJveCA9IHN0eWxlLmJveFNpemluZyA9PSAnYm9yZGVyLWJveCc7IC8vIGdldCBhbGwgbWVhc3VyZW1lbnRzCgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZWFzdXJlbWVudHNMZW5ndGg7IGkrKykgewogICAgICB2YXIgbWVhc3VyZW1lbnQgPSBtZWFzdXJlbWVudHNbaV07CiAgICAgIHZhciB2YWx1ZSA9IHN0eWxlW21lYXN1cmVtZW50XTsKICAgICAgdmFyIG51bSA9IHBhcnNlRmxvYXQodmFsdWUpOyAvLyBhbnkgJ2F1dG8nLCAnbWVkaXVtJyB2YWx1ZSB3aWxsIGJlIDAKCiAgICAgIHNpemVbbWVhc3VyZW1lbnRdID0gIWlzTmFOKG51bSkgPyBudW0gOiAwOwogICAgfQoKICAgIHZhciBwYWRkaW5nV2lkdGggPSBzaXplLnBhZGRpbmdMZWZ0ICsgc2l6ZS5wYWRkaW5nUmlnaHQ7CiAgICB2YXIgcGFkZGluZ0hlaWdodCA9IHNpemUucGFkZGluZ1RvcCArIHNpemUucGFkZGluZ0JvdHRvbTsKICAgIHZhciBtYXJnaW5XaWR0aCA9IHNpemUubWFyZ2luTGVmdCArIHNpemUubWFyZ2luUmlnaHQ7CiAgICB2YXIgbWFyZ2luSGVpZ2h0ID0gc2l6ZS5tYXJnaW5Ub3AgKyBzaXplLm1hcmdpbkJvdHRvbTsKICAgIHZhciBib3JkZXJXaWR0aCA9IHNpemUuYm9yZGVyTGVmdFdpZHRoICsgc2l6ZS5ib3JkZXJSaWdodFdpZHRoOwogICAgdmFyIGJvcmRlckhlaWdodCA9IHNpemUuYm9yZGVyVG9wV2lkdGggKyBzaXplLmJvcmRlckJvdHRvbVdpZHRoOwogICAgdmFyIGlzQm9yZGVyQm94U2l6ZU91dGVyID0gaXNCb3JkZXJCb3ggJiYgaXNCb3hTaXplT3V0ZXI7IC8vIG92ZXJ3cml0ZSB3aWR0aCBhbmQgaGVpZ2h0IGlmIHdlIGNhbiBnZXQgaXQgZnJvbSBzdHlsZQoKICAgIHZhciBzdHlsZVdpZHRoID0gZ2V0U3R5bGVTaXplKHN0eWxlLndpZHRoKTsKCiAgICBpZiAoc3R5bGVXaWR0aCAhPT0gZmFsc2UpIHsKICAgICAgc2l6ZS53aWR0aCA9IHN0eWxlV2lkdGggKyAoIC8vIGFkZCBwYWRkaW5nIGFuZCBib3JkZXIgdW5sZXNzIGl0J3MgYWxyZWFkeSBpbmNsdWRpbmcgaXQKICAgICAgaXNCb3JkZXJCb3hTaXplT3V0ZXIgPyAwIDogcGFkZGluZ1dpZHRoICsgYm9yZGVyV2lkdGgpOwogICAgfQoKICAgIHZhciBzdHlsZUhlaWdodCA9IGdldFN0eWxlU2l6ZShzdHlsZS5oZWlnaHQpOwoKICAgIGlmIChzdHlsZUhlaWdodCAhPT0gZmFsc2UpIHsKICAgICAgc2l6ZS5oZWlnaHQgPSBzdHlsZUhlaWdodCArICggLy8gYWRkIHBhZGRpbmcgYW5kIGJvcmRlciB1bmxlc3MgaXQncyBhbHJlYWR5IGluY2x1ZGluZyBpdAogICAgICBpc0JvcmRlckJveFNpemVPdXRlciA/IDAgOiBwYWRkaW5nSGVpZ2h0ICsgYm9yZGVySGVpZ2h0KTsKICAgIH0KCiAgICBzaXplLmlubmVyV2lkdGggPSBzaXplLndpZHRoIC0gKHBhZGRpbmdXaWR0aCArIGJvcmRlcldpZHRoKTsKICAgIHNpemUuaW5uZXJIZWlnaHQgPSBzaXplLmhlaWdodCAtIChwYWRkaW5nSGVpZ2h0ICsgYm9yZGVySGVpZ2h0KTsKICAgIHNpemUub3V0ZXJXaWR0aCA9IHNpemUud2lkdGggKyBtYXJnaW5XaWR0aDsKICAgIHNpemUub3V0ZXJIZWlnaHQgPSBzaXplLmhlaWdodCArIG1hcmdpbkhlaWdodDsKICAgIHJldHVybiBzaXplOwogIH0KCiAgcmV0dXJuIGdldFNpemU7Cn0pOwoKKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb24KCiAgLyoganNoaW50IHN0cmljdDogZmFsc2UgKi8KCiAgLyogZ2xvYmFscyBkZWZpbmUsIG1vZHVsZSwgd2luZG93ICovCiAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7CiAgICAvLyBBTUQgLSBSZXF1aXJlSlMKICAgIGRlZmluZSgnZXYtZW1pdHRlci9ldi1lbWl0dGVyJywgZmFjdG9yeSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7CiAgICAvLyBDb21tb25KUyAtIEJyb3dzZXJpZnksIFdlYnBhY2sKICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwogIH0gZWxzZSB7CiAgICAvLyBCcm93c2VyIGdsb2JhbHMKICAgIGdsb2JhbC5FdkVtaXR0ZXIgPSBmYWN0b3J5KCk7CiAgfQp9KSh0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEV2RW1pdHRlcigpIHt9CgogIHZhciBwcm90byA9IEV2RW1pdHRlci5wcm90b3R5cGU7CgogIHByb3RvLm9uID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHsKICAgIGlmICghZXZlbnROYW1lIHx8ICFsaXN0ZW5lcikgewogICAgICByZXR1cm47CiAgICB9IC8vIHNldCBldmVudHMgaGFzaAoKCiAgICB2YXIgZXZlbnRzID0gdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9OyAvLyBzZXQgbGlzdGVuZXJzIGFycmF5CgogICAgdmFyIGxpc3RlbmVycyA9IGV2ZW50c1tldmVudE5hbWVdID0gZXZlbnRzW2V2ZW50TmFtZV0gfHwgW107IC8vIG9ubHkgYWRkIG9uY2UKCiAgICBpZiAobGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpID09IC0xKSB7CiAgICAgIGxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwcm90by5vbmNlID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHsKICAgIGlmICghZXZlbnROYW1lIHx8ICFsaXN0ZW5lcikgewogICAgICByZXR1cm47CiAgICB9IC8vIGFkZCBldmVudAoKCiAgICB0aGlzLm9uKGV2ZW50TmFtZSwgbGlzdGVuZXIpOyAvLyBzZXQgb25jZSBmbGFnCiAgICAvLyBzZXQgb25jZUV2ZW50cyBoYXNoCgogICAgdmFyIG9uY2VFdmVudHMgPSB0aGlzLl9vbmNlRXZlbnRzID0gdGhpcy5fb25jZUV2ZW50cyB8fCB7fTsgLy8gc2V0IG9uY2VMaXN0ZW5lcnMgb2JqZWN0CgogICAgdmFyIG9uY2VMaXN0ZW5lcnMgPSBvbmNlRXZlbnRzW2V2ZW50TmFtZV0gPSBvbmNlRXZlbnRzW2V2ZW50TmFtZV0gfHwge307IC8vIHNldCBmbGFnCgogICAgb25jZUxpc3RlbmVyc1tsaXN0ZW5lcl0gPSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgcHJvdG8ub2ZmID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHsKICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHMgJiYgdGhpcy5fZXZlbnRzW2V2ZW50TmFtZV07CgogICAgaWYgKCFsaXN0ZW5lcnMgfHwgIWxpc3RlbmVycy5sZW5ndGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBpbmRleCA9IGxpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTsKCiAgICBpZiAoaW5kZXggIT0gLTEpIHsKICAgICAgbGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgcHJvdG8uZW1pdEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgYXJncykgewogICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50cyAmJiB0aGlzLl9ldmVudHNbZXZlbnROYW1lXTsKCiAgICBpZiAoIWxpc3RlbmVycyB8fCAhbGlzdGVuZXJzLmxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9IC8vIGNvcHkgb3ZlciB0byBhdm9pZCBpbnRlcmZlcmVuY2UgaWYgLm9mZigpIGluIGxpc3RlbmVyCgoKICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5zbGljZSgwKTsKICAgIGFyZ3MgPSBhcmdzIHx8IFtdOyAvLyBvbmNlIHN0dWZmCgogICAgdmFyIG9uY2VMaXN0ZW5lcnMgPSB0aGlzLl9vbmNlRXZlbnRzICYmIHRoaXMuX29uY2VFdmVudHNbZXZlbnROYW1lXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07CiAgICAgIHZhciBpc09uY2UgPSBvbmNlTGlzdGVuZXJzICYmIG9uY2VMaXN0ZW5lcnNbbGlzdGVuZXJdOwoKICAgICAgaWYgKGlzT25jZSkgewogICAgICAgIC8vIHJlbW92ZSBsaXN0ZW5lcgogICAgICAgIC8vIHJlbW92ZSBiZWZvcmUgdHJpZ2dlciB0byBwcmV2ZW50IHJlY3Vyc2lvbgogICAgICAgIHRoaXMub2ZmKGV2ZW50TmFtZSwgbGlzdGVuZXIpOyAvLyB1bnNldCBvbmNlIGZsYWcKCiAgICAgICAgZGVsZXRlIG9uY2VMaXN0ZW5lcnNbbGlzdGVuZXJdOwogICAgICB9IC8vIHRyaWdnZXIgbGlzdGVuZXIKCgogICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmdzKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9OwoKICBwcm90by5hbGxPZmYgPSBmdW5jdGlvbiAoKSB7CiAgICBkZWxldGUgdGhpcy5fZXZlbnRzOwogICAgZGVsZXRlIHRoaXMuX29uY2VFdmVudHM7CiAgfTsKCiAgcmV0dXJuIEV2RW1pdHRlcjsKfSk7CgooZnVuY3Rpb24gKHdpbmRvdywgZmFjdG9yeSkgewogIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvbgoKICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLwoKICAvKmdsb2JhbCBkZWZpbmUsIG1vZHVsZSwgcmVxdWlyZSAqLwogIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ECiAgICBkZWZpbmUoJ3VuaXBvaW50ZXIvdW5pcG9pbnRlcicsIFsnZXYtZW1pdHRlci9ldi1lbWl0dGVyJ10sIGZ1bmN0aW9uIChFdkVtaXR0ZXIpIHsKICAgICAgcmV0dXJuIGZhY3Rvcnkod2luZG93LCBFdkVtaXR0ZXIpOwogICAgfSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7CiAgICAvLyBDb21tb25KUwogICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHdpbmRvdywgcmVxdWlyZSgnZXYtZW1pdHRlcicpKTsKICB9IGVsc2UgewogICAgLy8gYnJvd3NlciBnbG9iYWwKICAgIHdpbmRvdy5Vbmlwb2ludGVyID0gZmFjdG9yeSh3aW5kb3csIHdpbmRvdy5FdkVtaXR0ZXIpOwogIH0KfSkod2luZG93LCBmdW5jdGlvbiBmYWN0b3J5KHdpbmRvdywgRXZFbWl0dGVyKSB7CiAgZnVuY3Rpb24gbm9vcCgpIHt9CgogIGZ1bmN0aW9uIFVuaXBvaW50ZXIoKSB7fSAvLyBpbmhlcml0IEV2RW1pdHRlcgoKCiAgdmFyIHByb3RvID0gVW5pcG9pbnRlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEV2RW1pdHRlci5wcm90b3R5cGUpOwoKICBwcm90by5iaW5kU3RhcnRFdmVudCA9IGZ1bmN0aW9uIChlbGVtKSB7CiAgICB0aGlzLl9iaW5kU3RhcnRFdmVudChlbGVtLCB0cnVlKTsKICB9OwoKICBwcm90by51bmJpbmRTdGFydEV2ZW50ID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgIHRoaXMuX2JpbmRTdGFydEV2ZW50KGVsZW0sIGZhbHNlKTsKICB9OwogIC8qKgogICAqIEFkZCBvciByZW1vdmUgc3RhcnQgZXZlbnQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQWRkIC0gcmVtb3ZlIGlmIGZhbHNleQogICAqLwoKCiAgcHJvdG8uX2JpbmRTdGFydEV2ZW50ID0gZnVuY3Rpb24gKGVsZW0sIGlzQWRkKSB7CiAgICAvLyBtdW5nZSBpc0FkZCwgZGVmYXVsdCB0byB0cnVlCiAgICBpc0FkZCA9IGlzQWRkID09PSB1bmRlZmluZWQgPyB0cnVlIDogaXNBZGQ7CiAgICB2YXIgYmluZE1ldGhvZCA9IGlzQWRkID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInOyAvLyBkZWZhdWx0IHRvIG1vdXNlIGV2ZW50cwoKICAgIHZhciBzdGFydEV2ZW50ID0gJ21vdXNlZG93bic7CgogICAgaWYgKHdpbmRvdy5Qb2ludGVyRXZlbnQpIHsKICAgICAgLy8gUG9pbnRlciBFdmVudHMKICAgICAgc3RhcnRFdmVudCA9ICdwb2ludGVyZG93bic7CiAgICB9IGVsc2UgaWYgKCdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdykgewogICAgICAvLyBUb3VjaCBFdmVudHMuIGlPUyBTYWZhcmkKICAgICAgc3RhcnRFdmVudCA9ICd0b3VjaHN0YXJ0JzsKICAgIH0KCiAgICBlbGVtW2JpbmRNZXRob2RdKHN0YXJ0RXZlbnQsIHRoaXMpOwogIH07IC8vIHRyaWdnZXIgaGFuZGxlciBtZXRob2RzIGZvciBldmVudHMKCgogIHByb3RvLmhhbmRsZUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB2YXIgbWV0aG9kID0gJ29uJyArIGV2ZW50LnR5cGU7CgogICAgaWYgKHRoaXNbbWV0aG9kXSkgewogICAgICB0aGlzW21ldGhvZF0oZXZlbnQpOwogICAgfQogIH07IC8vIHJldHVybnMgdGhlIHRvdWNoIHRoYXQgd2UncmUga2VlcGluZyB0cmFjayBvZgoKCiAgcHJvdG8uZ2V0VG91Y2ggPSBmdW5jdGlvbiAodG91Y2hlcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3VjaGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciB0b3VjaCA9IHRvdWNoZXNbaV07CgogICAgICBpZiAodG91Y2guaWRlbnRpZmllciA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyKSB7CiAgICAgICAgcmV0dXJuIHRvdWNoOwogICAgICB9CiAgICB9CiAgfTsgLy8gLS0tLS0gc3RhcnQgZXZlbnQgLS0tLS0gLy8KCgogIHByb3RvLm9ubW91c2Vkb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAvLyBkaXNtaXNzIGNsaWNrcyBmcm9tIHJpZ2h0IG9yIG1pZGRsZSBidXR0b25zCiAgICB2YXIgYnV0dG9uID0gZXZlbnQuYnV0dG9uOwoKICAgIGlmIChidXR0b24gJiYgYnV0dG9uICE9PSAwICYmIGJ1dHRvbiAhPT0gMSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fcG9pbnRlckRvd24oZXZlbnQsIGV2ZW50KTsKICB9OwoKICBwcm90by5vbnRvdWNoc3RhcnQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHRoaXMuX3BvaW50ZXJEb3duKGV2ZW50LCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSk7CiAgfTsKCiAgcHJvdG8ub25wb2ludGVyZG93biA9IGZ1bmN0aW9uIChldmVudCkgewogICAgdGhpcy5fcG9pbnRlckRvd24oZXZlbnQsIGV2ZW50KTsKICB9OwogIC8qKgogICAqIHBvaW50ZXIgc3RhcnQKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXIKICAgKi8KCgogIHByb3RvLl9wb2ludGVyRG93biA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgLy8gZGlzbWlzcyByaWdodCBjbGljayBhbmQgb3RoZXIgcG9pbnRlcnMKICAgIC8vIGJ1dHRvbiA9IDAgaXMgb2theSwgMS00IG5vdAogICAgaWYgKGV2ZW50LmJ1dHRvbiB8fCB0aGlzLmlzUG9pbnRlckRvd24pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuaXNQb2ludGVyRG93biA9IHRydWU7IC8vIHNhdmUgcG9pbnRlciBpZGVudGlmaWVyIHRvIG1hdGNoIHVwIHRvdWNoIGV2ZW50cwoKICAgIHRoaXMucG9pbnRlcklkZW50aWZpZXIgPSBwb2ludGVyLnBvaW50ZXJJZCAhPT0gdW5kZWZpbmVkID8gLy8gcG9pbnRlcklkIGZvciBwb2ludGVyIGV2ZW50cywgdG91Y2guaW5kZW50aWZpZXIgZm9yIHRvdWNoIGV2ZW50cwogICAgcG9pbnRlci5wb2ludGVySWQgOiBwb2ludGVyLmlkZW50aWZpZXI7CiAgICB0aGlzLnBvaW50ZXJEb3duKGV2ZW50LCBwb2ludGVyKTsKICB9OwoKICBwcm90by5wb2ludGVyRG93biA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgdGhpcy5fYmluZFBvc3RTdGFydEV2ZW50cyhldmVudCk7CgogICAgdGhpcy5lbWl0RXZlbnQoJ3BvaW50ZXJEb3duJywgW2V2ZW50LCBwb2ludGVyXSk7CiAgfTsgLy8gaGFzaCBvZiBldmVudHMgdG8gYmUgYm91bmQgYWZ0ZXIgc3RhcnQgZXZlbnQKCgogIHZhciBwb3N0U3RhcnRFdmVudHMgPSB7CiAgICBtb3VzZWRvd246IFsnbW91c2Vtb3ZlJywgJ21vdXNldXAnXSwKICAgIHRvdWNoc3RhcnQ6IFsndG91Y2htb3ZlJywgJ3RvdWNoZW5kJywgJ3RvdWNoY2FuY2VsJ10sCiAgICBwb2ludGVyZG93bjogWydwb2ludGVybW92ZScsICdwb2ludGVydXAnLCAncG9pbnRlcmNhbmNlbCddCiAgfTsKCiAgcHJvdG8uX2JpbmRQb3N0U3RhcnRFdmVudHMgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmICghZXZlbnQpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyBnZXQgcHJvcGVyIGV2ZW50cyB0byBtYXRjaCBzdGFydCBldmVudAoKCiAgICB2YXIgZXZlbnRzID0gcG9zdFN0YXJ0RXZlbnRzW2V2ZW50LnR5cGVdOyAvLyBiaW5kIGV2ZW50cyB0byBub2RlCgogICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkgewogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHRoaXMpOwogICAgfSwgdGhpcyk7IC8vIHNhdmUgdGhlc2UgYXJndW1lbnRzCgogICAgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzID0gZXZlbnRzOwogIH07CgogIHByb3RvLl91bmJpbmRQb3N0U3RhcnRFdmVudHMgPSBmdW5jdGlvbiAoKSB7CiAgICAvLyBjaGVjayBmb3IgX2JvdW5kRXZlbnRzLCBpbiBjYXNlIGRyYWdFbmQgdHJpZ2dlcmVkIHR3aWNlIChvbGQgSUU4IGJ1ZykKICAgIGlmICghdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9ib3VuZFBvaW50ZXJFdmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnROYW1lKSB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgdGhpcyk7CiAgICB9LCB0aGlzKTsKCiAgICBkZWxldGUgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzOwogIH07IC8vIC0tLS0tIG1vdmUgZXZlbnQgLS0tLS0gLy8KCgogIHByb3RvLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB0aGlzLl9wb2ludGVyTW92ZShldmVudCwgZXZlbnQpOwogIH07CgogIHByb3RvLm9ucG9pbnRlcm1vdmUgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmIChldmVudC5wb2ludGVySWQgPT0gdGhpcy5wb2ludGVySWRlbnRpZmllcikgewogICAgICB0aGlzLl9wb2ludGVyTW92ZShldmVudCwgZXZlbnQpOwogICAgfQogIH07CgogIHByb3RvLm9udG91Y2htb3ZlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB2YXIgdG91Y2ggPSB0aGlzLmdldFRvdWNoKGV2ZW50LmNoYW5nZWRUb3VjaGVzKTsKCiAgICBpZiAodG91Y2gpIHsKICAgICAgdGhpcy5fcG9pbnRlck1vdmUoZXZlbnQsIHRvdWNoKTsKICAgIH0KICB9OwogIC8qKgogICAqIHBvaW50ZXIgbW92ZQogICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50CiAgICogQHBhcmFtIHtFdmVudCBvciBUb3VjaH0gcG9pbnRlcgogICAqIEBwcml2YXRlCiAgICovCgoKICBwcm90by5fcG9pbnRlck1vdmUgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIHRoaXMucG9pbnRlck1vdmUoZXZlbnQsIHBvaW50ZXIpOwogIH07IC8vIHB1YmxpYwoKCiAgcHJvdG8ucG9pbnRlck1vdmUgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIHRoaXMuZW1pdEV2ZW50KCdwb2ludGVyTW92ZScsIFtldmVudCwgcG9pbnRlcl0pOwogIH07IC8vIC0tLS0tIGVuZCBldmVudCAtLS0tLSAvLwoKCiAgcHJvdG8ub25tb3VzZXVwID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB0aGlzLl9wb2ludGVyVXAoZXZlbnQsIGV2ZW50KTsKICB9OwoKICBwcm90by5vbnBvaW50ZXJ1cCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKGV2ZW50LnBvaW50ZXJJZCA9PSB0aGlzLnBvaW50ZXJJZGVudGlmaWVyKSB7CiAgICAgIHRoaXMuX3BvaW50ZXJVcChldmVudCwgZXZlbnQpOwogICAgfQogIH07CgogIHByb3RvLm9udG91Y2hlbmQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHZhciB0b3VjaCA9IHRoaXMuZ2V0VG91Y2goZXZlbnQuY2hhbmdlZFRvdWNoZXMpOwoKICAgIGlmICh0b3VjaCkgewogICAgICB0aGlzLl9wb2ludGVyVXAoZXZlbnQsIHRvdWNoKTsKICAgIH0KICB9OwogIC8qKgogICAqIHBvaW50ZXIgdXAKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXIKICAgKiBAcHJpdmF0ZQogICAqLwoKCiAgcHJvdG8uX3BvaW50ZXJVcCA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgdGhpcy5fcG9pbnRlckRvbmUoKTsKCiAgICB0aGlzLnBvaW50ZXJVcChldmVudCwgcG9pbnRlcik7CiAgfTsgLy8gcHVibGljCgoKICBwcm90by5wb2ludGVyVXAgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIHRoaXMuZW1pdEV2ZW50KCdwb2ludGVyVXAnLCBbZXZlbnQsIHBvaW50ZXJdKTsKICB9OyAvLyAtLS0tLSBwb2ludGVyIGRvbmUgLS0tLS0gLy8KICAvLyB0cmlnZ2VyZWQgb24gcG9pbnRlciB1cCAmIHBvaW50ZXIgY2FuY2VsCgoKICBwcm90by5fcG9pbnRlckRvbmUgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLl9wb2ludGVyUmVzZXQoKTsKCiAgICB0aGlzLl91bmJpbmRQb3N0U3RhcnRFdmVudHMoKTsKCiAgICB0aGlzLnBvaW50ZXJEb25lKCk7CiAgfTsKCiAgcHJvdG8uX3BvaW50ZXJSZXNldCA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIHJlc2V0IHByb3BlcnRpZXMKICAgIHRoaXMuaXNQb2ludGVyRG93biA9IGZhbHNlOwogICAgZGVsZXRlIHRoaXMucG9pbnRlcklkZW50aWZpZXI7CiAgfTsKCiAgcHJvdG8ucG9pbnRlckRvbmUgPSBub29wOyAvLyAtLS0tLSBwb2ludGVyIGNhbmNlbCAtLS0tLSAvLwoKICBwcm90by5vbnBvaW50ZXJjYW5jZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmIChldmVudC5wb2ludGVySWQgPT0gdGhpcy5wb2ludGVySWRlbnRpZmllcikgewogICAgICB0aGlzLl9wb2ludGVyQ2FuY2VsKGV2ZW50LCBldmVudCk7CiAgICB9CiAgfTsKCiAgcHJvdG8ub250b3VjaGNhbmNlbCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgdmFyIHRvdWNoID0gdGhpcy5nZXRUb3VjaChldmVudC5jaGFuZ2VkVG91Y2hlcyk7CgogICAgaWYgKHRvdWNoKSB7CiAgICAgIHRoaXMuX3BvaW50ZXJDYW5jZWwoZXZlbnQsIHRvdWNoKTsKICAgIH0KICB9OwogIC8qKgogICAqIHBvaW50ZXIgY2FuY2VsCiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQKICAgKiBAcGFyYW0ge0V2ZW50IG9yIFRvdWNofSBwb2ludGVyCiAgICogQHByaXZhdGUKICAgKi8KCgogIHByb3RvLl9wb2ludGVyQ2FuY2VsID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLl9wb2ludGVyRG9uZSgpOwoKICAgIHRoaXMucG9pbnRlckNhbmNlbChldmVudCwgcG9pbnRlcik7CiAgfTsgLy8gcHVibGljCgoKICBwcm90by5wb2ludGVyQ2FuY2VsID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLmVtaXRFdmVudCgncG9pbnRlckNhbmNlbCcsIFtldmVudCwgcG9pbnRlcl0pOwogIH07IC8vIC0tLS0tICAtLS0tLSAvLwogIC8vIHV0aWxpdHkgZnVuY3Rpb24gZm9yIGdldHRpbmcgeC95IGNvb3JkcyBmcm9tIGV2ZW50CgoKICBVbmlwb2ludGVyLmdldFBvaW50ZXJQb2ludCA9IGZ1bmN0aW9uIChwb2ludGVyKSB7CiAgICByZXR1cm4gewogICAgICB4OiBwb2ludGVyLnBhZ2VYLAogICAgICB5OiBwb2ludGVyLnBhZ2VZCiAgICB9OwogIH07IC8vIC0tLS0tICAtLS0tLSAvLwoKCiAgcmV0dXJuIFVuaXBvaW50ZXI7Cn0pOwoKKGZ1bmN0aW9uICh3aW5kb3csIGZhY3RvcnkpIHsKICAvLyB1bml2ZXJzYWwgbW9kdWxlIGRlZmluaXRpb24KCiAgLypqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLwoKICAvKmdsb2JhbHMgZGVmaW5lLCBtb2R1bGUsIHJlcXVpcmUgKi8KICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRAogICAgZGVmaW5lKCd1bmlkcmFnZ2VyL3VuaWRyYWdnZXInLCBbJ3VuaXBvaW50ZXIvdW5pcG9pbnRlciddLCBmdW5jdGlvbiAoVW5pcG9pbnRlcikgewogICAgICByZXR1cm4gZmFjdG9yeSh3aW5kb3csIFVuaXBvaW50ZXIpOwogICAgfSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7CiAgICAvLyBDb21tb25KUwogICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHdpbmRvdywgcmVxdWlyZSgndW5pcG9pbnRlcicpKTsKICB9IGVsc2UgewogICAgLy8gYnJvd3NlciBnbG9iYWwKICAgIHdpbmRvdy5VbmlkcmFnZ2VyID0gZmFjdG9yeSh3aW5kb3csIHdpbmRvdy5Vbmlwb2ludGVyKTsKICB9Cn0pKHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSh3aW5kb3csIFVuaXBvaW50ZXIpIHsKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBVbmlkcmFnZ2VyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgZnVuY3Rpb24gVW5pZHJhZ2dlcigpIHt9IC8vIGluaGVyaXQgVW5pcG9pbnRlciAmIEV2RW1pdHRlcgoKCiAgdmFyIHByb3RvID0gVW5pZHJhZ2dlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFVuaXBvaW50ZXIucHJvdG90eXBlKTsgLy8gLS0tLS0gYmluZCBzdGFydCAtLS0tLSAvLwoKICBwcm90by5iaW5kSGFuZGxlcyA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuX2JpbmRIYW5kbGVzKHRydWUpOwogIH07CgogIHByb3RvLnVuYmluZEhhbmRsZXMgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLl9iaW5kSGFuZGxlcyhmYWxzZSk7CiAgfTsKICAvKioKICAgKiBBZGQgb3IgcmVtb3ZlIHN0YXJ0IGV2ZW50CiAgICogQHBhcmFtIHtCb29sZWFufSBpc0FkZAogICAqLwoKCiAgcHJvdG8uX2JpbmRIYW5kbGVzID0gZnVuY3Rpb24gKGlzQWRkKSB7CiAgICAvLyBtdW5nZSBpc0FkZCwgZGVmYXVsdCB0byB0cnVlCiAgICBpc0FkZCA9IGlzQWRkID09PSB1bmRlZmluZWQgPyB0cnVlIDogaXNBZGQ7IC8vIGJpbmQgZWFjaCBoYW5kbGUKCiAgICB2YXIgYmluZE1ldGhvZCA9IGlzQWRkID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInOwogICAgdmFyIHRvdWNoQWN0aW9uID0gaXNBZGQgPyB0aGlzLl90b3VjaEFjdGlvblZhbHVlIDogJyc7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmhhbmRsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGhhbmRsZSA9IHRoaXMuaGFuZGxlc1tpXTsKCiAgICAgIHRoaXMuX2JpbmRTdGFydEV2ZW50KGhhbmRsZSwgaXNBZGQpOwoKICAgICAgaGFuZGxlW2JpbmRNZXRob2RdKCdjbGljaycsIHRoaXMpOyAvLyB0b3VjaC1hY3Rpb246IG5vbmUgdG8gb3ZlcnJpZGUgYnJvd3NlciB0b3VjaCBnZXN0dXJlcy4gbWV0YWZpenp5L2ZsaWNraXR5IzU0MAoKICAgICAgaWYgKHdpbmRvdy5Qb2ludGVyRXZlbnQpIHsKICAgICAgICBoYW5kbGUuc3R5bGUudG91Y2hBY3Rpb24gPSB0b3VjaEFjdGlvbjsKICAgICAgfQogICAgfQogIH07IC8vIHByb3RvdHlwZSBzbyBpdCBjYW4gYmUgb3ZlcndyaXRlYWJsZSBieSBGbGlja2l0eQoKCiAgcHJvdG8uX3RvdWNoQWN0aW9uVmFsdWUgPSAnbm9uZSc7IC8vIC0tLS0tIHN0YXJ0IGV2ZW50IC0tLS0tIC8vCgogIC8qKgogICAqIHBvaW50ZXIgc3RhcnQKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXIKICAgKi8KCiAgcHJvdG8ucG9pbnRlckRvd24gPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIHZhciBpc09rYXkgPSB0aGlzLm9rYXlQb2ludGVyRG93bihldmVudCk7CgogICAgaWYgKCFpc09rYXkpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyB0cmFjayBzdGFydCBldmVudCBwb3NpdGlvbgoKCiAgICB0aGlzLnBvaW50ZXJEb3duUG9pbnRlciA9IHBvaW50ZXI7CiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgdGhpcy5wb2ludGVyRG93bkJsdXIoKTsgLy8gYmluZCBtb3ZlIGFuZCBlbmQgZXZlbnRzCgogICAgdGhpcy5fYmluZFBvc3RTdGFydEV2ZW50cyhldmVudCk7CgogICAgdGhpcy5lbWl0RXZlbnQoJ3BvaW50ZXJEb3duJywgW2V2ZW50LCBwb2ludGVyXSk7CiAgfTsgLy8gbm9kZXMgdGhhdCBoYXZlIHRleHQgZmllbGRzCgoKICB2YXIgY3Vyc29yTm9kZXMgPSB7CiAgICBURVhUQVJFQTogdHJ1ZSwKICAgIElOUFVUOiB0cnVlLAogICAgU0VMRUNUOiB0cnVlLAogICAgT1BUSU9OOiB0cnVlCiAgfTsgLy8gaW5wdXQgdHlwZXMgdGhhdCBkbyBub3QgaGF2ZSB0ZXh0IGZpZWxkcwoKICB2YXIgY2xpY2tUeXBlcyA9IHsKICAgIHJhZGlvOiB0cnVlLAogICAgY2hlY2tib3g6IHRydWUsCiAgICBidXR0b246IHRydWUsCiAgICBzdWJtaXQ6IHRydWUsCiAgICBpbWFnZTogdHJ1ZSwKICAgIGZpbGU6IHRydWUKICB9OyAvLyBkaXNtaXNzIGlucHV0cyB3aXRoIHRleHQgZmllbGRzLiBmbGlja2l0eSM0MDMsIGZsaWNraXR5IzQwNAoKICBwcm90by5va2F5UG9pbnRlckRvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHZhciBpc0N1cnNvck5vZGUgPSBjdXJzb3JOb2Rlc1tldmVudC50YXJnZXQubm9kZU5hbWVdOwogICAgdmFyIGlzQ2xpY2tUeXBlID0gY2xpY2tUeXBlc1tldmVudC50YXJnZXQudHlwZV07CiAgICB2YXIgaXNPa2F5ID0gIWlzQ3Vyc29yTm9kZSB8fCBpc0NsaWNrVHlwZTsKCiAgICBpZiAoIWlzT2theSkgewogICAgICB0aGlzLl9wb2ludGVyUmVzZXQoKTsKICAgIH0KCiAgICByZXR1cm4gaXNPa2F5OwogIH07IC8vIGtsdWRnZSB0byBibHVyIHByZXZpb3VzbHkgZm9jdXNlZCBpbnB1dAoKCiAgcHJvdG8ucG9pbnRlckRvd25CbHVyID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50OyAvLyBkbyBub3QgYmx1ciBib2R5IGZvciBJRTEwLCBtZXRhZml6enkvZmxpY2tpdHkjMTE3CgogICAgdmFyIGNhbkJsdXIgPSBmb2N1c2VkICYmIGZvY3VzZWQuYmx1ciAmJiBmb2N1c2VkICE9IGRvY3VtZW50LmJvZHk7CgogICAgaWYgKGNhbkJsdXIpIHsKICAgICAgZm9jdXNlZC5ibHVyKCk7CiAgICB9CiAgfTsgLy8gLS0tLS0gbW92ZSBldmVudCAtLS0tLSAvLwoKICAvKioKICAgKiBkcmFnIG1vdmUKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7RXZlbnQgb3IgVG91Y2h9IHBvaW50ZXIKICAgKi8KCgogIHByb3RvLnBvaW50ZXJNb3ZlID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB2YXIgbW92ZVZlY3RvciA9IHRoaXMuX2RyYWdQb2ludGVyTW92ZShldmVudCwgcG9pbnRlcik7CgogICAgdGhpcy5lbWl0RXZlbnQoJ3BvaW50ZXJNb3ZlJywgW2V2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yXSk7CgogICAgdGhpcy5fZHJhZ01vdmUoZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IpOwogIH07IC8vIGJhc2UgcG9pbnRlciBtb3ZlIGxvZ2ljCgoKICBwcm90by5fZHJhZ1BvaW50ZXJNb3ZlID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB2YXIgbW92ZVZlY3RvciA9IHsKICAgICAgeDogcG9pbnRlci5wYWdlWCAtIHRoaXMucG9pbnRlckRvd25Qb2ludGVyLnBhZ2VYLAogICAgICB5OiBwb2ludGVyLnBhZ2VZIC0gdGhpcy5wb2ludGVyRG93blBvaW50ZXIucGFnZVkKICAgIH07IC8vIHN0YXJ0IGRyYWcgaWYgcG9pbnRlciBoYXMgbW92ZWQgZmFyIGVub3VnaCB0byBzdGFydCBkcmFnCgogICAgaWYgKCF0aGlzLmlzRHJhZ2dpbmcgJiYgdGhpcy5oYXNEcmFnU3RhcnRlZChtb3ZlVmVjdG9yKSkgewogICAgICB0aGlzLl9kcmFnU3RhcnQoZXZlbnQsIHBvaW50ZXIpOwogICAgfQoKICAgIHJldHVybiBtb3ZlVmVjdG9yOwogIH07IC8vIGNvbmRpdGlvbiBpZiBwb2ludGVyIGhhcyBtb3ZlZCBmYXIgZW5vdWdoIHRvIHN0YXJ0IGRyYWcKCgogIHByb3RvLmhhc0RyYWdTdGFydGVkID0gZnVuY3Rpb24gKG1vdmVWZWN0b3IpIHsKICAgIHJldHVybiBNYXRoLmFicyhtb3ZlVmVjdG9yLngpID4gMyB8fCBNYXRoLmFicyhtb3ZlVmVjdG9yLnkpID4gMzsKICB9OyAvLyAtLS0tLSBlbmQgZXZlbnQgLS0tLS0gLy8KCiAgLyoqCiAgICogcG9pbnRlciB1cAogICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50CiAgICogQHBhcmFtIHtFdmVudCBvciBUb3VjaH0gcG9pbnRlcgogICAqLwoKCiAgcHJvdG8ucG9pbnRlclVwID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLmVtaXRFdmVudCgncG9pbnRlclVwJywgW2V2ZW50LCBwb2ludGVyXSk7CgogICAgdGhpcy5fZHJhZ1BvaW50ZXJVcChldmVudCwgcG9pbnRlcik7CiAgfTsKCiAgcHJvdG8uX2RyYWdQb2ludGVyVXAgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHsKICAgICAgdGhpcy5fZHJhZ0VuZChldmVudCwgcG9pbnRlcik7CiAgICB9IGVsc2UgewogICAgICAvLyBwb2ludGVyIGRpZG4ndCBtb3ZlIGVub3VnaCBmb3IgZHJhZyB0byBzdGFydAogICAgICB0aGlzLl9zdGF0aWNDbGljayhldmVudCwgcG9pbnRlcik7CiAgICB9CiAgfTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gZHJhZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwogIC8vIGRyYWdTdGFydAoKCiAgcHJvdG8uX2RyYWdTdGFydCA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTsgLy8gcHJldmVudCBjbGlja3MKCiAgICB0aGlzLmlzUHJldmVudGluZ0NsaWNrcyA9IHRydWU7CiAgICB0aGlzLmRyYWdTdGFydChldmVudCwgcG9pbnRlcik7CiAgfTsKCiAgcHJvdG8uZHJhZ1N0YXJ0ID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLmVtaXRFdmVudCgnZHJhZ1N0YXJ0JywgW2V2ZW50LCBwb2ludGVyXSk7CiAgfTsgLy8gZHJhZ01vdmUKCgogIHByb3RvLl9kcmFnTW92ZSA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvcikgewogICAgLy8gZG8gbm90IGRyYWcgaWYgbm90IGRyYWdnaW5nIHlldAogICAgaWYgKCF0aGlzLmlzRHJhZ2dpbmcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuZHJhZ01vdmUoZXZlbnQsIHBvaW50ZXIsIG1vdmVWZWN0b3IpOwogIH07CgogIHByb3RvLmRyYWdNb3ZlID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yKSB7CiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgdGhpcy5lbWl0RXZlbnQoJ2RyYWdNb3ZlJywgW2V2ZW50LCBwb2ludGVyLCBtb3ZlVmVjdG9yXSk7CiAgfTsgLy8gZHJhZ0VuZAoKCiAgcHJvdG8uX2RyYWdFbmQgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIC8vIHNldCBmbGFncwogICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7IC8vIHJlLWVuYWJsZSBjbGlja2luZyBhc3luYwoKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBkZWxldGUgdGhpcy5pc1ByZXZlbnRpbmdDbGlja3M7CiAgICB9LmJpbmQodGhpcykpOwogICAgdGhpcy5kcmFnRW5kKGV2ZW50LCBwb2ludGVyKTsKICB9OwoKICBwcm90by5kcmFnRW5kID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLmVtaXRFdmVudCgnZHJhZ0VuZCcsIFtldmVudCwgcG9pbnRlcl0pOwogIH07IC8vIC0tLS0tIG9uY2xpY2sgLS0tLS0gLy8KICAvLyBoYW5kbGUgYWxsIGNsaWNrcyBhbmQgcHJldmVudCBjbGlja3Mgd2hlbiBkcmFnZ2luZwoKCiAgcHJvdG8ub25jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKHRoaXMuaXNQcmV2ZW50aW5nQ2xpY2tzKSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICB9CiAgfTsgLy8gLS0tLS0gc3RhdGljQ2xpY2sgLS0tLS0gLy8KICAvLyB0cmlnZ2VyZWQgYWZ0ZXIgcG9pbnRlciBkb3duICYgdXAgd2l0aCBuby90aW55IG1vdmVtZW50CgoKICBwcm90by5fc3RhdGljQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIC8vIGlnbm9yZSBlbXVsYXRlZCBtb3VzZSB1cCBjbGlja3MKICAgIGlmICh0aGlzLmlzSWdub3JpbmdNb3VzZVVwICYmIGV2ZW50LnR5cGUgPT0gJ21vdXNldXAnKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRpY0NsaWNrKGV2ZW50LCBwb2ludGVyKTsgLy8gc2V0IGZsYWcgZm9yIGVtdWxhdGVkIGNsaWNrcyAzMDBtcyBhZnRlciB0b3VjaGVuZAoKICAgIGlmIChldmVudC50eXBlICE9ICdtb3VzZXVwJykgewogICAgICB0aGlzLmlzSWdub3JpbmdNb3VzZVVwID0gdHJ1ZTsgLy8gcmVzZXQgZmxhZyBhZnRlciAzMDBtcwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgZGVsZXRlIHRoaXMuaXNJZ25vcmluZ01vdXNlVXA7CiAgICAgIH0uYmluZCh0aGlzKSwgNDAwKTsKICAgIH0KICB9OwoKICBwcm90by5zdGF0aWNDbGljayA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgdGhpcy5lbWl0RXZlbnQoJ3N0YXRpY0NsaWNrJywgW2V2ZW50LCBwb2ludGVyXSk7CiAgfTsgLy8gLS0tLS0gdXRpbHMgLS0tLS0gLy8KCgogIFVuaWRyYWdnZXIuZ2V0UG9pbnRlclBvaW50ID0gVW5pcG9pbnRlci5nZXRQb2ludGVyUG9pbnQ7IC8vIC0tLS0tICAtLS0tLSAvLwoKICByZXR1cm4gVW5pZHJhZ2dlcjsKfSk7CgooZnVuY3Rpb24gKHdpbmRvdywgZmFjdG9yeSkgewogIC8vIHVuaXZlcnNhbCBtb2R1bGUgZGVmaW5pdGlvbgoKICAvKiBqc2hpbnQgc3RyaWN0OiBmYWxzZSAqLwoKICAvKiBnbG9iYWxzIGRlZmluZSAqLwogIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ECiAgICBkZWZpbmUoWydnZXQtc2l6ZS9nZXQtc2l6ZScsICd1bmlkcmFnZ2VyL3VuaWRyYWdnZXInXSwgZnVuY3Rpb24gKGdldFNpemUsIFVuaWRyYWdnZXIpIHsKICAgICAgcmV0dXJuIGZhY3Rvcnkod2luZG93LCBnZXRTaXplLCBVbmlkcmFnZ2VyKTsKICAgIH0pOwogIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgLy8gQ29tbW9uSlMKICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSh3aW5kb3csIHJlcXVpcmUoJ2dldC1zaXplJyksIHJlcXVpcmUoJ3VuaWRyYWdnZXInKSk7CiAgfSBlbHNlIHsKICAgIC8vIGJyb3dzZXIgZ2xvYmFsCiAgICB3aW5kb3cuRHJhZ2dhYmlsbHkgPSBmYWN0b3J5KHdpbmRvdywgd2luZG93LmdldFNpemUsIHdpbmRvdy5VbmlkcmFnZ2VyKTsKICB9Cn0pKHdpbmRvdywgZnVuY3Rpb24gZmFjdG9yeSh3aW5kb3csIGdldFNpemUsIFVuaWRyYWdnZXIpIHsKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBoZWxwZXJzICYgdmFyaWFibGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgLy8gZXh0ZW5kIG9iamVjdHMKICBmdW5jdGlvbiBleHRlbmQoYSwgYikgewogICAgZm9yICh2YXIgcHJvcCBpbiBiKSB7CiAgICAgIGFbcHJvcF0gPSBiW3Byb3BdOwogICAgfQoKICAgIHJldHVybiBhOwogIH0KCiAgZnVuY3Rpb24gbm9vcCgpIHt9CgogIHZhciBqUXVlcnkgPSB3aW5kb3cualF1ZXJ5OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy8KCiAgZnVuY3Rpb24gRHJhZ2dhYmlsbHkoZWxlbWVudCwgb3B0aW9ucykgewogICAgLy8gcXVlcnlTZWxlY3RvciBpZiBzdHJpbmcKICAgIHRoaXMuZWxlbWVudCA9IHR5cGVvZiBlbGVtZW50ID09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KSA6IGVsZW1lbnQ7CgogICAgaWYgKGpRdWVyeSkgewogICAgICB0aGlzLiRlbGVtZW50ID0galF1ZXJ5KHRoaXMuZWxlbWVudCk7CiAgICB9IC8vIG9wdGlvbnMKCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRzKTsKICAgIHRoaXMub3B0aW9uKG9wdGlvbnMpOwoKICAgIHRoaXMuX2NyZWF0ZSgpOwogIH0gLy8gaW5oZXJpdCBVbmlkcmFnZ2VyIG1ldGhvZHMKCgogIHZhciBwcm90byA9IERyYWdnYWJpbGx5LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoVW5pZHJhZ2dlci5wcm90b3R5cGUpOwogIERyYWdnYWJpbGx5LmRlZmF1bHRzID0ge307CiAgLyoqCiAgICogc2V0IG9wdGlvbnMKICAgKiBAcGFyYW0ge09iamVjdH0gb3B0cwogICAqLwoKICBwcm90by5vcHRpb24gPSBmdW5jdGlvbiAob3B0cykgewogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0cyk7CiAgfTsgLy8gY3NzIHBvc2l0aW9uIHZhbHVlcyB0aGF0IGRvbid0IG5lZWQgdG8gYmUgc2V0CgoKICB2YXIgcG9zaXRpb25WYWx1ZXMgPSB7CiAgICByZWxhdGl2ZTogdHJ1ZSwKICAgIGFic29sdXRlOiB0cnVlLAogICAgZml4ZWQ6IHRydWUKICB9OwoKICBwcm90by5fY3JlYXRlID0gZnVuY3Rpb24gKCkgewogICAgLy8gcHJvcGVydGllcwogICAgdGhpcy5wb3NpdGlvbiA9IHt9OwoKICAgIHRoaXMuX2dldFBvc2l0aW9uKCk7CgogICAgdGhpcy5zdGFydFBvaW50ID0gewogICAgICB4OiAwLAogICAgICB5OiAwCiAgICB9OwogICAgdGhpcy5kcmFnUG9pbnQgPSB7CiAgICAgIHg6IDAsCiAgICAgIHk6IDAKICAgIH07CiAgICB0aGlzLnN0YXJ0UG9zaXRpb24gPSBleHRlbmQoe30sIHRoaXMucG9zaXRpb24pOyAvLyBzZXQgcmVsYXRpdmUgcG9zaXRpb25pbmcKCiAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCk7CgogICAgaWYgKCFwb3NpdGlvblZhbHVlc1tzdHlsZS5wb3NpdGlvbl0pIHsKICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsKICAgIH0gLy8gZXZlbnRzLCBicmlkZ2UgalF1ZXJ5IGV2ZW50cyBmcm9tIHZhbmlsbGEKCgogICAgdGhpcy5vbigncG9pbnRlck1vdmUnLCB0aGlzLm9uUG9pbnRlck1vdmUpOwogICAgdGhpcy5vbigncG9pbnRlclVwJywgdGhpcy5vblBvaW50ZXJVcCk7CiAgICB0aGlzLmVuYWJsZSgpOwogICAgdGhpcy5zZXRIYW5kbGVzKCk7CiAgfTsKICAvKioKICAgKiBzZXQgdGhpcy5oYW5kbGVzIGFuZCBiaW5kIHN0YXJ0IGV2ZW50cyB0byAnZW0KICAgKi8KCgogIHByb3RvLnNldEhhbmRsZXMgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmhhbmRsZXMgPSB0aGlzLm9wdGlvbnMuaGFuZGxlID8gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5vcHRpb25zLmhhbmRsZSkgOiBbdGhpcy5lbGVtZW50XTsKICAgIHRoaXMuYmluZEhhbmRsZXMoKTsKICB9OwogIC8qKgogICAqIGVtaXRzIGV2ZW50cyB2aWEgRXZFbWl0dGVyIGFuZCBqUXVlcnkgZXZlbnRzCiAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBuYW1lIG9mIGV2ZW50CiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBvcmlnaW5hbCBldmVudAogICAqIEBwYXJhbSB7QXJyYXl9IGFyZ3MgLSBleHRyYSBhcmd1bWVudHMKICAgKi8KCgogIHByb3RvLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAodHlwZSwgZXZlbnQsIGFyZ3MpIHsKICAgIHZhciBlbWl0QXJncyA9IFtldmVudF0uY29uY2F0KGFyZ3MpOwogICAgdGhpcy5lbWl0RXZlbnQodHlwZSwgZW1pdEFyZ3MpOwogICAgdGhpcy5kaXNwYXRjaEpRdWVyeUV2ZW50KHR5cGUsIGV2ZW50LCBhcmdzKTsKICB9OwoKICBwcm90by5kaXNwYXRjaEpRdWVyeUV2ZW50ID0gZnVuY3Rpb24gKHR5cGUsIGV2ZW50LCBhcmdzKSB7CiAgICB2YXIganF1ZXJ5ID0gd2luZG93LmpRdWVyeTsgLy8gdHJpZ2dlciBqUXVlcnkgZXZlbnQKCiAgICBpZiAoIWpxdWVyeSB8fCAhdGhpcy4kZWxlbWVudCkgewogICAgICByZXR1cm47CiAgICB9IC8vIGNyZWF0ZSBqUXVlcnkgZXZlbnQKCiAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbmV3LWNhcCAqLwoKCiAgICB2YXIgJGV2ZW50ID0ganF1ZXJ5LkV2ZW50KGV2ZW50KTsKICAgICRldmVudC50eXBlID0gdHlwZTsKICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcigkZXZlbnQsIGFyZ3MpOwogIH07IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBvc2l0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCiAgLy8gZ2V0IHgveSBwb3NpdGlvbiBmcm9tIHN0eWxlCgoKICBwcm90by5fZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCk7CgogICAgdmFyIHggPSB0aGlzLl9nZXRQb3NpdGlvbkNvb3JkKHN0eWxlLmxlZnQsICd3aWR0aCcpOwoKICAgIHZhciB5ID0gdGhpcy5fZ2V0UG9zaXRpb25Db29yZChzdHlsZS50b3AsICdoZWlnaHQnKTsgLy8gY2xlYW4gdXAgJ2F1dG8nIG9yIG90aGVyIG5vbi1pbnRlZ2VyIHZhbHVlcwoKCiAgICB0aGlzLnBvc2l0aW9uLnggPSBpc05hTih4KSA/IDAgOiB4OwogICAgdGhpcy5wb3NpdGlvbi55ID0gaXNOYU4oeSkgPyAwIDogeTsKCiAgICB0aGlzLl9hZGRUcmFuc2Zvcm1Qb3NpdGlvbihzdHlsZSk7CiAgfTsKCiAgcHJvdG8uX2dldFBvc2l0aW9uQ29vcmQgPSBmdW5jdGlvbiAoc3R5bGVTaWRlLCBtZWFzdXJlKSB7CiAgICBpZiAoc3R5bGVTaWRlLmluZGV4T2YoJyUnKSAhPSAtMSkgewogICAgICAvLyBjb252ZXJ0IHBlcmNlbnQgaW50byBwaXhlbCBmb3IgU2FmYXJpLCAjNzUKICAgICAgdmFyIHBhcmVudFNpemUgPSBnZXRTaXplKHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKTsgLy8gcHJldmVudCBub3QtaW4tRE9NIGVsZW1lbnQgdGhyb3dpbmcgYnVnLCAjMTMxCgogICAgICByZXR1cm4gIXBhcmVudFNpemUgPyAwIDogcGFyc2VGbG9hdChzdHlsZVNpZGUpIC8gMTAwICogcGFyZW50U2l6ZVttZWFzdXJlXTsKICAgIH0KCiAgICByZXR1cm4gcGFyc2VJbnQoc3R5bGVTaWRlLCAxMCk7CiAgfTsgLy8gYWRkIHRyYW5zZm9ybTogdHJhbnNsYXRlKCB4LCB5ICkgdG8gcG9zaXRpb24KCgogIHByb3RvLl9hZGRUcmFuc2Zvcm1Qb3NpdGlvbiA9IGZ1bmN0aW9uIChzdHlsZSkgewogICAgdmFyIHRyYW5zZm9ybSA9IHN0eWxlLnRyYW5zZm9ybTsgLy8gYmFpbCBvdXQgaWYgdmFsdWUgaXMgJ25vbmUnCgogICAgaWYgKHRyYW5zZm9ybS5pbmRleE9mKCdtYXRyaXgnKSAhPT0gMCkgewogICAgICByZXR1cm47CiAgICB9IC8vIHNwbGl0IG1hdHJpeCgxLCAwLCAwLCAxLCB4LCB5KQoKCiAgICB2YXIgbWF0cml4VmFsdWVzID0gdHJhbnNmb3JtLnNwbGl0KCcsJyk7IC8vIHRyYW5zbGF0ZSBYIHZhbHVlIGlzIGluIDEydGggb3IgNHRoIHBvc2l0aW9uCgogICAgdmFyIHhJbmRleCA9IHRyYW5zZm9ybS5pbmRleE9mKCdtYXRyaXgzZCcpID09PSAwID8gMTIgOiA0OwogICAgdmFyIHRyYW5zbGF0ZVggPSBwYXJzZUludChtYXRyaXhWYWx1ZXNbeEluZGV4XSwgMTApOyAvLyB0cmFuc2xhdGUgWSB2YWx1ZSBpcyBpbiAxM3RoIG9yIDV0aCBwb3NpdGlvbgoKICAgIHZhciB0cmFuc2xhdGVZID0gcGFyc2VJbnQobWF0cml4VmFsdWVzW3hJbmRleCArIDFdLCAxMCk7CiAgICB0aGlzLnBvc2l0aW9uLnggKz0gdHJhbnNsYXRlWDsKICAgIHRoaXMucG9zaXRpb24ueSArPSB0cmFuc2xhdGVZOwogIH07IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGV2ZW50cyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvLwoKCiAgcHJvdG8ub25Qb2ludGVyRG93biA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lzLXBvaW50ZXItZG93bicpOwogICAgdGhpcy5kaXNwYXRjaEpRdWVyeUV2ZW50KCdwb2ludGVyRG93bicsIGV2ZW50LCBbcG9pbnRlcl0pOwogIH07CgogIHByb3RvLnBvaW50ZXJEb3duID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB2YXIgaXNPa2F5ID0gdGhpcy5va2F5UG9pbnRlckRvd24oZXZlbnQpOwoKICAgIGlmICghaXNPa2F5IHx8ICF0aGlzLmlzRW5hYmxlZCkgewogICAgICB0aGlzLl9wb2ludGVyUmVzZXQoKTsKCiAgICAgIHJldHVybjsKICAgIH0gLy8gdHJhY2sgc3RhcnQgZXZlbnQgcG9zaXRpb24KICAgIC8vIFNhZmFyaSA5IG92ZXJyaWRlcyBwYWdlWCBhbmQgcGFnZVkuIFRoZXNlIHZhbHVlcyBuZWVkcyB0byBiZSBjb3BpZWQuIGZsaWNraXR5Izg0MgoKCiAgICB0aGlzLnBvaW50ZXJEb3duUG9pbnRlciA9IHsKICAgICAgcGFnZVg6IHBvaW50ZXIucGFnZVgsCiAgICAgIHBhZ2VZOiBwb2ludGVyLnBhZ2VZCiAgICB9OwogICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgIHRoaXMucG9pbnRlckRvd25CbHVyKCk7IC8vIGJpbmQgbW92ZSBhbmQgZW5kIGV2ZW50cwoKICAgIHRoaXMuX2JpbmRQb3N0U3RhcnRFdmVudHMoZXZlbnQpOwoKICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpcy1wb2ludGVyLWRvd24nKTsKICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgncG9pbnRlckRvd24nLCBldmVudCwgW3BvaW50ZXJdKTsKICB9OwogIC8qKgogICAqIGRyYWcgc3RhcnQKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7W0V2ZW50LCBUb3VjaF19IHBvaW50ZXIKICAgKi8KCgogIHByb3RvLmRyYWdTdGFydCA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlcikgewogICAgaWYgKCF0aGlzLmlzRW5hYmxlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fZ2V0UG9zaXRpb24oKTsKCiAgICB0aGlzLm1lYXN1cmVDb250YWlubWVudCgpOyAvLyBwb3NpdGlvbiBfd2hlbl8gZHJhZyBiZWdhbgoKICAgIHRoaXMuc3RhcnRQb3NpdGlvbi54ID0gdGhpcy5wb3NpdGlvbi54OwogICAgdGhpcy5zdGFydFBvc2l0aW9uLnkgPSB0aGlzLnBvc2l0aW9uLnk7IC8vIHJlc2V0IGxlZnQvdG9wIHN0eWxlCgogICAgdGhpcy5zZXRMZWZ0VG9wKCk7CiAgICB0aGlzLmRyYWdQb2ludC54ID0gMDsKICAgIHRoaXMuZHJhZ1BvaW50LnkgPSAwOwogICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWRyYWdnaW5nJyk7CiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2RyYWdTdGFydCcsIGV2ZW50LCBbcG9pbnRlcl0pOyAvLyBzdGFydCBhbmltYXRpb24KCiAgICB0aGlzLmFuaW1hdGUoKTsKICB9OwoKICBwcm90by5tZWFzdXJlQ29udGFpbm1lbnQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXIoKTsKCiAgICBpZiAoIWNvbnRhaW5lcikgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGVsZW1TaXplID0gZ2V0U2l6ZSh0aGlzLmVsZW1lbnQpOwogICAgdmFyIGNvbnRhaW5lclNpemUgPSBnZXRTaXplKGNvbnRhaW5lcik7CiAgICB2YXIgZWxlbVJlY3QgPSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICB2YXIgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHZhciBib3JkZXJTaXplWCA9IGNvbnRhaW5lclNpemUuYm9yZGVyTGVmdFdpZHRoICsgY29udGFpbmVyU2l6ZS5ib3JkZXJSaWdodFdpZHRoOwogICAgdmFyIGJvcmRlclNpemVZID0gY29udGFpbmVyU2l6ZS5ib3JkZXJUb3BXaWR0aCArIGNvbnRhaW5lclNpemUuYm9yZGVyQm90dG9tV2lkdGg7CiAgICB2YXIgcG9zaXRpb24gPSB0aGlzLnJlbGF0aXZlU3RhcnRQb3NpdGlvbiA9IHsKICAgICAgeDogZWxlbVJlY3QubGVmdCAtIChjb250YWluZXJSZWN0LmxlZnQgKyBjb250YWluZXJTaXplLmJvcmRlckxlZnRXaWR0aCksCiAgICAgIHk6IGVsZW1SZWN0LnRvcCAtIChjb250YWluZXJSZWN0LnRvcCArIGNvbnRhaW5lclNpemUuYm9yZGVyVG9wV2lkdGgpCiAgICB9OwogICAgdGhpcy5jb250YWluU2l6ZSA9IHsKICAgICAgd2lkdGg6IGNvbnRhaW5lclNpemUud2lkdGggLSBib3JkZXJTaXplWCAtIHBvc2l0aW9uLnggLSBlbGVtU2l6ZS53aWR0aCwKICAgICAgaGVpZ2h0OiBjb250YWluZXJTaXplLmhlaWdodCAtIGJvcmRlclNpemVZIC0gcG9zaXRpb24ueSAtIGVsZW1TaXplLmhlaWdodAogICAgfTsKICB9OwoKICBwcm90by5nZXRDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY29udGFpbm1lbnQgPSB0aGlzLm9wdGlvbnMuY29udGFpbm1lbnQ7CgogICAgaWYgKCFjb250YWlubWVudCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGlzRWxlbWVudCA9IGNvbnRhaW5tZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7IC8vIHVzZSBhcyBlbGVtZW50CgogICAgaWYgKGlzRWxlbWVudCkgewogICAgICByZXR1cm4gY29udGFpbm1lbnQ7CiAgICB9IC8vIHF1ZXJ5U2VsZWN0b3IgaWYgc3RyaW5nCgoKICAgIGlmICh0eXBlb2YgY29udGFpbm1lbnQgPT0gJ3N0cmluZycpIHsKICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbm1lbnQpOwogICAgfSAvLyBmYWxsYmFjayB0byBwYXJlbnQgZWxlbWVudAoKCiAgICByZXR1cm4gdGhpcy5lbGVtZW50LnBhcmVudE5vZGU7CiAgfTsgLy8gLS0tLS0gbW92ZSBldmVudCAtLS0tLSAvLwoKCiAgcHJvdG8ub25Qb2ludGVyTW92ZSA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvcikgewogICAgdGhpcy5kaXNwYXRjaEpRdWVyeUV2ZW50KCdwb2ludGVyTW92ZScsIGV2ZW50LCBbcG9pbnRlciwgbW92ZVZlY3Rvcl0pOwogIH07CiAgLyoqCiAgICogZHJhZyBtb3ZlCiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQKICAgKiBAcGFyYW0ge1tFdmVudCwgVG91Y2hdfSBwb2ludGVyCiAgICogQHBhcmFtIHtPYmplY3R9IG1vdmVWZWN0b3IgLSB4IGFuZCB5IGNvb3JkaW5hdGVzCiAgICovCgoKICBwcm90by5kcmFnTW92ZSA9IGZ1bmN0aW9uIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvcikgewogICAgaWYgKCF0aGlzLmlzRW5hYmxlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGRyYWdYID0gbW92ZVZlY3Rvci54OwogICAgdmFyIGRyYWdZID0gbW92ZVZlY3Rvci55OwogICAgdmFyIGdyaWQgPSB0aGlzLm9wdGlvbnMuZ3JpZDsKICAgIHZhciBncmlkWCA9IGdyaWQgJiYgZ3JpZFswXTsKICAgIHZhciBncmlkWSA9IGdyaWQgJiYgZ3JpZFsxXTsKICAgIGRyYWdYID0gYXBwbHlHcmlkKGRyYWdYLCBncmlkWCk7CiAgICBkcmFnWSA9IGFwcGx5R3JpZChkcmFnWSwgZ3JpZFkpOwogICAgZHJhZ1ggPSB0aGlzLmNvbnRhaW5EcmFnKCd4JywgZHJhZ1gsIGdyaWRYKTsKICAgIGRyYWdZID0gdGhpcy5jb250YWluRHJhZygneScsIGRyYWdZLCBncmlkWSk7IC8vIGNvbnN0cmFpbiB0byBheGlzCgogICAgZHJhZ1ggPSB0aGlzLm9wdGlvbnMuYXhpcyA9PSAneScgPyAwIDogZHJhZ1g7CiAgICBkcmFnWSA9IHRoaXMub3B0aW9ucy5heGlzID09ICd4JyA/IDAgOiBkcmFnWTsKICAgIHRoaXMucG9zaXRpb24ueCA9IHRoaXMuc3RhcnRQb3NpdGlvbi54ICsgZHJhZ1g7CiAgICB0aGlzLnBvc2l0aW9uLnkgPSB0aGlzLnN0YXJ0UG9zaXRpb24ueSArIGRyYWdZOyAvLyBzZXQgZHJhZ1BvaW50IHByb3BlcnRpZXMKCiAgICB0aGlzLmRyYWdQb2ludC54ID0gZHJhZ1g7CiAgICB0aGlzLmRyYWdQb2ludC55ID0gZHJhZ1k7CiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2RyYWdNb3ZlJywgZXZlbnQsIFtwb2ludGVyLCBtb3ZlVmVjdG9yXSk7CiAgfTsKCiAgZnVuY3Rpb24gYXBwbHlHcmlkKHZhbHVlLCBncmlkLCBtZXRob2QpIHsKICAgIG1ldGhvZCA9IG1ldGhvZCB8fCAncm91bmQnOwogICAgcmV0dXJuIGdyaWQgPyBNYXRoW21ldGhvZF0odmFsdWUgLyBncmlkKSAqIGdyaWQgOiB2YWx1ZTsKICB9CgogIHByb3RvLmNvbnRhaW5EcmFnID0gZnVuY3Rpb24gKGF4aXMsIGRyYWcsIGdyaWQpIHsKICAgIGlmICghdGhpcy5vcHRpb25zLmNvbnRhaW5tZW50KSB7CiAgICAgIHJldHVybiBkcmFnOwogICAgfQoKICAgIHZhciBtZWFzdXJlID0gYXhpcyA9PSAneCcgPyAnd2lkdGgnIDogJ2hlaWdodCc7CiAgICB2YXIgcmVsID0gdGhpcy5yZWxhdGl2ZVN0YXJ0UG9zaXRpb25bYXhpc107CiAgICB2YXIgbWluID0gYXBwbHlHcmlkKC1yZWwsIGdyaWQsICdjZWlsJyk7CiAgICB2YXIgbWF4ID0gdGhpcy5jb250YWluU2l6ZVttZWFzdXJlXTsKICAgIG1heCA9IGFwcGx5R3JpZChtYXgsIGdyaWQsICdmbG9vcicpOwogICAgcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCBkcmFnKSk7CiAgfTsgLy8gLS0tLS0gZW5kIGV2ZW50IC0tLS0tIC8vCgogIC8qKgogICAqIHBvaW50ZXIgdXAKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7W0V2ZW50LCBUb3VjaF19IHBvaW50ZXIKICAgKi8KCgogIHByb3RvLm9uUG9pbnRlclVwID0gZnVuY3Rpb24gKGV2ZW50LCBwb2ludGVyKSB7CiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaXMtcG9pbnRlci1kb3duJyk7CiAgICB0aGlzLmRpc3BhdGNoSlF1ZXJ5RXZlbnQoJ3BvaW50ZXJVcCcsIGV2ZW50LCBbcG9pbnRlcl0pOwogIH07CiAgLyoqCiAgICogZHJhZyBlbmQKICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudAogICAqIEBwYXJhbSB7W0V2ZW50LCBUb3VjaF19IHBvaW50ZXIKICAgKi8KCgogIHByb3RvLmRyYWdFbmQgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIGlmICghdGhpcy5pc0VuYWJsZWQpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyB1c2UgdG9wIGxlZnQgcG9zaXRpb24gd2hlbiBjb21wbGV0ZQoKCiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJyc7CiAgICB0aGlzLnNldExlZnRUb3AoKTsKICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2luZycpOwogICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdkcmFnRW5kJywgZXZlbnQsIFtwb2ludGVyXSk7CiAgfTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYW5pbWF0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vCgoKICBwcm90by5hbmltYXRlID0gZnVuY3Rpb24gKCkgewogICAgLy8gb25seSByZW5kZXIgYW5kIGFuaW1hdGUgaWYgZHJhZ2dpbmcKICAgIGlmICghdGhpcy5pc0RyYWdnaW5nKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnBvc2l0aW9uRHJhZygpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIGFuaW1hdGVGcmFtZSgpIHsKICAgICAgX3RoaXMuYW5pbWF0ZSgpOwogICAgfSk7CiAgfTsgLy8gbGVmdC90b3AgcG9zaXRpb25pbmcKCgogIHByb3RvLnNldExlZnRUb3AgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IHRoaXMucG9zaXRpb24ueCArICdweCc7CiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi55ICsgJ3B4JzsKICB9OwoKICBwcm90by5wb3NpdGlvbkRyYWcgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKCAnICsgdGhpcy5kcmFnUG9pbnQueCArICdweCwgJyArIHRoaXMuZHJhZ1BvaW50LnkgKyAncHgsIDApJzsKICB9OyAvLyAtLS0tLSBzdGF0aWNDbGljayAtLS0tLSAvLwoKCiAgcHJvdG8uc3RhdGljQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQsIHBvaW50ZXIpIHsKICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnc3RhdGljQ2xpY2snLCBldmVudCwgW3BvaW50ZXJdKTsKICB9OyAvLyAtLS0tLSBtZXRob2RzIC0tLS0tIC8vCgogIC8qKgogICAqIEBwYXJhbSB7TnVtYmVyfSB4CiAgICogQHBhcmFtIHtOdW1iZXJ9IHkKICAgKi8KCgogIHByb3RvLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHgsIHkpIHsKICAgIHRoaXMucG9zaXRpb24ueCA9IHg7CiAgICB0aGlzLnBvc2l0aW9uLnkgPSB5OwogICAgdGhpcy5zZXRMZWZ0VG9wKCk7CiAgfTsKCiAgcHJvdG8uZW5hYmxlID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy5pc0VuYWJsZWQgPSB0cnVlOwogIH07CgogIHByb3RvLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlOwoKICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHsKICAgICAgdGhpcy5kcmFnRW5kKCk7CiAgICB9CiAgfTsKCiAgcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuZGlzYWJsZSgpOyAvLyByZXNldCBzdHlsZXMKCiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJyc7CiAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9ICcnOwogICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9ICcnOwogICAgdGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJyc7IC8vIHVuYmluZCBoYW5kbGVzCgogICAgdGhpcy51bmJpbmRIYW5kbGVzKCk7IC8vIHJlbW92ZSBqUXVlcnkgZGF0YQoKICAgIGlmICh0aGlzLiRlbGVtZW50KSB7CiAgICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlRGF0YSgnZHJhZ2dhYmlsbHknKTsKICAgIH0KICB9OyAvLyAtLS0tLSBqUXVlcnkgYnJpZGdldCAtLS0tLSAvLwogIC8vIHJlcXVpcmVkIGZvciBqUXVlcnkgYnJpZGdldAoKCiAgcHJvdG8uX2luaXQgPSBub29wOwoKICBpZiAoalF1ZXJ5ICYmIGpRdWVyeS5icmlkZ2V0KSB7CiAgICBqUXVlcnkuYnJpZGdldCgnZHJhZ2dhYmlsbHknLCBEcmFnZ2FiaWxseSk7CiAgfSAvLyAtLS0tLSAgLS0tLS0gLy8KCgogIHJldHVybiBEcmFnZ2FiaWxseTsKfSk7"},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/assets/scripts/draggabilly.js"],"names":["window","factory","define","amd","jQuery","module","exports","require","jQueryBridget","arraySlice","Array","prototype","slice","console","logError","message","error","namespace","PluginClass","$","option","opts","isPlainObject","options","extend","fn","arg0","args","call","arguments","methodCall","plainCall","$elems","methodName","returnValue","pluginMethodStr","each","i","elem","instance","data","method","charAt","value","apply","undefined","_init","updateJQuery","bridget","getSize","getStyleSize","num","parseFloat","isValid","indexOf","isNaN","noop","measurements","measurementsLength","length","getZeroSize","size","width","height","innerWidth","innerHeight","outerWidth","outerHeight","measurement","getStyle","style","getComputedStyle","isSetup","isBoxSizeOuter","setup","div","document","createElement","padding","borderStyle","borderWidth","boxSizing","body","documentElement","appendChild","removeChild","querySelector","nodeType","display","offsetWidth","offsetHeight","isBorderBox","paddingWidth","paddingLeft","paddingRight","paddingHeight","paddingTop","paddingBottom","marginWidth","marginLeft","marginRight","marginHeight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderHeight","borderTopWidth","borderBottomWidth","isBorderBoxSizeOuter","styleWidth","styleHeight","global","EvEmitter","proto","on","eventName","listener","events","_events","listeners","push","once","onceEvents","_onceEvents","onceListeners","off","index","splice","emitEvent","isOnce","allOff","Unipointer","Object","create","bindStartEvent","_bindStartEvent","unbindStartEvent","isAdd","bindMethod","startEvent","PointerEvent","handleEvent","event","type","getTouch","touches","touch","identifier","pointerIdentifier","onmousedown","button","_pointerDown","ontouchstart","changedTouches","onpointerdown","pointer","isPointerDown","pointerId","pointerDown","_bindPostStartEvents","postStartEvents","mousedown","touchstart","pointerdown","forEach","addEventListener","_boundPointerEvents","_unbindPostStartEvents","removeEventListener","onmousemove","_pointerMove","onpointermove","ontouchmove","pointerMove","onmouseup","_pointerUp","onpointerup","ontouchend","_pointerDone","pointerUp","_pointerReset","pointerDone","onpointercancel","_pointerCancel","ontouchcancel","pointerCancel","getPointerPoint","x","pageX","y","pageY","Unidragger","bindHandles","_bindHandles","unbindHandles","touchAction","_touchActionValue","handles","handle","isOkay","okayPointerDown","pointerDownPointer","preventDefault","pointerDownBlur","cursorNodes","TEXTAREA","INPUT","SELECT","OPTION","clickTypes","radio","checkbox","submit","image","file","isCursorNode","target","nodeName","isClickType","focused","activeElement","canBlur","blur","moveVector","_dragPointerMove","_dragMove","isDragging","hasDragStarted","_dragStart","Math","abs","_dragPointerUp","_dragEnd","_staticClick","isPreventingClicks","dragStart","dragMove","setTimeout","bind","dragEnd","onclick","isIgnoringMouseUp","staticClick","Draggabilly","a","b","prop","element","$element","constructor","defaults","_create","positionValues","relative","absolute","fixed","position","_getPosition","startPoint","dragPoint","startPosition","onPointerMove","onPointerUp","enable","setHandles","querySelectorAll","dispatchEvent","emitArgs","concat","dispatchJQueryEvent","jquery","$event","Event","trigger","_getPositionCoord","left","top","_addTransformPosition","styleSide","measure","parentSize","parentNode","parseInt","transform","matrixValues","split","xIndex","translateX","translateY","onPointerDown","classList","add","isEnabled","measureContainment","setLeftTop","animate","container","getContainer","elemSize","containerSize","elemRect","getBoundingClientRect","containerRect","borderSizeX","borderSizeY","relativeStartPosition","containSize","containment","isElement","HTMLElement","dragX","dragY","grid","gridX","gridY","applyGrid","containDrag","axis","drag","rel","min","max","remove","positionDrag","_this","requestAnimationFrame","animateFrame","setPosition","disable","destroy","removeData"],"mappings":"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","sourcesContent":["\"use strict\";\n/*!\n * Draggabilly PACKAGED v2.3.0\n * Make that shiz draggable\n * https://draggabilly.desandro.com\n * MIT license\n */\n/**\n * Bridget makes jQuery widgets\n * v2.0.1\n * MIT license\n */\n/* jshint browser: true, strict: true, undef: true, unused: true */\n;\n(function (window, factory) {\n    // universal module definition\n    /*jshint strict: false */ /* globals define, module, require */\n    if (typeof define == 'function' && define.amd) {\n        // AMD\n        define('jquery-bridget/jquery-bridget', ['jquery'], function (jQuery) {\n            return factory(window, jQuery);\n        });\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS\n        module.exports = factory(window, require('jquery'));\n    }\n    else {\n        // browser global\n        window.jQueryBridget = factory(window, window.jQuery);\n    }\n})(window, function factory(window, jQuery) {\n    'use strict';\n    // ----- utils ----- //\n    var arraySlice = Array.prototype.slice;\n    // helper function for logging errors\n    // $.error breaks jQuery chaining\n    var console = window.console;\n    var logError = typeof console == 'undefined'\n        ? function () { }\n        : function (message) {\n            console.error(message);\n        };\n    // ----- jQueryBridget ----- //\n    function jQueryBridget(namespace, PluginClass, $) {\n        $ = $ || jQuery || window.jQuery;\n        if (!$) {\n            return;\n        }\n        // add option method -> $().plugin('option', {...})\n        if (!PluginClass.prototype.option) {\n            // option setter\n            PluginClass.prototype.option = function (opts) {\n                // bail out if not an object\n                if (!$.isPlainObject(opts)) {\n                    return;\n                }\n                this.options = $.extend(true, this.options, opts);\n            };\n        }\n        // make jQuery plugin\n        $.fn[namespace] = function (arg0 /*, arg1 */) {\n            if (typeof arg0 == 'string') {\n                // method call $().plugin( 'methodName', { options } )\n                // shift arguments by 1\n                var args = arraySlice.call(arguments, 1);\n                return methodCall(this, arg0, args);\n            }\n            // just $().plugin({ options })\n            plainCall(this, arg0);\n            return this;\n        };\n        // $().plugin('methodName')\n        function methodCall($elems, methodName, args) {\n            var returnValue;\n            var pluginMethodStr = '$().' + namespace + '(\"' + methodName + '\")';\n            $elems.each(function (i, elem) {\n                // get instance\n                var instance = $.data(elem, namespace);\n                if (!instance) {\n                    logError(namespace + ' not initialized. Cannot call methods, i.e. ' + pluginMethodStr);\n                    return;\n                }\n                var method = instance[methodName];\n                if (!method || methodName.charAt(0) == '_') {\n                    logError(pluginMethodStr + ' is not a valid method');\n                    return;\n                }\n                // apply method, get return value\n                var value = method.apply(instance, args);\n                // set return value if value is returned, use only first value\n                returnValue = returnValue === undefined ? value : returnValue;\n            });\n            return returnValue !== undefined ? returnValue : $elems;\n        }\n        function plainCall($elems, options) {\n            $elems.each(function (i, elem) {\n                var instance = $.data(elem, namespace);\n                if (instance) {\n                    // set options & init\n                    instance.option(options);\n                    instance._init();\n                }\n                else {\n                    // initialize new instance\n                    instance = new PluginClass(elem, options);\n                    $.data(elem, namespace, instance);\n                }\n            });\n        }\n        updateJQuery($);\n    }\n    // ----- updateJQuery ----- //\n    // set $.bridget for v1 backwards compatibility\n    function updateJQuery($) {\n        if (!$ || ($ && $.bridget)) {\n            return;\n        }\n        $.bridget = jQueryBridget;\n    }\n    updateJQuery(jQuery || window.jQuery);\n    // -----  ----- //\n    return jQueryBridget;\n});\n(function (window, factory) {\n    'use strict';\n    if (typeof define == 'function' && define.amd) {\n        // AMD\n        define('get-size/get-size', [], function () {\n            return factory();\n        });\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS\n        module.exports = factory();\n    }\n    else {\n        // browser global\n        window.getSize = factory();\n    }\n})(window, function factory() {\n    'use strict';\n    // -------------------------- helpers -------------------------- //\n    // get a number from a string, not a percentage\n    function getStyleSize(value) {\n        var num = parseFloat(value);\n        // not a percent like '100%', and a number\n        var isValid = value.indexOf('%') == -1 && !isNaN(num);\n        return isValid && num;\n    }\n    function noop() { }\n    var logError = typeof console == 'undefined'\n        ? noop\n        : function (message) {\n            console.error(message);\n        };\n    // -------------------------- measurements -------------------------- //\n    var measurements = [\n        'paddingLeft',\n        'paddingRight',\n        'paddingTop',\n        'paddingBottom',\n        'marginLeft',\n        'marginRight',\n        'marginTop',\n        'marginBottom',\n        'borderLeftWidth',\n        'borderRightWidth',\n        'borderTopWidth',\n        'borderBottomWidth',\n    ];\n    var measurementsLength = measurements.length;\n    function getZeroSize() {\n        var size = {\n            width: 0,\n            height: 0,\n            innerWidth: 0,\n            innerHeight: 0,\n            outerWidth: 0,\n            outerHeight: 0,\n        };\n        for (var i = 0; i < measurementsLength; i++) {\n            var measurement = measurements[i];\n            size[measurement] = 0;\n        }\n        return size;\n    }\n    // -------------------------- getStyle -------------------------- //\n    /**\n     * getStyle, get style of element, check for Firefox bug\n     * https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n     */\n    function getStyle(elem) {\n        var style = getComputedStyle(elem);\n        if (!style) {\n            logError('Style returned ' +\n                style +\n                '. Are you running this code in a hidden iframe on Firefox? ' +\n                'See http://bit.ly/getsizebug1');\n        }\n        return style;\n    }\n    // -------------------------- setup -------------------------- //\n    var isSetup = false;\n    var isBoxSizeOuter;\n    /**\n     * setup\n     * check isBoxSizerOuter\n     * do on first getSize() rather than on page load for Firefox bug\n     */\n    function setup() {\n        // setup once\n        if (isSetup) {\n            return;\n        }\n        isSetup = true;\n        // -------------------------- box sizing -------------------------- //\n        /**\n         * WebKit measures the outer-width on style.width on border-box elems\n         * IE & Firefox<29 measures the inner-width\n         */\n        var div = document.createElement('div');\n        div.style.width = '200px';\n        div.style.padding = '1px 2px 3px 4px';\n        div.style.borderStyle = 'solid';\n        div.style.borderWidth = '1px 2px 3px 4px';\n        div.style.boxSizing = 'border-box';\n        var body = document.body || document.documentElement;\n        body.appendChild(div);\n        var style = getStyle(div);\n        getSize.isBoxSizeOuter = isBoxSizeOuter = getStyleSize(style.width) == 200;\n        body.removeChild(div);\n    }\n    // -------------------------- getSize -------------------------- //\n    function getSize(elem) {\n        setup();\n        // use querySeletor if elem is string\n        if (typeof elem == 'string') {\n            elem = document.querySelector(elem);\n        }\n        // do not proceed on non-objects\n        if (!elem || typeof elem != 'object' || !elem.nodeType) {\n            return;\n        }\n        var style = getStyle(elem);\n        // if hidden, everything is 0\n        if (style.display == 'none') {\n            return getZeroSize();\n        }\n        var size = {};\n        size.width = elem.offsetWidth;\n        size.height = elem.offsetHeight;\n        var isBorderBox = (size.isBorderBox = style.boxSizing == 'border-box');\n        // get all measurements\n        for (var i = 0; i < measurementsLength; i++) {\n            var measurement = measurements[i];\n            var value = style[measurement];\n            var num = parseFloat(value);\n            // any 'auto', 'medium' value will be 0\n            size[measurement] = !isNaN(num) ? num : 0;\n        }\n        var paddingWidth = size.paddingLeft + size.paddingRight;\n        var paddingHeight = size.paddingTop + size.paddingBottom;\n        var marginWidth = size.marginLeft + size.marginRight;\n        var marginHeight = size.marginTop + size.marginBottom;\n        var borderWidth = size.borderLeftWidth + size.borderRightWidth;\n        var borderHeight = size.borderTopWidth + size.borderBottomWidth;\n        var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\n        // overwrite width and height if we can get it from style\n        var styleWidth = getStyleSize(style.width);\n        if (styleWidth !== false) {\n            size.width =\n                styleWidth +\n                    // add padding and border unless it's already including it\n                    (isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth);\n        }\n        var styleHeight = getStyleSize(style.height);\n        if (styleHeight !== false) {\n            size.height =\n                styleHeight +\n                    // add padding and border unless it's already including it\n                    (isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight);\n        }\n        size.innerWidth = size.width - (paddingWidth + borderWidth);\n        size.innerHeight = size.height - (paddingHeight + borderHeight);\n        size.outerWidth = size.width + marginWidth;\n        size.outerHeight = size.height + marginHeight;\n        return size;\n    }\n    return getSize;\n});\n(function (global, factory) {\n    // universal module definition\n    /* jshint strict: false */ /* globals define, module, window */\n    if (typeof define == 'function' && define.amd) {\n        // AMD - RequireJS\n        define('ev-emitter/ev-emitter', factory);\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS - Browserify, Webpack\n        module.exports = factory();\n    }\n    else {\n        // Browser globals\n        global.EvEmitter = factory();\n    }\n})(typeof window != 'undefined' ? window : this, function () {\n    function EvEmitter() { }\n    var proto = EvEmitter.prototype;\n    proto.on = function (eventName, listener) {\n        if (!eventName || !listener) {\n            return;\n        }\n        // set events hash\n        var events = (this._events = this._events || {});\n        // set listeners array\n        var listeners = (events[eventName] = events[eventName] || []);\n        // only add once\n        if (listeners.indexOf(listener) == -1) {\n            listeners.push(listener);\n        }\n        return this;\n    };\n    proto.once = function (eventName, listener) {\n        if (!eventName || !listener) {\n            return;\n        }\n        // add event\n        this.on(eventName, listener);\n        // set once flag\n        // set onceEvents hash\n        var onceEvents = (this._onceEvents = this._onceEvents || {});\n        // set onceListeners object\n        var onceListeners = (onceEvents[eventName] = onceEvents[eventName] || {});\n        // set flag\n        onceListeners[listener] = true;\n        return this;\n    };\n    proto.off = function (eventName, listener) {\n        var listeners = this._events && this._events[eventName];\n        if (!listeners || !listeners.length) {\n            return;\n        }\n        var index = listeners.indexOf(listener);\n        if (index != -1) {\n            listeners.splice(index, 1);\n        }\n        return this;\n    };\n    proto.emitEvent = function (eventName, args) {\n        var listeners = this._events && this._events[eventName];\n        if (!listeners || !listeners.length) {\n            return;\n        }\n        // copy over to avoid interference if .off() in listener\n        listeners = listeners.slice(0);\n        args = args || [];\n        // once stuff\n        var onceListeners = this._onceEvents && this._onceEvents[eventName];\n        for (var i = 0; i < listeners.length; i++) {\n            var listener = listeners[i];\n            var isOnce = onceListeners && onceListeners[listener];\n            if (isOnce) {\n                // remove listener\n                // remove before trigger to prevent recursion\n                this.off(eventName, listener);\n                // unset once flag\n                delete onceListeners[listener];\n            }\n            // trigger listener\n            listener.apply(this, args);\n        }\n        return this;\n    };\n    proto.allOff = function () {\n        delete this._events;\n        delete this._onceEvents;\n    };\n    return EvEmitter;\n});\n(function (window, factory) {\n    // universal module definition\n    /* jshint strict: false */ /*global define, module, require */\n    if (typeof define == 'function' && define.amd) {\n        // AMD\n        define('unipointer/unipointer', ['ev-emitter/ev-emitter'], function (EvEmitter) {\n            return factory(window, EvEmitter);\n        });\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS\n        module.exports = factory(window, require('ev-emitter'));\n    }\n    else {\n        // browser global\n        window.Unipointer = factory(window, window.EvEmitter);\n    }\n})(window, function factory(window, EvEmitter) {\n    function noop() { }\n    function Unipointer() { }\n    // inherit EvEmitter\n    var proto = (Unipointer.prototype = Object.create(EvEmitter.prototype));\n    proto.bindStartEvent = function (elem) {\n        this._bindStartEvent(elem, true);\n    };\n    proto.unbindStartEvent = function (elem) {\n        this._bindStartEvent(elem, false);\n    };\n    /**\n     * Add or remove start event\n     * @param {Boolean} isAdd - remove if falsey\n     */\n    proto._bindStartEvent = function (elem, isAdd) {\n        // munge isAdd, default to true\n        isAdd = isAdd === undefined ? true : isAdd;\n        var bindMethod = isAdd ? 'addEventListener' : 'removeEventListener';\n        // default to mouse events\n        var startEvent = 'mousedown';\n        if (window.PointerEvent) {\n            // Pointer Events\n            startEvent = 'pointerdown';\n        }\n        else if ('ontouchstart' in window) {\n            // Touch Events. iOS Safari\n            startEvent = 'touchstart';\n        }\n        elem[bindMethod](startEvent, this);\n    };\n    // trigger handler methods for events\n    proto.handleEvent = function (event) {\n        var method = 'on' + event.type;\n        if (this[method]) {\n            this[method](event);\n        }\n    };\n    // returns the touch that we're keeping track of\n    proto.getTouch = function (touches) {\n        for (var i = 0; i < touches.length; i++) {\n            var touch = touches[i];\n            if (touch.identifier == this.pointerIdentifier) {\n                return touch;\n            }\n        }\n    };\n    // ----- start event ----- //\n    proto.onmousedown = function (event) {\n        // dismiss clicks from right or middle buttons\n        var button = event.button;\n        if (button && button !== 0 && button !== 1) {\n            return;\n        }\n        this._pointerDown(event, event);\n    };\n    proto.ontouchstart = function (event) {\n        this._pointerDown(event, event.changedTouches[0]);\n    };\n    proto.onpointerdown = function (event) {\n        this._pointerDown(event, event);\n    };\n    /**\n     * pointer start\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     */\n    proto._pointerDown = function (event, pointer) {\n        // dismiss right click and other pointers\n        // button = 0 is okay, 1-4 not\n        if (event.button || this.isPointerDown) {\n            return;\n        }\n        this.isPointerDown = true;\n        // save pointer identifier to match up touch events\n        this.pointerIdentifier =\n            pointer.pointerId !== undefined\n                ? // pointerId for pointer events, touch.indentifier for touch events\n                    pointer.pointerId\n                : pointer.identifier;\n        this.pointerDown(event, pointer);\n    };\n    proto.pointerDown = function (event, pointer) {\n        this._bindPostStartEvents(event);\n        this.emitEvent('pointerDown', [event, pointer]);\n    };\n    // hash of events to be bound after start event\n    var postStartEvents = {\n        mousedown: ['mousemove', 'mouseup'],\n        touchstart: ['touchmove', 'touchend', 'touchcancel'],\n        pointerdown: ['pointermove', 'pointerup', 'pointercancel'],\n    };\n    proto._bindPostStartEvents = function (event) {\n        if (!event) {\n            return;\n        }\n        // get proper events to match start event\n        var events = postStartEvents[event.type];\n        // bind events to node\n        events.forEach(function (eventName) {\n            window.addEventListener(eventName, this);\n        }, this);\n        // save these arguments\n        this._boundPointerEvents = events;\n    };\n    proto._unbindPostStartEvents = function () {\n        // check for _boundEvents, in case dragEnd triggered twice (old IE8 bug)\n        if (!this._boundPointerEvents) {\n            return;\n        }\n        this._boundPointerEvents.forEach(function (eventName) {\n            window.removeEventListener(eventName, this);\n        }, this);\n        delete this._boundPointerEvents;\n    };\n    // ----- move event ----- //\n    proto.onmousemove = function (event) {\n        this._pointerMove(event, event);\n    };\n    proto.onpointermove = function (event) {\n        if (event.pointerId == this.pointerIdentifier) {\n            this._pointerMove(event, event);\n        }\n    };\n    proto.ontouchmove = function (event) {\n        var touch = this.getTouch(event.changedTouches);\n        if (touch) {\n            this._pointerMove(event, touch);\n        }\n    };\n    /**\n     * pointer move\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     * @private\n     */\n    proto._pointerMove = function (event, pointer) {\n        this.pointerMove(event, pointer);\n    };\n    // public\n    proto.pointerMove = function (event, pointer) {\n        this.emitEvent('pointerMove', [event, pointer]);\n    };\n    // ----- end event ----- //\n    proto.onmouseup = function (event) {\n        this._pointerUp(event, event);\n    };\n    proto.onpointerup = function (event) {\n        if (event.pointerId == this.pointerIdentifier) {\n            this._pointerUp(event, event);\n        }\n    };\n    proto.ontouchend = function (event) {\n        var touch = this.getTouch(event.changedTouches);\n        if (touch) {\n            this._pointerUp(event, touch);\n        }\n    };\n    /**\n     * pointer up\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     * @private\n     */\n    proto._pointerUp = function (event, pointer) {\n        this._pointerDone();\n        this.pointerUp(event, pointer);\n    };\n    // public\n    proto.pointerUp = function (event, pointer) {\n        this.emitEvent('pointerUp', [event, pointer]);\n    };\n    // ----- pointer done ----- //\n    // triggered on pointer up & pointer cancel\n    proto._pointerDone = function () {\n        this._pointerReset();\n        this._unbindPostStartEvents();\n        this.pointerDone();\n    };\n    proto._pointerReset = function () {\n        // reset properties\n        this.isPointerDown = false;\n        delete this.pointerIdentifier;\n    };\n    proto.pointerDone = noop;\n    // ----- pointer cancel ----- //\n    proto.onpointercancel = function (event) {\n        if (event.pointerId == this.pointerIdentifier) {\n            this._pointerCancel(event, event);\n        }\n    };\n    proto.ontouchcancel = function (event) {\n        var touch = this.getTouch(event.changedTouches);\n        if (touch) {\n            this._pointerCancel(event, touch);\n        }\n    };\n    /**\n     * pointer cancel\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     * @private\n     */\n    proto._pointerCancel = function (event, pointer) {\n        this._pointerDone();\n        this.pointerCancel(event, pointer);\n    };\n    // public\n    proto.pointerCancel = function (event, pointer) {\n        this.emitEvent('pointerCancel', [event, pointer]);\n    };\n    // -----  ----- //\n    // utility function for getting x/y coords from event\n    Unipointer.getPointerPoint = function (pointer) {\n        return {\n            x: pointer.pageX,\n            y: pointer.pageY,\n        };\n    };\n    // -----  ----- //\n    return Unipointer;\n});\n(function (window, factory) {\n    // universal module definition\n    /*jshint strict: false */ /*globals define, module, require */\n    if (typeof define == 'function' && define.amd) {\n        // AMD\n        define('unidragger/unidragger', ['unipointer/unipointer'], function (Unipointer) {\n            return factory(window, Unipointer);\n        });\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS\n        module.exports = factory(window, require('unipointer'));\n    }\n    else {\n        // browser global\n        window.Unidragger = factory(window, window.Unipointer);\n    }\n})(window, function factory(window, Unipointer) {\n    // -------------------------- Unidragger -------------------------- //\n    function Unidragger() { }\n    // inherit Unipointer & EvEmitter\n    var proto = (Unidragger.prototype = Object.create(Unipointer.prototype));\n    // ----- bind start ----- //\n    proto.bindHandles = function () {\n        this._bindHandles(true);\n    };\n    proto.unbindHandles = function () {\n        this._bindHandles(false);\n    };\n    /**\n     * Add or remove start event\n     * @param {Boolean} isAdd\n     */\n    proto._bindHandles = function (isAdd) {\n        // munge isAdd, default to true\n        isAdd = isAdd === undefined ? true : isAdd;\n        // bind each handle\n        var bindMethod = isAdd ? 'addEventListener' : 'removeEventListener';\n        var touchAction = isAdd ? this._touchActionValue : '';\n        for (var i = 0; i < this.handles.length; i++) {\n            var handle = this.handles[i];\n            this._bindStartEvent(handle, isAdd);\n            handle[bindMethod]('click', this);\n            // touch-action: none to override browser touch gestures. metafizzy/flickity#540\n            if (window.PointerEvent) {\n                handle.style.touchAction = touchAction;\n            }\n        }\n    };\n    // prototype so it can be overwriteable by Flickity\n    proto._touchActionValue = 'none';\n    // ----- start event ----- //\n    /**\n     * pointer start\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     */\n    proto.pointerDown = function (event, pointer) {\n        var isOkay = this.okayPointerDown(event);\n        if (!isOkay) {\n            return;\n        }\n        // track start event position\n        this.pointerDownPointer = pointer;\n        event.preventDefault();\n        this.pointerDownBlur();\n        // bind move and end events\n        this._bindPostStartEvents(event);\n        this.emitEvent('pointerDown', [event, pointer]);\n    };\n    // nodes that have text fields\n    var cursorNodes = {\n        TEXTAREA: true,\n        INPUT: true,\n        SELECT: true,\n        OPTION: true,\n    };\n    // input types that do not have text fields\n    var clickTypes = {\n        radio: true,\n        checkbox: true,\n        button: true,\n        submit: true,\n        image: true,\n        file: true,\n    };\n    // dismiss inputs with text fields. flickity#403, flickity#404\n    proto.okayPointerDown = function (event) {\n        var isCursorNode = cursorNodes[event.target.nodeName];\n        var isClickType = clickTypes[event.target.type];\n        var isOkay = !isCursorNode || isClickType;\n        if (!isOkay) {\n            this._pointerReset();\n        }\n        return isOkay;\n    };\n    // kludge to blur previously focused input\n    proto.pointerDownBlur = function () {\n        var focused = document.activeElement;\n        // do not blur body for IE10, metafizzy/flickity#117\n        var canBlur = focused && focused.blur && focused != document.body;\n        if (canBlur) {\n            focused.blur();\n        }\n    };\n    // ----- move event ----- //\n    /**\n     * drag move\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     */\n    proto.pointerMove = function (event, pointer) {\n        var moveVector = this._dragPointerMove(event, pointer);\n        this.emitEvent('pointerMove', [event, pointer, moveVector]);\n        this._dragMove(event, pointer, moveVector);\n    };\n    // base pointer move logic\n    proto._dragPointerMove = function (event, pointer) {\n        var moveVector = {\n            x: pointer.pageX - this.pointerDownPointer.pageX,\n            y: pointer.pageY - this.pointerDownPointer.pageY,\n        };\n        // start drag if pointer has moved far enough to start drag\n        if (!this.isDragging && this.hasDragStarted(moveVector)) {\n            this._dragStart(event, pointer);\n        }\n        return moveVector;\n    };\n    // condition if pointer has moved far enough to start drag\n    proto.hasDragStarted = function (moveVector) {\n        return Math.abs(moveVector.x) > 3 || Math.abs(moveVector.y) > 3;\n    };\n    // ----- end event ----- //\n    /**\n     * pointer up\n     * @param {Event} event\n     * @param {Event or Touch} pointer\n     */\n    proto.pointerUp = function (event, pointer) {\n        this.emitEvent('pointerUp', [event, pointer]);\n        this._dragPointerUp(event, pointer);\n    };\n    proto._dragPointerUp = function (event, pointer) {\n        if (this.isDragging) {\n            this._dragEnd(event, pointer);\n        }\n        else {\n            // pointer didn't move enough for drag to start\n            this._staticClick(event, pointer);\n        }\n    };\n    // -------------------------- drag -------------------------- //\n    // dragStart\n    proto._dragStart = function (event, pointer) {\n        this.isDragging = true;\n        // prevent clicks\n        this.isPreventingClicks = true;\n        this.dragStart(event, pointer);\n    };\n    proto.dragStart = function (event, pointer) {\n        this.emitEvent('dragStart', [event, pointer]);\n    };\n    // dragMove\n    proto._dragMove = function (event, pointer, moveVector) {\n        // do not drag if not dragging yet\n        if (!this.isDragging) {\n            return;\n        }\n        this.dragMove(event, pointer, moveVector);\n    };\n    proto.dragMove = function (event, pointer, moveVector) {\n        event.preventDefault();\n        this.emitEvent('dragMove', [event, pointer, moveVector]);\n    };\n    // dragEnd\n    proto._dragEnd = function (event, pointer) {\n        // set flags\n        this.isDragging = false;\n        // re-enable clicking async\n        setTimeout(function () {\n            delete this.isPreventingClicks;\n        }.bind(this));\n        this.dragEnd(event, pointer);\n    };\n    proto.dragEnd = function (event, pointer) {\n        this.emitEvent('dragEnd', [event, pointer]);\n    };\n    // ----- onclick ----- //\n    // handle all clicks and prevent clicks when dragging\n    proto.onclick = function (event) {\n        if (this.isPreventingClicks) {\n            event.preventDefault();\n        }\n    };\n    // ----- staticClick ----- //\n    // triggered after pointer down & up with no/tiny movement\n    proto._staticClick = function (event, pointer) {\n        // ignore emulated mouse up clicks\n        if (this.isIgnoringMouseUp && event.type == 'mouseup') {\n            return;\n        }\n        this.staticClick(event, pointer);\n        // set flag for emulated clicks 300ms after touchend\n        if (event.type != 'mouseup') {\n            this.isIgnoringMouseUp = true;\n            // reset flag after 300ms\n            setTimeout(function () {\n                delete this.isIgnoringMouseUp;\n            }.bind(this), 400);\n        }\n    };\n    proto.staticClick = function (event, pointer) {\n        this.emitEvent('staticClick', [event, pointer]);\n    };\n    // ----- utils ----- //\n    Unidragger.getPointerPoint = Unipointer.getPointerPoint;\n    // -----  ----- //\n    return Unidragger;\n});\n(function (window, factory) {\n    // universal module definition\n    /* jshint strict: false */ /* globals define */\n    if (typeof define == 'function' && define.amd) {\n        // AMD\n        define(['get-size/get-size', 'unidragger/unidragger'], function (getSize, Unidragger) {\n            return factory(window, getSize, Unidragger);\n        });\n    }\n    else if (typeof module == 'object' && module.exports) {\n        // CommonJS\n        module.exports = factory(window, require('get-size'), require('unidragger'));\n    }\n    else {\n        // browser global\n        window.Draggabilly = factory(window, window.getSize, window.Unidragger);\n    }\n})(window, function factory(window, getSize, Unidragger) {\n    // -------------------------- helpers & variables -------------------------- //\n    // extend objects\n    function extend(a, b) {\n        for (var prop in b) {\n            a[prop] = b[prop];\n        }\n        return a;\n    }\n    function noop() { }\n    var jQuery = window.jQuery;\n    // --------------------------  -------------------------- //\n    function Draggabilly(element, options) {\n        // querySelector if string\n        this.element = typeof element == 'string' ? document.querySelector(element) : element;\n        if (jQuery) {\n            this.$element = jQuery(this.element);\n        }\n        // options\n        this.options = extend({}, this.constructor.defaults);\n        this.option(options);\n        this._create();\n    }\n    // inherit Unidragger methods\n    var proto = (Draggabilly.prototype = Object.create(Unidragger.prototype));\n    Draggabilly.defaults = {};\n    /**\n     * set options\n     * @param {Object} opts\n     */\n    proto.option = function (opts) {\n        extend(this.options, opts);\n    };\n    // css position values that don't need to be set\n    var positionValues = {\n        relative: true,\n        absolute: true,\n        fixed: true,\n    };\n    proto._create = function () {\n        // properties\n        this.position = {};\n        this._getPosition();\n        this.startPoint = { x: 0, y: 0 };\n        this.dragPoint = { x: 0, y: 0 };\n        this.startPosition = extend({}, this.position);\n        // set relative positioning\n        var style = getComputedStyle(this.element);\n        if (!positionValues[style.position]) {\n            this.element.style.position = 'relative';\n        }\n        // events, bridge jQuery events from vanilla\n        this.on('pointerMove', this.onPointerMove);\n        this.on('pointerUp', this.onPointerUp);\n        this.enable();\n        this.setHandles();\n    };\n    /**\n     * set this.handles and bind start events to 'em\n     */\n    proto.setHandles = function () {\n        this.handles = this.options.handle\n            ? this.element.querySelectorAll(this.options.handle)\n            : [this.element];\n        this.bindHandles();\n    };\n    /**\n     * emits events via EvEmitter and jQuery events\n     * @param {String} type - name of event\n     * @param {Event} event - original event\n     * @param {Array} args - extra arguments\n     */\n    proto.dispatchEvent = function (type, event, args) {\n        var emitArgs = [event].concat(args);\n        this.emitEvent(type, emitArgs);\n        this.dispatchJQueryEvent(type, event, args);\n    };\n    proto.dispatchJQueryEvent = function (type, event, args) {\n        var jquery = window.jQuery;\n        // trigger jQuery event\n        if (!jquery || !this.$element) {\n            return;\n        }\n        // create jQuery event\n        /* eslint-disable-next-line new-cap */\n        var $event = jquery.Event(event);\n        $event.type = type;\n        this.$element.trigger($event, args);\n    };\n    // -------------------------- position -------------------------- //\n    // get x/y position from style\n    proto._getPosition = function () {\n        var style = getComputedStyle(this.element);\n        var x = this._getPositionCoord(style.left, 'width');\n        var y = this._getPositionCoord(style.top, 'height');\n        // clean up 'auto' or other non-integer values\n        this.position.x = isNaN(x) ? 0 : x;\n        this.position.y = isNaN(y) ? 0 : y;\n        this._addTransformPosition(style);\n    };\n    proto._getPositionCoord = function (styleSide, measure) {\n        if (styleSide.indexOf('%') != -1) {\n            // convert percent into pixel for Safari, #75\n            var parentSize = getSize(this.element.parentNode);\n            // prevent not-in-DOM element throwing bug, #131\n            return !parentSize ? 0 : (parseFloat(styleSide) / 100) * parentSize[measure];\n        }\n        return parseInt(styleSide, 10);\n    };\n    // add transform: translate( x, y ) to position\n    proto._addTransformPosition = function (style) {\n        var transform = style.transform;\n        // bail out if value is 'none'\n        if (transform.indexOf('matrix') !== 0) {\n            return;\n        }\n        // split matrix(1, 0, 0, 1, x, y)\n        var matrixValues = transform.split(',');\n        // translate X value is in 12th or 4th position\n        var xIndex = transform.indexOf('matrix3d') === 0 ? 12 : 4;\n        var translateX = parseInt(matrixValues[xIndex], 10);\n        // translate Y value is in 13th or 5th position\n        var translateY = parseInt(matrixValues[xIndex + 1], 10);\n        this.position.x += translateX;\n        this.position.y += translateY;\n    };\n    // -------------------------- events -------------------------- //\n    proto.onPointerDown = function (event, pointer) {\n        this.element.classList.add('is-pointer-down');\n        this.dispatchJQueryEvent('pointerDown', event, [pointer]);\n    };\n    proto.pointerDown = function (event, pointer) {\n        var isOkay = this.okayPointerDown(event);\n        if (!isOkay || !this.isEnabled) {\n            this._pointerReset();\n            return;\n        }\n        // track start event position\n        // Safari 9 overrides pageX and pageY. These values needs to be copied. flickity#842\n        this.pointerDownPointer = {\n            pageX: pointer.pageX,\n            pageY: pointer.pageY,\n        };\n        event.preventDefault();\n        this.pointerDownBlur();\n        // bind move and end events\n        this._bindPostStartEvents(event);\n        this.element.classList.add('is-pointer-down');\n        this.dispatchEvent('pointerDown', event, [pointer]);\n    };\n    /**\n     * drag start\n     * @param {Event} event\n     * @param {[Event, Touch]} pointer\n     */\n    proto.dragStart = function (event, pointer) {\n        if (!this.isEnabled) {\n            return;\n        }\n        this._getPosition();\n        this.measureContainment();\n        // position _when_ drag began\n        this.startPosition.x = this.position.x;\n        this.startPosition.y = this.position.y;\n        // reset left/top style\n        this.setLeftTop();\n        this.dragPoint.x = 0;\n        this.dragPoint.y = 0;\n        this.element.classList.add('is-dragging');\n        this.dispatchEvent('dragStart', event, [pointer]);\n        // start animation\n        this.animate();\n    };\n    proto.measureContainment = function () {\n        var container = this.getContainer();\n        if (!container) {\n            return;\n        }\n        var elemSize = getSize(this.element);\n        var containerSize = getSize(container);\n        var elemRect = this.element.getBoundingClientRect();\n        var containerRect = container.getBoundingClientRect();\n        var borderSizeX = containerSize.borderLeftWidth + containerSize.borderRightWidth;\n        var borderSizeY = containerSize.borderTopWidth + containerSize.borderBottomWidth;\n        var position = (this.relativeStartPosition = {\n            x: elemRect.left - (containerRect.left + containerSize.borderLeftWidth),\n            y: elemRect.top - (containerRect.top + containerSize.borderTopWidth),\n        });\n        this.containSize = {\n            width: containerSize.width - borderSizeX - position.x - elemSize.width,\n            height: containerSize.height - borderSizeY - position.y - elemSize.height,\n        };\n    };\n    proto.getContainer = function () {\n        var containment = this.options.containment;\n        if (!containment) {\n            return;\n        }\n        var isElement = containment instanceof HTMLElement;\n        // use as element\n        if (isElement) {\n            return containment;\n        }\n        // querySelector if string\n        if (typeof containment == 'string') {\n            return document.querySelector(containment);\n        }\n        // fallback to parent element\n        return this.element.parentNode;\n    };\n    // ----- move event ----- //\n    proto.onPointerMove = function (event, pointer, moveVector) {\n        this.dispatchJQueryEvent('pointerMove', event, [pointer, moveVector]);\n    };\n    /**\n     * drag move\n     * @param {Event} event\n     * @param {[Event, Touch]} pointer\n     * @param {Object} moveVector - x and y coordinates\n     */\n    proto.dragMove = function (event, pointer, moveVector) {\n        if (!this.isEnabled) {\n            return;\n        }\n        var dragX = moveVector.x;\n        var dragY = moveVector.y;\n        var grid = this.options.grid;\n        var gridX = grid && grid[0];\n        var gridY = grid && grid[1];\n        dragX = applyGrid(dragX, gridX);\n        dragY = applyGrid(dragY, gridY);\n        dragX = this.containDrag('x', dragX, gridX);\n        dragY = this.containDrag('y', dragY, gridY);\n        // constrain to axis\n        dragX = this.options.axis == 'y' ? 0 : dragX;\n        dragY = this.options.axis == 'x' ? 0 : dragY;\n        this.position.x = this.startPosition.x + dragX;\n        this.position.y = this.startPosition.y + dragY;\n        // set dragPoint properties\n        this.dragPoint.x = dragX;\n        this.dragPoint.y = dragY;\n        this.dispatchEvent('dragMove', event, [pointer, moveVector]);\n    };\n    function applyGrid(value, grid, method) {\n        method = method || 'round';\n        return grid ? Math[method](value / grid) * grid : value;\n    }\n    proto.containDrag = function (axis, drag, grid) {\n        if (!this.options.containment) {\n            return drag;\n        }\n        var measure = axis == 'x' ? 'width' : 'height';\n        var rel = this.relativeStartPosition[axis];\n        var min = applyGrid(-rel, grid, 'ceil');\n        var max = this.containSize[measure];\n        max = applyGrid(max, grid, 'floor');\n        return Math.max(min, Math.min(max, drag));\n    };\n    // ----- end event ----- //\n    /**\n     * pointer up\n     * @param {Event} event\n     * @param {[Event, Touch]} pointer\n     */\n    proto.onPointerUp = function (event, pointer) {\n        this.element.classList.remove('is-pointer-down');\n        this.dispatchJQueryEvent('pointerUp', event, [pointer]);\n    };\n    /**\n     * drag end\n     * @param {Event} event\n     * @param {[Event, Touch]} pointer\n     */\n    proto.dragEnd = function (event, pointer) {\n        if (!this.isEnabled) {\n            return;\n        }\n        // use top left position when complete\n        this.element.style.transform = '';\n        this.setLeftTop();\n        this.element.classList.remove('is-dragging');\n        this.dispatchEvent('dragEnd', event, [pointer]);\n    };\n    // -------------------------- animation -------------------------- //\n    proto.animate = function () {\n        // only render and animate if dragging\n        if (!this.isDragging) {\n            return;\n        }\n        this.positionDrag();\n        var _this = this;\n        requestAnimationFrame(function animateFrame() {\n            _this.animate();\n        });\n    };\n    // left/top positioning\n    proto.setLeftTop = function () {\n        this.element.style.left = this.position.x + 'px';\n        this.element.style.top = this.position.y + 'px';\n    };\n    proto.positionDrag = function () {\n        this.element.style.transform =\n            'translate3d( ' + this.dragPoint.x + 'px, ' + this.dragPoint.y + 'px, 0)';\n    };\n    // ----- staticClick ----- //\n    proto.staticClick = function (event, pointer) {\n        this.dispatchEvent('staticClick', event, [pointer]);\n    };\n    // ----- methods ----- //\n    /**\n     * @param {Number} x\n     * @param {Number} y\n     */\n    proto.setPosition = function (x, y) {\n        this.position.x = x;\n        this.position.y = y;\n        this.setLeftTop();\n    };\n    proto.enable = function () {\n        this.isEnabled = true;\n    };\n    proto.disable = function () {\n        this.isEnabled = false;\n        if (this.isDragging) {\n            this.dragEnd();\n        }\n    };\n    proto.destroy = function () {\n        this.disable();\n        // reset styles\n        this.element.style.transform = '';\n        this.element.style.left = '';\n        this.element.style.top = '';\n        this.element.style.position = '';\n        // unbind handles\n        this.unbindHandles();\n        // remove jQuery data\n        if (this.$element) {\n            this.$element.removeData('draggabilly');\n        }\n    };\n    // ----- jQuery bridget ----- //\n    // required for jQuery bridget\n    proto._init = noop;\n    if (jQuery && jQuery.bridget) {\n        jQuery.bridget('draggabilly', Draggabilly);\n    }\n    // -----  ----- //\n    return Draggabilly;\n});\n"]}]}