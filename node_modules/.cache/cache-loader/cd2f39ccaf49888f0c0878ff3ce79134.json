{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--5-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\utils\\hooks.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\utils\\hooks.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIOWFrOeUqOeahGhvb2tzIOWwgeijhQogKi8KaW1wb3J0IHByb2R1Y2UgZnJvbSAnaW1tZXInOwppbXBvcnQgeyBpc0FycmF5IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZVJlZiwgdXNlRWZmZWN0LCB1c2VSZWR1Y2VyLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgc3Vic2NyaWJlLCBIYW5kbGVyIH0gZnJvbSAiLi9tZXNzYWdlIjsKZXhwb3J0IGZ1bmN0aW9uIHVzZUltbWVyKGluaXRpYWxWYWx1ZSkgewogIHZhciBbdmFsLCB1cGRhdGVWYWx1ZV0gPSB1c2VTdGF0ZShpbml0aWFsVmFsdWUpOwogIHJldHVybiBbdmFsLCB1c2VDYWxsYmFjayh1cGRhdGVyID0+IHsKICAgIHVwZGF0ZVZhbHVlKHByb2R1Y2UodXBkYXRlcikpOwogIH0sIFtdKV07Cn0KZXhwb3J0IGZ1bmN0aW9uIHVzZUltbWVyUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsU3RhdGUsIGluaXRpYWxBY3Rpb24pIHsKICB2YXIgY2FjaGVkUmVkdWNlciA9IHVzZUNhbGxiYWNrKHByb2R1Y2UocmVkdWNlciksIFtyZWR1Y2VyXSk7CiAgcmV0dXJuIHVzZVJlZHVjZXIoY2FjaGVkUmVkdWNlciwgaW5pdGlhbFN0YXRlLCBpbml0aWFsQWN0aW9uKTsKfQpleHBvcnQgZnVuY3Rpb24gdXNlU3Vic2NyaWJlcihrZXksIGhhbmRsZXIpIHsKICB2YXIgZGVwcyA9IGlzQXJyYXkoa2V5KSA/IGtleSA6IFtrZXldOwogIHVzZUVmZmVjdCgoKSA9PiB7CiAgICB2YXIgewogICAgICB1bnN1YnNjcmliZQogICAgfSA9IHN1YnNjcmliZShrZXksIGhhbmRsZXIpOwogICAgcmV0dXJuIHVuc3Vic2NyaWJlOwogIH0sIGRlcHMpOwp9CmV4cG9ydCBmdW5jdGlvbiB1c2VQZXJzaXN0Rm4oZm4pIHsKICB2YXIgcmVmID0gdXNlUmVmKCgpID0+IHsKICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNhbGwgZnVuY3Rpb24gd2hpbGUgcmVuZGVyaW5nLicpOwogIH0pOwogIHJlZi5jdXJyZW50ID0gZm47CiAgdmFyIHBlcnNpc3RGbiA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiByZWYuY3VycmVudCguLi5hcmd1bWVudHMpOwogIH0sIFtyZWZdKTsKICByZXR1cm4gcGVyc2lzdEZuOwp9"},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/utils/hooks.js"],"names":["produce","isArray","useCallback","useRef","useEffect","useReducer","useState","subscribe","Handler","useImmer","initialValue","val","updateValue","updater","useImmerReducer","reducer","initialState","initialAction","cachedReducer","useSubscriber","key","handler","deps","unsubscribe","usePersistFn","fn","ref","Error","current","persistFn"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,OAAP,MAAoB,OAApB;AACA,SAASC,OAAT,QAAwB,QAAxB;AACA,SAASC,WAAT,EAAsBC,MAAtB,EAA8BC,SAA9B,EAAyCC,UAAzC,EAAqDC,QAArD,QAAqE,OAArE;AACA,SAASC,SAAT,EAAoBC,OAApB,QAAmC,WAAnC;AACA,OAAO,SAASC,QAAT,CAAkBC,YAAlB,EAAgC;AACnC,MAAM,CAACC,GAAD,EAAMC,WAAN,IAAqBN,QAAQ,CAACI,YAAD,CAAnC;AACA,SAAO,CACHC,GADG,EAEHT,WAAW,CAAEW,OAAD,IAAa;AACrBD,IAAAA,WAAW,CAACZ,OAAO,CAACa,OAAD,CAAR,CAAX;AACH,GAFU,EAER,EAFQ,CAFR,CAAP;AAMH;AACD,OAAO,SAASC,eAAT,CAAyBC,OAAzB,EAAkCC,YAAlC,EAAgDC,aAAhD,EAA+D;AAClE,MAAMC,aAAa,GAAGhB,WAAW,CAACF,OAAO,CAACe,OAAD,CAAR,EAAmB,CAACA,OAAD,CAAnB,CAAjC;AACA,SAAOV,UAAU,CAACa,aAAD,EAAgBF,YAAhB,EAA8BC,aAA9B,CAAjB;AACH;AACD,OAAO,SAASE,aAAT,CAAuBC,GAAvB,EAA4BC,OAA5B,EAAqC;AACxC,MAAMC,IAAI,GAAGrB,OAAO,CAACmB,GAAD,CAAP,GAAeA,GAAf,GAAqB,CAACA,GAAD,CAAlC;AACAhB,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAM;AAAEmB,MAAAA;AAAF,QAAkBhB,SAAS,CAACa,GAAD,EAAMC,OAAN,CAAjC;AACA,WAAOE,WAAP;AACH,GAHQ,EAGND,IAHM,CAAT;AAIH;AACD,OAAO,SAASE,YAAT,CAAsBC,EAAtB,EAA0B;AAC7B,MAAMC,GAAG,GAAGvB,MAAM,CAAC,MAAM;AACrB,UAAM,IAAIwB,KAAJ,CAAU,uCAAV,CAAN;AACH,GAFiB,CAAlB;AAGAD,EAAAA,GAAG,CAACE,OAAJ,GAAcH,EAAd;AACA,MAAMI,SAAS,GAAG3B,WAAW,CAAE;AAAA,WAAawB,GAAG,CAACE,OAAJ,CAAY,YAAZ,CAAb;AAAA,GAAF,EAAsC,CAACF,GAAD,CAAtC,CAA7B;AACA,SAAOG,SAAP;AACH","sourcesContent":["/**\n * 公用的hooks 封装\n */\nimport produce from 'immer';\nimport { isArray } from 'lodash';\nimport { useCallback, useRef, useEffect, useReducer, useState } from 'react';\nimport { subscribe, Handler } from \"./message\";\nexport function useImmer(initialValue) {\n    const [val, updateValue] = useState(initialValue);\n    return [\n        val,\n        useCallback((updater) => {\n            updateValue(produce(updater));\n        }, []),\n    ];\n}\nexport function useImmerReducer(reducer, initialState, initialAction) {\n    const cachedReducer = useCallback(produce(reducer), [reducer]);\n    return useReducer(cachedReducer, initialState, initialAction);\n}\nexport function useSubscriber(key, handler) {\n    const deps = isArray(key) ? key : [key];\n    useEffect(() => {\n        const { unsubscribe } = subscribe(key, handler);\n        return unsubscribe;\n    }, deps);\n}\nexport function usePersistFn(fn) {\n    const ref = useRef(() => {\n        throw new Error('Cannot call function while rendering.');\n    });\n    ref.current = fn;\n    const persistFn = useCallback(((...args) => ref.current(...args)), [ref]);\n    return persistFn;\n}\n"]}]}