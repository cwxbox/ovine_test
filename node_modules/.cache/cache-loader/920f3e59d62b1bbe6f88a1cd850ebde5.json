{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\route_tabs\\chrome_tabs.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\route_tabs\\chrome_tabs.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:KGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZW50ZXJNb2R1bGUgOiB1bmRlZmluZWQ7CiAgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsKfSkoKTsKCnZhciBfX3NpZ25hdHVyZV9fID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmRlZmF1bHQuc2lnbmF0dXJlIDogZnVuY3Rpb24gKGEpIHsKICByZXR1cm4gYTsKfTsKCmltcG9ydCBEcmFnZ2FiaWxseSBmcm9tICIuLi8uLi9hc3NldHMvc2NyaXB0cy9kcmFnZ2FiaWxseSI7CmltcG9ydCB7IG1lc3NhZ2UgfSBmcm9tICIuLi8uLi9jb25zdGFudHMiOwppbXBvcnQgeyBwdWJsaXNoIH0gZnJvbSAiLi4vLi4vdXRpbHMvbWVzc2FnZSI7CnZhciBUQUJfQ09OVEVOVF9NQVJHSU4gPSA5Owp2YXIgVEFCX0NPTlRFTlRfT1ZFUkxBUF9ESVNUQU5DRSA9IDE7IC8vIGNvbnN0IFRBQl9PVkVSTEFQX0RJU1RBTkNFID0gVEFCX0NPTlRFTlRfTUFSR0lOICogMiArIFRBQl9DT05URU5UX09WRVJMQVBfRElTVEFOQ0UKCnZhciBUQUJfQ09OVEVOVF9NSU5fV0lEVEggPSAyNDsKdmFyIFRBQl9DT05URU5UX01BWF9XSURUSCA9IDI0MDsKdmFyIFRBQl9TSVpFX1NNQUxMID0gODQ7CnZhciBUQUJfU0laRV9TTUFMTEVSID0gNjA7CnZhciBUQUJfU0laRV9NSU5JID0gNDg7Cgp2YXIgbm9vcCA9IF8gPT4ge307Cgp2YXIgY2xvc2VzdCA9ICh2YWx1ZSwgYXJyYXkpID0+IHsKICB2YXIgdGVtcCA9IEluZmluaXR5OwogIHZhciBjbG9zZXN0SW5kZXggPSAtMTsKICBhcnJheS5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICBpZiAoTWF0aC5hYnModmFsdWUgLSB2KSA8IHRlbXApIHsKICAgICAgdGVtcCA9IE1hdGguYWJzKHZhbHVlIC0gdik7CiAgICAgIGNsb3Nlc3RJbmRleCA9IGk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGNsb3Nlc3RJbmRleDsKfTsKCnZhciB0YWJUZW1wbGF0ZSA9ICJcbiAgPGRpdiBjbGFzcz1cImNocm9tZS10YWJcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY2hyb21lLXRhYi1kaXZpZGVyc1wiPjwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJjaHJvbWUtdGFiLWJhY2tncm91bmRcIj5cbiAgICAgIDxzdmcgdmVyc2lvbj1cIjEuMVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48ZGVmcz48c3ltYm9sIGlkPVwiY2hyb21lLXRhYi1nZW9tZXRyeS1sZWZ0XCIgdmlld0JveD1cIjAgMCAyMTQgMzZcIj48cGF0aCBkPVwiTTE3IDBoMTk3djM2SDB2LTJjNC41IDAgOS0zLjUgOS04VjhjMC00LjUgMy41LTggOC04elwiLz48L3N5bWJvbD48c3ltYm9sIGlkPVwiY2hyb21lLXRhYi1nZW9tZXRyeS1yaWdodFwiIHZpZXdCb3g9XCIwIDAgMjE0IDM2XCI+PHVzZSB4bGluazpocmVmPVwiI2Nocm9tZS10YWItZ2VvbWV0cnktbGVmdFwiLz48L3N5bWJvbD48Y2xpcFBhdGggaWQ9XCJjcm9wXCI+PHJlY3QgY2xhc3M9XCJtYXNrXCIgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiIHg9XCIwXCIvPjwvY2xpcFBhdGg+PC9kZWZzPjxzdmcgd2lkdGg9XCI1MiVcIiBoZWlnaHQ9XCIxMDAlXCI+PHVzZSB4bGluazpocmVmPVwiI2Nocm9tZS10YWItZ2VvbWV0cnktbGVmdFwiIHdpZHRoPVwiMjE0XCIgaGVpZ2h0PVwiMzZcIiBjbGFzcz1cImNocm9tZS10YWItZ2VvbWV0cnlcIi8+PC9zdmc+PGcgdHJhbnNmb3JtPVwic2NhbGUoLTEsIDEpXCI+PHN2ZyB3aWR0aD1cIjUyJVwiIGhlaWdodD1cIjEwMCVcIiB4PVwiLTEwMCVcIiB5PVwiMFwiPjx1c2UgeGxpbms6aHJlZj1cIiNjaHJvbWUtdGFiLWdlb21ldHJ5LXJpZ2h0XCIgd2lkdGg9XCIyMTRcIiBoZWlnaHQ9XCIzNlwiIGNsYXNzPVwiY2hyb21lLXRhYi1nZW9tZXRyeVwiLz48L3N2Zz48L2c+PC9zdmc+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImNocm9tZS10YWItY29udGVudFwiPlxuICAgICAgPGRpdiBjbGFzcz1cImNocm9tZS10YWItZmF2aWNvblwiPjwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImNocm9tZS10YWItdGl0bGVcIj48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjaHJvbWUtdGFiLWRyYWctaGFuZGxlXCI+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY2hyb21lLXRhYi1jbG9zZVwiPlxuICAgICAgPHN2Z1xuICAgICAgICB2aWV3Qm94PVwiMCAwIDEwMjQgMTAyNFwiXG4gICAgICAgIHZlcnNpb249XCIxLjFcIlxuICAgICAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgICAgICAgcC1pZD1cIjIzNTJcIlxuICAgICAgICB4bWxuc1hsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiXG4gICAgICAgIHdpZHRoPVwiMjAwXCJcbiAgICAgICAgaGVpZ2h0PVwiMjAwXCJcbiAgICAgID5cbiAgICAgICAgPHBhdGhcbiAgICAgICAgICBkPVwiTTUxOC41ODE1ODc3IDQ2OS40Mjg3OTE1NkwyNDAuMDI1NzY2MDkgMTkwLjg3MzY0ODg5YTM0Ljc2MTQyODgyIDM0Ljc2MTQyODgyIDAgMSAwLTQ5LjE3NTIwMDk3IDQ5LjEyOTcxMjM4bDI3OC41NTQ0NjM3NCAyNzguNTc4MjI2NDNMMTkwLjg1MDU2NTA4IDc5Ny4xNTkxMzUyMmEzNC43NjE0Mjg4MiAzNC43NjE0Mjg4MiAwIDEgMCA0OS4xNTI3OTYxOSA0OS4xNTIxMTcyNWwyNzguNTc4MjI2NTEtMjc4LjU1NDQ2Mzc4IDI3OC41NzgyMjYzNCAyNzguNTU0NDYzNzhhMzQuNzYxNDI4ODIgMzQuNzYxNDI4ODIgMCAxIDAgNDkuMTUyMTE3MjgtNDkuMTI5MDMzNDVsLTI3OC41NTQ0NjM3NC0yNzguNjAwNjMxMjQgMjc4LjU1NDQ2Mzc0LTI3OC41NTUxNDI3MWEzNC43NjE0Mjg4MiAzNC43NjE0Mjg4MiAwIDEgMC00OS4xNTIxMTcyOC00OS4xNTI3OTYyMkw1MTguNjA0NjcxNDUgNDY5LjQyODc5MTU2elwiXG4gICAgICAgICAgcC1pZD1cIjIzNTNcIlxuICAgICAgICAvPlxuICAgICAgPC9zdmc+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4iOwp2YXIgZGVmYXVsdFRhcFByb3BlcnRpZXMgPSB7CiAgdGl0bGU6ICdOZXcgdGFiJywKICBmYXZpY29uOiBmYWxzZQp9Owp2YXIgaW5zdGFuY2VJZCA9IDA7CgpjbGFzcyBDaHJvbWVUYWJzIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMuZHJhZ2dhYmlsbGllcyA9IFtdOwogIH0KCiAgaW5pdChlbCkgewogICAgdGhpcy5lbCA9IGVsOwogICAgdGhpcy5pbnN0YW5jZUlkID0gaW5zdGFuY2VJZDsKICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdkYXRhLWNocm9tZS10YWJzLWluc3RhbmNlLWlkJywgdGhpcy5pbnN0YW5jZUlkKTsKICAgIGluc3RhbmNlSWQgKz0gMTsKICAgIHRoaXMuc2V0dXBTdHlsZUVsKCk7CiAgICB0aGlzLnNldHVwRXZlbnRzKCk7CiAgICB0aGlzLmxheW91dFRhYnMoKTsKICAgIHRoaXMuc2V0dXBEcmFnZ2FiaWxseSgpOwogIH0KCiAgZW1pdChldmVudE5hbWUsIGRhdGEpIHsKICAgIHRoaXMuZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoZXZlbnROYW1lLCB7CiAgICAgIGRldGFpbDogZGF0YQogICAgfSkpOwogIH0KCiAgc2V0dXBTdHlsZUVsKCkgewogICAgdGhpcy5zdHlsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5zdHlsZUVsKTsKICB9CgogIHNldHVwRXZlbnRzKCkgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIF8gPT4gewogICAgICB0aGlzLmNsZWFuVXBQcmV2aW91c2x5RHJhZ2dlZFRhYnMoKTsKICAgICAgdGhpcy5sYXlvdXRUYWJzKCk7CiAgICB9KTsKICAgIHRoaXMudGFiRWxzLmZvckVhY2godGFiRWwgPT4gdGhpcy5zZXRUYWJDbG9zZUV2ZW50TGlzdGVuZXIodGFiRWwpKTsKICB9CgogIGdldCB0YWJFbHMoKSB7CiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuY2hyb21lLXRhYicpKTsKICB9CgogIGdldCB0YWJDb250ZW50RWwoKSB7CiAgICByZXR1cm4gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuY2hyb21lLXRhYnMtY29udGVudCcpOwogIH0KCiAgZ2V0IHRhYkNvbnRlbnRXaWR0aHMoKSB7CiAgICB2YXIgbnVtYmVyT2ZUYWJzID0gdGhpcy50YWJFbHMubGVuZ3RoOwogICAgdmFyIHRhYnNDb250ZW50V2lkdGggPSB0aGlzLnRhYkNvbnRlbnRFbC5jbGllbnRXaWR0aDsKICAgIHZhciB0YWJzQ3VtdWxhdGl2ZU92ZXJsYXBwZWRXaWR0aCA9IChudW1iZXJPZlRhYnMgLSAxKSAqIFRBQl9DT05URU5UX09WRVJMQVBfRElTVEFOQ0U7CiAgICB2YXIgdGFyZ2V0V2lkdGggPSAodGFic0NvbnRlbnRXaWR0aCAtIDIgKiBUQUJfQ09OVEVOVF9NQVJHSU4gKyB0YWJzQ3VtdWxhdGl2ZU92ZXJsYXBwZWRXaWR0aCkgLyBudW1iZXJPZlRhYnM7CiAgICB2YXIgY2xhbXBlZFRhcmdldFdpZHRoID0gTWF0aC5tYXgoVEFCX0NPTlRFTlRfTUlOX1dJRFRILCBNYXRoLm1pbihUQUJfQ09OVEVOVF9NQVhfV0lEVEgsIHRhcmdldFdpZHRoKSk7CiAgICB2YXIgZmxvb3JlZENsYW1wZWRUYXJnZXRXaWR0aCA9IE1hdGguZmxvb3IoY2xhbXBlZFRhcmdldFdpZHRoKTsKICAgIHZhciB0b3RhbFRhYnNXaWR0aFVzaW5nVGFyZ2V0ID0gZmxvb3JlZENsYW1wZWRUYXJnZXRXaWR0aCAqIG51bWJlck9mVGFicyArIDIgKiBUQUJfQ09OVEVOVF9NQVJHSU4gLSB0YWJzQ3VtdWxhdGl2ZU92ZXJsYXBwZWRXaWR0aDsKICAgIHZhciB0b3RhbEV4dHJhV2lkdGhEdWVUb0Zsb29yaW5nID0gdGFic0NvbnRlbnRXaWR0aCAtIHRvdGFsVGFic1dpZHRoVXNpbmdUYXJnZXQ7IC8vIFRPRE8gLSBTdXBwb3J0IHRhYnMgd2l0aCBkaWZmZXJlbnQgd2lkdGhzIC8gZS5nLiAicGlubmVkIiB0YWJzCgogICAgdmFyIHdpZHRocyA9IFtdOwogICAgdmFyIGV4dHJhV2lkdGhSZW1haW5pbmcgPSB0b3RhbEV4dHJhV2lkdGhEdWVUb0Zsb29yaW5nOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtYmVyT2ZUYWJzOyBpICs9IDEpIHsKICAgICAgdmFyIGV4dHJhV2lkdGggPSBmbG9vcmVkQ2xhbXBlZFRhcmdldFdpZHRoIDwgVEFCX0NPTlRFTlRfTUFYX1dJRFRIICYmIGV4dHJhV2lkdGhSZW1haW5pbmcgPiAwID8gMSA6IDA7CiAgICAgIHdpZHRocy5wdXNoKGZsb29yZWRDbGFtcGVkVGFyZ2V0V2lkdGggKyBleHRyYVdpZHRoKTsKCiAgICAgIGlmIChleHRyYVdpZHRoUmVtYWluaW5nID4gMCkgewogICAgICAgIGV4dHJhV2lkdGhSZW1haW5pbmcgLT0gMTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB3aWR0aHM7CiAgfQoKICBnZXQgdGFiQ29udGVudFBvc2l0aW9ucygpIHsKICAgIHZhciBwb3NpdGlvbnMgPSBbXTsKICAgIHZhciB7CiAgICAgIHRhYkNvbnRlbnRXaWR0aHMKICAgIH0gPSB0aGlzOwogICAgdmFyIHBvc2l0aW9uID0gVEFCX0NPTlRFTlRfTUFSR0lOOwogICAgdGFiQ29udGVudFdpZHRocy5mb3JFYWNoKCh3aWR0aCwgaSkgPT4gewogICAgICB2YXIgb2Zmc2V0ID0gaSAqIFRBQl9DT05URU5UX09WRVJMQVBfRElTVEFOQ0U7CiAgICAgIHBvc2l0aW9ucy5wdXNoKHBvc2l0aW9uIC0gb2Zmc2V0KTsKICAgICAgcG9zaXRpb24gKz0gd2lkdGg7CiAgICB9KTsKICAgIHJldHVybiBwb3NpdGlvbnM7CiAgfQoKICBnZXQgdGFiUG9zaXRpb25zKCkgewogICAgdmFyIHBvc2l0aW9ucyA9IFtdOwogICAgdGhpcy50YWJDb250ZW50UG9zaXRpb25zLmZvckVhY2goY29udGVudFBvc2l0aW9uID0+IHsKICAgICAgcG9zaXRpb25zLnB1c2goY29udGVudFBvc2l0aW9uIC0gVEFCX0NPTlRFTlRfTUFSR0lOKTsKICAgIH0pOwogICAgcmV0dXJuIHBvc2l0aW9uczsKICB9CgogIGxheW91dFRhYnMoKSB7CiAgICB2YXIgewogICAgICB0YWJDb250ZW50V2lkdGhzCiAgICB9ID0gdGhpczsKICAgIHRoaXMudGFiRWxzLmZvckVhY2goKHRhYkVsLCBpKSA9PiB7CiAgICAgIHZhciBjb250ZW50V2lkdGggPSB0YWJDb250ZW50V2lkdGhzW2ldOwogICAgICB2YXIgd2lkdGggPSBjb250ZW50V2lkdGggKyAyICogVEFCX0NPTlRFTlRfTUFSR0lOOwogICAgICB0YWJFbC5zdHlsZS53aWR0aCA9ICIiLmNvbmNhdCh3aWR0aCwgInB4Iik7CiAgICAgIHRhYkVsLnJlbW92ZUF0dHJpYnV0ZSgnaXMtc21hbGwnKTsKICAgICAgdGFiRWwucmVtb3ZlQXR0cmlidXRlKCdpcy1zbWFsbGVyJyk7CiAgICAgIHRhYkVsLnJlbW92ZUF0dHJpYnV0ZSgnaXMtbWluaScpOwoKICAgICAgaWYgKGNvbnRlbnRXaWR0aCA8IFRBQl9TSVpFX1NNQUxMKSB7CiAgICAgICAgdGFiRWwuc2V0QXR0cmlidXRlKCdpcy1zbWFsbCcsICcnKTsKICAgICAgfQoKICAgICAgaWYgKGNvbnRlbnRXaWR0aCA8IFRBQl9TSVpFX1NNQUxMRVIpIHsKICAgICAgICB0YWJFbC5zZXRBdHRyaWJ1dGUoJ2lzLXNtYWxsZXInLCAnJyk7CiAgICAgIH0KCiAgICAgIGlmIChjb250ZW50V2lkdGggPCBUQUJfU0laRV9NSU5JKSB7CiAgICAgICAgdGFiRWwuc2V0QXR0cmlidXRlKCdpcy1taW5pJywgJycpOwogICAgICB9CiAgICB9KTsKICAgIHZhciBzdHlsZUhUTUwgPSAnJzsKICAgIHRoaXMudGFiUG9zaXRpb25zLmZvckVhY2goKHBvc2l0aW9uLCBpKSA9PiB7CiAgICAgIHN0eWxlSFRNTCArPSAiXG4gICAgICAgIC5jaHJvbWUtdGFic1tkYXRhLWNocm9tZS10YWJzLWluc3RhbmNlLWlkPVwiIi5jb25jYXQodGhpcy5pbnN0YW5jZUlkLCAiXCJdIC5jaHJvbWUtdGFiOm50aC1jaGlsZCgiKS5jb25jYXQoaSArIDEsICIpIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZTNkKCIpLmNvbmNhdChwb3NpdGlvbiwgInB4LCAwLCAwKVxuICAgICAgICB9XG4gICAgICAiKTsKICAgIH0pOwogICAgdGhpcy5zdHlsZUVsLmlubmVySFRNTCA9IHN0eWxlSFRNTDsKICB9CgogIGNyZWF0ZU5ld1RhYkVsKCkgewogICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgZGl2LmlubmVySFRNTCA9IHRhYlRlbXBsYXRlOwogICAgcmV0dXJuIGRpdi5maXJzdEVsZW1lbnRDaGlsZDsKICB9CgogIGFkZFRhYih0YWJQcm9wZXJ0aWVzKSB7CiAgICB2YXIgewogICAgICBhbmltYXRlID0gZmFsc2UsCiAgICAgIGJhY2tncm91bmQgPSBmYWxzZQogICAgfSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICB2YXIgdGFiRWwgPSB0aGlzLmNyZWF0ZU5ld1RhYkVsKCk7CgogICAgaWYgKGFuaW1hdGUpIHsKICAgICAgdGFiRWwuY2xhc3NMaXN0LmFkZCgnY2hyb21lLXRhYi13YXMtanVzdC1hZGRlZCcpOwogICAgICBzZXRUaW1lb3V0KCgpID0+IHRhYkVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Nocm9tZS10YWItd2FzLWp1c3QtYWRkZWQnKSwgNTAwKTsKICAgIH0KCiAgICB0YWJQcm9wZXJ0aWVzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHsKICAgICAgaXNBZGQ6IHRydWUKICAgIH0sIGRlZmF1bHRUYXBQcm9wZXJ0aWVzKSwgdGFiUHJvcGVydGllcyk7CiAgICB0aGlzLnRhYkNvbnRlbnRFbC5hcHBlbmRDaGlsZCh0YWJFbCk7CiAgICB0aGlzLnNldFRhYkNsb3NlRXZlbnRMaXN0ZW5lcih0YWJFbCk7CiAgICB0aGlzLnVwZGF0ZVRhYih0YWJFbCwgdGFiUHJvcGVydGllcyk7CiAgICB0aGlzLmVtaXQoJ3RhYkFkZCcsIHsKICAgICAgdGFiRWwsCiAgICAgIHRhYlByb3BlcnRpZXMKICAgIH0pOwoKICAgIGlmICghYmFja2dyb3VuZCkgewogICAgICB0aGlzLnNldEN1cnJlbnRUYWIodGFiRWwsIHRhYlByb3BlcnRpZXMpOwogICAgfQoKICAgIHRoaXMuY2xlYW5VcFByZXZpb3VzbHlEcmFnZ2VkVGFicygpOwogICAgdGhpcy5sYXlvdXRUYWJzKCk7CiAgICB0aGlzLnNldHVwRHJhZ2dhYmlsbHkoKTsKICB9CgogIHNldFRhYkNsb3NlRXZlbnRMaXN0ZW5lcih0YWJFbCkgewogICAgdGFiRWwucXVlcnlTZWxlY3RvcignLmNocm9tZS10YWItY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIF8gPT4gewogICAgICB0aGlzLmVtaXQoJ29uVGFiUmVtb3ZlJywgewogICAgICAgIHRhYkVsCiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBnZXQgYWN0aXZlVGFiRWwoKSB7CiAgICByZXR1cm4gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuY2hyb21lLXRhYlthY3RpdmVdJyk7CiAgfQoKICBoYXNBY3RpdmVUYWIoKSB7CiAgICByZXR1cm4gISF0aGlzLmFjdGl2ZVRhYkVsOwogIH0KCiAgc2V0Q3VycmVudFRhYih0YWJFbCkgewogICAgdmFyIHRhYlByb3BlcnRpZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgdmFyIHsKICAgICAgYWN0aXZlVGFiRWwKICAgIH0gPSB0aGlzOwoKICAgIGlmIChhY3RpdmVUYWJFbCA9PT0gdGFiRWwpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChhY3RpdmVUYWJFbCkgewogICAgICBhY3RpdmVUYWJFbC5yZW1vdmVBdHRyaWJ1dGUoJ2FjdGl2ZScpOwogICAgfQoKICAgIHRhYkVsLnNldEF0dHJpYnV0ZSgnYWN0aXZlJywgJycpOwogICAgdGhpcy5lbWl0KCdhY3RpdmVUYWJDaGFuZ2UnLCB7CiAgICAgIHRhYkVsLAogICAgICB0YWJQcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKHsKICAgICAgICBjaGFuZ2VSb3V0ZTogdHJ1ZQogICAgICB9LCB0YWJQcm9wZXJ0aWVzKQogICAgfSk7CiAgfQoKICByZW1vdmVUYWIodGFiRWwpIHsKICAgIHZhciB0YWJQcm9wZXJ0aWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgIHZhciB7CiAgICAgIGF1dG9BY3RpdmUgPSB0cnVlCiAgICB9ID0gdGFiUHJvcGVydGllczsKCiAgICBpZiAoYXV0b0FjdGl2ZSAmJiB0YWJFbCA9PT0gdGhpcy5hY3RpdmVUYWJFbCkgewogICAgICBpZiAodGFiRWwubmV4dEVsZW1lbnRTaWJsaW5nKSB7CiAgICAgICAgdGhpcy5zZXRDdXJyZW50VGFiKHRhYkVsLm5leHRFbGVtZW50U2libGluZywgdGFiUHJvcGVydGllcyk7CiAgICAgIH0gZWxzZSBpZiAodGFiRWwucHJldmlvdXNFbGVtZW50U2libGluZykgewogICAgICAgIHRoaXMuc2V0Q3VycmVudFRhYih0YWJFbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLCB0YWJQcm9wZXJ0aWVzKTsKICAgICAgfQogICAgfQoKICAgIHRhYkVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFiRWwpOwogICAgdGhpcy5lbWl0KCd0YWJSZW1vdmUnLCB7CiAgICAgIHRhYkVsCiAgICB9KTsKICAgIHRoaXMuY2xlYW5VcFByZXZpb3VzbHlEcmFnZ2VkVGFicygpOwogICAgdGhpcy5sYXlvdXRUYWJzKCk7CiAgICB0aGlzLnNldHVwRHJhZ2dhYmlsbHkoKTsKICB9CgogIHVwZGF0ZVRhYih0YWJFbCwgdGFiUHJvcGVydGllcykgewogICAgdGFiRWwucXVlcnlTZWxlY3RvcignLmNocm9tZS10YWItdGl0bGUnKS50ZXh0Q29udGVudCA9IHRhYlByb3BlcnRpZXMubGFiZWw7CiAgICB2YXIgZmF2aWNvbkVsID0gdGFiRWwucXVlcnlTZWxlY3RvcignLmNocm9tZS10YWItZmF2aWNvbicpOwoKICAgIGlmICh0YWJQcm9wZXJ0aWVzLmZhdmljb24pIHsKICAgICAgZmF2aWNvbkVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICJ1cmwoJyIuY29uY2F0KHRhYlByb3BlcnRpZXMuZmF2aWNvbiwgIicpIik7CiAgICAgIGZhdmljb25FbC5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTsKICAgIH0gZWxzZSB7CiAgICAgIGZhdmljb25FbC5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTsKICAgICAgZmF2aWNvbkVsLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgIH0KCiAgICBpZiAodGFiUHJvcGVydGllcy5pZCkgewogICAgICB0YWJFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiLWlkJywgdGFiUHJvcGVydGllcy5pZCk7CiAgICB9CiAgfQoKICBjbGVhblVwUHJldmlvdXNseURyYWdnZWRUYWJzKCkgewogICAgdGhpcy50YWJFbHMuZm9yRWFjaCh0YWJFbCA9PiB0YWJFbC5jbGFzc0xpc3QucmVtb3ZlKCdjaHJvbWUtdGFiLXdhcy1qdXN0LWRyYWdnZWQnKSk7CiAgfQoKICBzZXR1cERyYWdnYWJpbGx5KCkgewogICAgdmFyIHsKICAgICAgdGFiRWxzCiAgICB9ID0gdGhpczsKICAgIHZhciB7CiAgICAgIHRhYlBvc2l0aW9ucwogICAgfSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNEcmFnZ2luZykgewogICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdjaHJvbWUtdGFicy1pcy1zb3J0aW5nJyk7CiAgICAgIHRoaXMuZHJhZ2dhYmlsbHlEcmFnZ2luZy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Nocm9tZS10YWItaXMtZHJhZ2dpbmcnKTsKICAgICAgdGhpcy5kcmFnZ2FiaWxseURyYWdnaW5nLmVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJyc7CiAgICAgIHRoaXMuZHJhZ2dhYmlsbHlEcmFnZ2luZy5kcmFnRW5kKCk7CiAgICAgIHRoaXMuZHJhZ2dhYmlsbHlEcmFnZ2luZy5pc0RyYWdnaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuZHJhZ2dhYmlsbHlEcmFnZ2luZy5wb3NpdGlvbkRyYWcgPSBub29wOyAvLyBQcmV2ZW50IERyYWdnYWJpbGx5IGZyb20gdXBkYXRpbmcgdGFiRWwuc3R5bGUudHJhbnNmb3JtIGluIGxhdGVyIGZyYW1lcwoKICAgICAgdGhpcy5kcmFnZ2FiaWxseURyYWdnaW5nLmRlc3Ryb3koKTsKICAgICAgdGhpcy5kcmFnZ2FiaWxseURyYWdnaW5nID0gbnVsbDsKICAgIH0KCiAgICB0aGlzLmRyYWdnYWJpbGxpZXMuZm9yRWFjaChkID0+IGQuZGVzdHJveSgpKTsKICAgIHRhYkVscy5mb3JFYWNoKCh0YWJFbCwgb3JpZ2luYWxJbmRleCkgPT4gewogICAgICB2YXIgb3JpZ2luYWxUYWJQb3NpdGlvblggPSB0YWJQb3NpdGlvbnNbb3JpZ2luYWxJbmRleF07CiAgICAgIHZhciBkcmFnZ2FiaWxseSA9IG5ldyBEcmFnZ2FiaWxseSh0YWJFbCwgewogICAgICAgIGF4aXM6ICd4JywKICAgICAgICBoYW5kbGU6ICcuY2hyb21lLXRhYi1kcmFnLWhhbmRsZScsCiAgICAgICAgY29udGFpbm1lbnQ6IHRoaXMudGFiQ29udGVudEVsCiAgICAgIH0pOwogICAgICB0aGlzLmRyYWdnYWJpbGxpZXMucHVzaChkcmFnZ2FiaWxseSk7CiAgICAgIGRyYWdnYWJpbGx5Lm9uKCdwb2ludGVyRG93bicsIGV2ZW50ID0+IHsKICAgICAgICBpZiAoZXZlbnQuYnV0dG9uID09PSAyKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyB0aGlzLmVtaXQoJ29uVGFiQ2hhbmdlJykKCgogICAgICAgIHB1Ymxpc2gobWVzc2FnZS5yb3V0ZVRhYkNoYW5nZSk7CiAgICAgICAgdGhpcy5zZXRDdXJyZW50VGFiKHRhYkVsKTsKICAgICAgfSk7CiAgICAgIGRyYWdnYWJpbGx5Lm9uKCdkcmFnU3RhcnQnLCBfID0+IHsKICAgICAgICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlOwogICAgICAgIHRoaXMuZHJhZ2dhYmlsbHlEcmFnZ2luZyA9IGRyYWdnYWJpbGx5OwogICAgICAgIHRhYkVsLmNsYXNzTGlzdC5hZGQoJ2Nocm9tZS10YWItaXMtZHJhZ2dpbmcnKTsKICAgICAgICB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoJ2Nocm9tZS10YWJzLWlzLXNvcnRpbmcnKTsKICAgICAgfSk7CiAgICAgIGRyYWdnYWJpbGx5Lm9uKCdkcmFnRW5kJywgKCkgPT4gewogICAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgIHZhciBmaW5hbFRyYW5zbGF0ZVggPSBwYXJzZUZsb2F0KHRhYkVsLnN0eWxlLmxlZnQsIDEwKTsKICAgICAgICB0YWJFbC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMCwgMCwgMCknOyAvLyBBbmltYXRlIGRyYWdnZWQgdGFiIGJhY2sgaW50byBpdHMgcGxhY2UKCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgICAgIHRhYkVsLnN0eWxlLmxlZnQgPSAnMCc7CiAgICAgICAgICB0YWJFbC5zdHlsZS50cmFuc2Zvcm0gPSAidHJhbnNsYXRlM2QoIi5jb25jYXQoZmluYWxUcmFuc2xhdGVYLCAicHgsIDAsIDApIik7CiAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICAgICAgICB0YWJFbC5jbGFzc0xpc3QucmVtb3ZlKCdjaHJvbWUtdGFiLWlzLWRyYWdnaW5nJyk7CiAgICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnY2hyb21lLXRhYnMtaXMtc29ydGluZycpOwogICAgICAgICAgICB0YWJFbC5jbGFzc0xpc3QuYWRkKCdjaHJvbWUtdGFiLXdhcy1qdXN0LWRyYWdnZWQnKTsKICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgICAgICAgICB0YWJFbC5zdHlsZS50cmFuc2Zvcm0gPSAnJzsKICAgICAgICAgICAgICB0aGlzLmxheW91dFRhYnMoKTsKICAgICAgICAgICAgICB0aGlzLnNldHVwRHJhZ2dhYmlsbHkoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIGRyYWdnYWJpbGx5Lm9uKCdkcmFnTW92ZScsIChldmVudCwgcG9pbnRlciwgbW92ZVZlY3RvcikgPT4gewogICAgICAgIC8vIEN1cnJlbnQgaW5kZXggYmUgY29tcHV0ZWQgd2l0aGluIHRoZSBldmVudCBzaW5jZSBpdCBjYW4gY2hhbmdlIGR1cmluZyB0aGUgZHJhZ01vdmUKICAgICAgICB2YXIgY3VycmVudEluZGV4ID0gdGhpcy50YWJFbHMuaW5kZXhPZih0YWJFbCk7CiAgICAgICAgdmFyIGN1cnJlbnRUYWJQb3NpdGlvblggPSBvcmlnaW5hbFRhYlBvc2l0aW9uWCArIG1vdmVWZWN0b3IueDsKICAgICAgICB2YXIgZGVzdGluYXRpb25JbmRleFRhcmdldCA9IGNsb3Nlc3QoY3VycmVudFRhYlBvc2l0aW9uWCwgdGFiUG9zaXRpb25zKTsKICAgICAgICB2YXIgZGVzdGluYXRpb25JbmRleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoaXMudGFiRWxzLmxlbmd0aCwgZGVzdGluYXRpb25JbmRleFRhcmdldCkpOwoKICAgICAgICBpZiAoY3VycmVudEluZGV4ICE9PSBkZXN0aW5hdGlvbkluZGV4KSB7CiAgICAgICAgICB0aGlzLmFuaW1hdGVUYWJNb3ZlKHRhYkVsLCBjdXJyZW50SW5kZXgsIGRlc3RpbmF0aW9uSW5kZXgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICB9CgogIGFuaW1hdGVUYWJNb3ZlKHRhYkVsLCBvcmlnaW5JbmRleCwgZGVzdGluYXRpb25JbmRleCkgewogICAgaWYgKGRlc3RpbmF0aW9uSW5kZXggPCBvcmlnaW5JbmRleCkgewogICAgICB0YWJFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0YWJFbCwgdGhpcy50YWJFbHNbZGVzdGluYXRpb25JbmRleF0pOwogICAgfSBlbHNlIHsKICAgICAgdGFiRWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGFiRWwsIHRoaXMudGFiRWxzW2Rlc3RpbmF0aW9uSW5kZXggKyAxXSk7CiAgICB9CgogICAgdGhpcy5lbWl0KCd0YWJSZW9yZGVyJywgewogICAgICB0YWJFbCwKICAgICAgb3JpZ2luSW5kZXgsCiAgICAgIGRlc3RpbmF0aW9uSW5kZXgKICAgIH0pOwogICAgdGhpcy5sYXlvdXRUYWJzKCk7CiAgfQoKICAvLyBAdHMtaWdub3JlCiAgX19yZWFjdHN0YW5kaW5fX3JlZ2VuZXJhdGVCeUV2YWwoa2V5LCBjb2RlKSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICB0aGlzW2tleV0gPSBldmFsKGNvZGUpOwogIH0KCn0KCnZhciBfZGVmYXVsdCA9IENocm9tZVRhYnM7CmV4cG9ydCBkZWZhdWx0IF9kZWZhdWx0Owo7CgooZnVuY3Rpb24gKCkgewogIHZhciByZWFjdEhvdExvYWRlciA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5kZWZhdWx0IDogdW5kZWZpbmVkOwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihUQUJfQ09OVEVOVF9NQVJHSU4sICJUQUJfQ09OVEVOVF9NQVJHSU4iLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKFRBQl9DT05URU5UX09WRVJMQVBfRElTVEFOQ0UsICJUQUJfQ09OVEVOVF9PVkVSTEFQX0RJU1RBTkNFIiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcY29tcG9uZW50c1xccm91dGVfdGFic1xcY2hyb21lX3RhYnMuanMiKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihUQUJfQ09OVEVOVF9NSU5fV0lEVEgsICJUQUJfQ09OVEVOVF9NSU5fV0lEVEgiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKFRBQl9DT05URU5UX01BWF9XSURUSCwgIlRBQl9DT05URU5UX01BWF9XSURUSCIsICJDOlxcVXNlcnNcXGN3eFxcRGVza3RvcFxcZWRpdG9yLWRlbW9cXG5vZGVfbW9kdWxlc1xcQG92aW5lXFxjb3JlXFxsaWJcXGNvbXBvbmVudHNcXHJvdXRlX3RhYnNcXGNocm9tZV90YWJzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoVEFCX1NJWkVfU01BTEwsICJUQUJfU0laRV9TTUFMTCIsICJDOlxcVXNlcnNcXGN3eFxcRGVza3RvcFxcZWRpdG9yLWRlbW9cXG5vZGVfbW9kdWxlc1xcQG92aW5lXFxjb3JlXFxsaWJcXGNvbXBvbmVudHNcXHJvdXRlX3RhYnNcXGNocm9tZV90YWJzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoVEFCX1NJWkVfU01BTExFUiwgIlRBQl9TSVpFX1NNQUxMRVIiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKFRBQl9TSVpFX01JTkksICJUQUJfU0laRV9NSU5JIiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcY29tcG9uZW50c1xccm91dGVfdGFic1xcY2hyb21lX3RhYnMuanMiKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3Rlcihub29wLCAibm9vcCIsICJDOlxcVXNlcnNcXGN3eFxcRGVza3RvcFxcZWRpdG9yLWRlbW9cXG5vZGVfbW9kdWxlc1xcQG92aW5lXFxjb3JlXFxsaWJcXGNvbXBvbmVudHNcXHJvdXRlX3RhYnNcXGNocm9tZV90YWJzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoY2xvc2VzdCwgImNsb3Nlc3QiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKHRhYlRlbXBsYXRlLCAidGFiVGVtcGxhdGUiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKGRlZmF1bHRUYXBQcm9wZXJ0aWVzLCAiZGVmYXVsdFRhcFByb3BlcnRpZXMiLCAiQzpcXFVzZXJzXFxjd3hcXERlc2t0b3BcXGVkaXRvci1kZW1vXFxub2RlX21vZHVsZXNcXEBvdmluZVxcY29yZVxcbGliXFxjb21wb25lbnRzXFxyb3V0ZV90YWJzXFxjaHJvbWVfdGFicy5qcyIpOwogIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKGluc3RhbmNlSWQsICJpbnN0YW5jZUlkIiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcY29tcG9uZW50c1xccm91dGVfdGFic1xcY2hyb21lX3RhYnMuanMiKTsKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihDaHJvbWVUYWJzLCAiQ2hyb21lVGFicyIsICJDOlxcVXNlcnNcXGN3eFxcRGVza3RvcFxcZWRpdG9yLWRlbW9cXG5vZGVfbW9kdWxlc1xcQG92aW5lXFxjb3JlXFxsaWJcXGNvbXBvbmVudHNcXHJvdXRlX3RhYnNcXGNocm9tZV90YWJzLmpzIik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoX2RlZmF1bHQsICJkZWZhdWx0IiwgIkM6XFxVc2Vyc1xcY3d4XFxEZXNrdG9wXFxlZGl0b3ItZGVtb1xcbm9kZV9tb2R1bGVzXFxAb3ZpbmVcXGNvcmVcXGxpYlxcY29tcG9uZW50c1xccm91dGVfdGFic1xcY2hyb21lX3RhYnMuanMiKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmxlYXZlTW9kdWxlIDogdW5kZWZpbmVkOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/components/route_tabs/chrome_tabs.js"],"names":["Draggabilly","message","publish","TAB_CONTENT_MARGIN","TAB_CONTENT_OVERLAP_DISTANCE","TAB_CONTENT_MIN_WIDTH","TAB_CONTENT_MAX_WIDTH","TAB_SIZE_SMALL","TAB_SIZE_SMALLER","TAB_SIZE_MINI","noop","_","closest","value","array","temp","Infinity","closestIndex","forEach","v","i","Math","abs","tabTemplate","defaultTapProperties","title","favicon","instanceId","ChromeTabs","constructor","draggabillies","init","el","setAttribute","setupStyleEl","setupEvents","layoutTabs","setupDraggabilly","emit","eventName","data","dispatchEvent","CustomEvent","detail","styleEl","document","createElement","appendChild","window","addEventListener","cleanUpPreviouslyDraggedTabs","tabEls","tabEl","setTabCloseEventListener","Array","prototype","slice","call","querySelectorAll","tabContentEl","querySelector","tabContentWidths","numberOfTabs","length","tabsContentWidth","clientWidth","tabsCumulativeOverlappedWidth","targetWidth","clampedTargetWidth","max","min","flooredClampedTargetWidth","floor","totalTabsWidthUsingTarget","totalExtraWidthDueToFlooring","widths","extraWidthRemaining","extraWidth","push","tabContentPositions","positions","position","width","offset","tabPositions","contentPosition","contentWidth","style","removeAttribute","styleHTML","innerHTML","createNewTabEl","div","firstElementChild","addTab","tabProperties","animate","background","classList","add","setTimeout","remove","Object","assign","isAdd","updateTab","setCurrentTab","activeTabEl","hasActiveTab","changeRoute","removeTab","autoActive","nextElementSibling","previousElementSibling","parentNode","removeChild","textContent","label","faviconEl","backgroundImage","id","isDragging","draggabillyDragging","element","transform","dragEnd","positionDrag","destroy","d","originalIndex","originalTabPositionX","draggabilly","axis","handle","containment","on","event","button","routeTabChange","finalTranslateX","parseFloat","left","requestAnimationFrame","pointer","moveVector","currentIndex","indexOf","currentTabPositionX","x","destinationIndexTarget","destinationIndex","animateTabMove","originIndex","insertBefore"],"mappings":"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","sourcesContent":["import Draggabilly from \"../../assets/scripts/draggabilly\";\nimport { message } from \"../../constants\";\nimport { publish } from \"../../utils/message\";\nconst TAB_CONTENT_MARGIN = 9;\nconst TAB_CONTENT_OVERLAP_DISTANCE = 1;\n// const TAB_OVERLAP_DISTANCE = TAB_CONTENT_MARGIN * 2 + TAB_CONTENT_OVERLAP_DISTANCE\nconst TAB_CONTENT_MIN_WIDTH = 24;\nconst TAB_CONTENT_MAX_WIDTH = 240;\nconst TAB_SIZE_SMALL = 84;\nconst TAB_SIZE_SMALLER = 60;\nconst TAB_SIZE_MINI = 48;\nconst noop = (_) => { };\nconst closest = (value, array) => {\n    let temp = Infinity;\n    let closestIndex = -1;\n    array.forEach((v, i) => {\n        if (Math.abs(value - v) < temp) {\n            temp = Math.abs(value - v);\n            closestIndex = i;\n        }\n    });\n    return closestIndex;\n};\nconst tabTemplate = `\n  <div class=\"chrome-tab\">\n    <div class=\"chrome-tab-dividers\"></div>\n    <div class=\"chrome-tab-background\">\n      <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"><defs><symbol id=\"chrome-tab-geometry-left\" viewBox=\"0 0 214 36\"><path d=\"M17 0h197v36H0v-2c4.5 0 9-3.5 9-8V8c0-4.5 3.5-8 8-8z\"/></symbol><symbol id=\"chrome-tab-geometry-right\" viewBox=\"0 0 214 36\"><use xlink:href=\"#chrome-tab-geometry-left\"/></symbol><clipPath id=\"crop\"><rect class=\"mask\" width=\"100%\" height=\"100%\" x=\"0\"/></clipPath></defs><svg width=\"52%\" height=\"100%\"><use xlink:href=\"#chrome-tab-geometry-left\" width=\"214\" height=\"36\" class=\"chrome-tab-geometry\"/></svg><g transform=\"scale(-1, 1)\"><svg width=\"52%\" height=\"100%\" x=\"-100%\" y=\"0\"><use xlink:href=\"#chrome-tab-geometry-right\" width=\"214\" height=\"36\" class=\"chrome-tab-geometry\"/></svg></g></svg>\n    </div>\n    <div class=\"chrome-tab-content\">\n      <div class=\"chrome-tab-favicon\"></div>\n      <div class=\"chrome-tab-title\"></div>\n      <div class=\"chrome-tab-drag-handle\"></div>\n      <div class=\"chrome-tab-close\">\n      <svg\n        viewBox=\"0 0 1024 1024\"\n        version=\"1.1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        p-id=\"2352\"\n        xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        width=\"200\"\n        height=\"200\"\n      >\n        <path\n          d=\"M518.5815877 469.42879156L240.02576609 190.87364889a34.76142882 34.76142882 0 1 0-49.17520097 49.12971238l278.55446374 278.57822643L190.85056508 797.15913522a34.76142882 34.76142882 0 1 0 49.15279619 49.15211725l278.57822651-278.55446378 278.57822634 278.55446378a34.76142882 34.76142882 0 1 0 49.15211728-49.12903345l-278.55446374-278.60063124 278.55446374-278.55514271a34.76142882 34.76142882 0 1 0-49.15211728-49.15279622L518.60467145 469.42879156z\"\n          p-id=\"2353\"\n        />\n      </svg>\n      </div>\n    </div>\n  </div>\n`;\nconst defaultTapProperties = {\n    title: 'New tab',\n    favicon: false,\n};\nlet instanceId = 0;\nclass ChromeTabs {\n    constructor() {\n        this.draggabillies = [];\n    }\n    init(el) {\n        this.el = el;\n        this.instanceId = instanceId;\n        this.el.setAttribute('data-chrome-tabs-instance-id', this.instanceId);\n        instanceId += 1;\n        this.setupStyleEl();\n        this.setupEvents();\n        this.layoutTabs();\n        this.setupDraggabilly();\n    }\n    emit(eventName, data) {\n        this.el.dispatchEvent(new CustomEvent(eventName, { detail: data }));\n    }\n    setupStyleEl() {\n        this.styleEl = document.createElement('style');\n        this.el.appendChild(this.styleEl);\n    }\n    setupEvents() {\n        window.addEventListener('resize', (_) => {\n            this.cleanUpPreviouslyDraggedTabs();\n            this.layoutTabs();\n        });\n        this.tabEls.forEach((tabEl) => this.setTabCloseEventListener(tabEl));\n    }\n    get tabEls() {\n        return Array.prototype.slice.call(this.el.querySelectorAll('.chrome-tab'));\n    }\n    get tabContentEl() {\n        return this.el.querySelector('.chrome-tabs-content');\n    }\n    get tabContentWidths() {\n        const numberOfTabs = this.tabEls.length;\n        const tabsContentWidth = this.tabContentEl.clientWidth;\n        const tabsCumulativeOverlappedWidth = (numberOfTabs - 1) * TAB_CONTENT_OVERLAP_DISTANCE;\n        const targetWidth = (tabsContentWidth - 2 * TAB_CONTENT_MARGIN + tabsCumulativeOverlappedWidth) / numberOfTabs;\n        const clampedTargetWidth = Math.max(TAB_CONTENT_MIN_WIDTH, Math.min(TAB_CONTENT_MAX_WIDTH, targetWidth));\n        const flooredClampedTargetWidth = Math.floor(clampedTargetWidth);\n        const totalTabsWidthUsingTarget = flooredClampedTargetWidth * numberOfTabs +\n            2 * TAB_CONTENT_MARGIN -\n            tabsCumulativeOverlappedWidth;\n        const totalExtraWidthDueToFlooring = tabsContentWidth - totalTabsWidthUsingTarget;\n        // TODO - Support tabs with different widths / e.g. \"pinned\" tabs\n        const widths = [];\n        let extraWidthRemaining = totalExtraWidthDueToFlooring;\n        for (let i = 0; i < numberOfTabs; i += 1) {\n            const extraWidth = flooredClampedTargetWidth < TAB_CONTENT_MAX_WIDTH && extraWidthRemaining > 0 ? 1 : 0;\n            widths.push(flooredClampedTargetWidth + extraWidth);\n            if (extraWidthRemaining > 0) {\n                extraWidthRemaining -= 1;\n            }\n        }\n        return widths;\n    }\n    get tabContentPositions() {\n        const positions = [];\n        const { tabContentWidths } = this;\n        let position = TAB_CONTENT_MARGIN;\n        tabContentWidths.forEach((width, i) => {\n            const offset = i * TAB_CONTENT_OVERLAP_DISTANCE;\n            positions.push(position - offset);\n            position += width;\n        });\n        return positions;\n    }\n    get tabPositions() {\n        const positions = [];\n        this.tabContentPositions.forEach((contentPosition) => {\n            positions.push(contentPosition - TAB_CONTENT_MARGIN);\n        });\n        return positions;\n    }\n    layoutTabs() {\n        const { tabContentWidths } = this;\n        this.tabEls.forEach((tabEl, i) => {\n            const contentWidth = tabContentWidths[i];\n            const width = contentWidth + 2 * TAB_CONTENT_MARGIN;\n            tabEl.style.width = `${width}px`;\n            tabEl.removeAttribute('is-small');\n            tabEl.removeAttribute('is-smaller');\n            tabEl.removeAttribute('is-mini');\n            if (contentWidth < TAB_SIZE_SMALL) {\n                tabEl.setAttribute('is-small', '');\n            }\n            if (contentWidth < TAB_SIZE_SMALLER) {\n                tabEl.setAttribute('is-smaller', '');\n            }\n            if (contentWidth < TAB_SIZE_MINI) {\n                tabEl.setAttribute('is-mini', '');\n            }\n        });\n        let styleHTML = '';\n        this.tabPositions.forEach((position, i) => {\n            styleHTML += `\n        .chrome-tabs[data-chrome-tabs-instance-id=\"${this.instanceId}\"] .chrome-tab:nth-child(${i +\n                1}) {\n          transform: translate3d(${position}px, 0, 0)\n        }\n      `;\n        });\n        this.styleEl.innerHTML = styleHTML;\n    }\n    createNewTabEl() {\n        const div = document.createElement('div');\n        div.innerHTML = tabTemplate;\n        return div.firstElementChild;\n    }\n    addTab(tabProperties, { animate = false, background = false } = {}) {\n        const tabEl = this.createNewTabEl();\n        if (animate) {\n            tabEl.classList.add('chrome-tab-was-just-added');\n            setTimeout(() => tabEl.classList.remove('chrome-tab-was-just-added'), 500);\n        }\n        tabProperties = Object.assign(Object.assign({ isAdd: true }, defaultTapProperties), tabProperties);\n        this.tabContentEl.appendChild(tabEl);\n        this.setTabCloseEventListener(tabEl);\n        this.updateTab(tabEl, tabProperties);\n        this.emit('tabAdd', { tabEl, tabProperties });\n        if (!background) {\n            this.setCurrentTab(tabEl, tabProperties);\n        }\n        this.cleanUpPreviouslyDraggedTabs();\n        this.layoutTabs();\n        this.setupDraggabilly();\n    }\n    setTabCloseEventListener(tabEl) {\n        tabEl.querySelector('.chrome-tab-close').addEventListener('click', (_) => {\n            this.emit('onTabRemove', { tabEl });\n        });\n    }\n    get activeTabEl() {\n        return this.el.querySelector('.chrome-tab[active]');\n    }\n    hasActiveTab() {\n        return !!this.activeTabEl;\n    }\n    setCurrentTab(tabEl, tabProperties = {}) {\n        const { activeTabEl } = this;\n        if (activeTabEl === tabEl) {\n            return;\n        }\n        if (activeTabEl) {\n            activeTabEl.removeAttribute('active');\n        }\n        tabEl.setAttribute('active', '');\n        this.emit('activeTabChange', {\n            tabEl,\n            tabProperties: Object.assign({ changeRoute: true }, tabProperties),\n        });\n    }\n    removeTab(tabEl, tabProperties = {}) {\n        const { autoActive = true } = tabProperties;\n        if (autoActive && tabEl === this.activeTabEl) {\n            if (tabEl.nextElementSibling) {\n                this.setCurrentTab(tabEl.nextElementSibling, tabProperties);\n            }\n            else if (tabEl.previousElementSibling) {\n                this.setCurrentTab(tabEl.previousElementSibling, tabProperties);\n            }\n        }\n        tabEl.parentNode.removeChild(tabEl);\n        this.emit('tabRemove', { tabEl });\n        this.cleanUpPreviouslyDraggedTabs();\n        this.layoutTabs();\n        this.setupDraggabilly();\n    }\n    updateTab(tabEl, tabProperties) {\n        tabEl.querySelector('.chrome-tab-title').textContent = tabProperties.label;\n        const faviconEl = tabEl.querySelector('.chrome-tab-favicon');\n        if (tabProperties.favicon) {\n            faviconEl.style.backgroundImage = `url('${tabProperties.favicon}')`;\n            faviconEl.removeAttribute('hidden', '');\n        }\n        else {\n            faviconEl.setAttribute('hidden', '');\n            faviconEl.removeAttribute('style');\n        }\n        if (tabProperties.id) {\n            tabEl.setAttribute('data-tab-id', tabProperties.id);\n        }\n    }\n    cleanUpPreviouslyDraggedTabs() {\n        this.tabEls.forEach((tabEl) => tabEl.classList.remove('chrome-tab-was-just-dragged'));\n    }\n    setupDraggabilly() {\n        const { tabEls } = this;\n        const { tabPositions } = this;\n        if (this.isDragging) {\n            this.isDragging = false;\n            this.el.classList.remove('chrome-tabs-is-sorting');\n            this.draggabillyDragging.element.classList.remove('chrome-tab-is-dragging');\n            this.draggabillyDragging.element.style.transform = '';\n            this.draggabillyDragging.dragEnd();\n            this.draggabillyDragging.isDragging = false;\n            this.draggabillyDragging.positionDrag = noop; // Prevent Draggabilly from updating tabEl.style.transform in later frames\n            this.draggabillyDragging.destroy();\n            this.draggabillyDragging = null;\n        }\n        this.draggabillies.forEach((d) => d.destroy());\n        tabEls.forEach((tabEl, originalIndex) => {\n            const originalTabPositionX = tabPositions[originalIndex];\n            const draggabilly = new Draggabilly(tabEl, {\n                axis: 'x',\n                handle: '.chrome-tab-drag-handle',\n                containment: this.tabContentEl,\n            });\n            this.draggabillies.push(draggabilly);\n            draggabilly.on('pointerDown', (event) => {\n                if (event.button === 2) {\n                    return;\n                }\n                // this.emit('onTabChange')\n                publish(message.routeTabChange);\n                this.setCurrentTab(tabEl);\n            });\n            draggabilly.on('dragStart', (_) => {\n                this.isDragging = true;\n                this.draggabillyDragging = draggabilly;\n                tabEl.classList.add('chrome-tab-is-dragging');\n                this.el.classList.add('chrome-tabs-is-sorting');\n            });\n            draggabilly.on('dragEnd', () => {\n                this.isDragging = false;\n                const finalTranslateX = parseFloat(tabEl.style.left, 10);\n                tabEl.style.transform = 'translate3d(0, 0, 0)';\n                // Animate dragged tab back into its place\n                requestAnimationFrame(() => {\n                    tabEl.style.left = '0';\n                    tabEl.style.transform = `translate3d(${finalTranslateX}px, 0, 0)`;\n                    requestAnimationFrame(() => {\n                        tabEl.classList.remove('chrome-tab-is-dragging');\n                        this.el.classList.remove('chrome-tabs-is-sorting');\n                        tabEl.classList.add('chrome-tab-was-just-dragged');\n                        requestAnimationFrame(() => {\n                            tabEl.style.transform = '';\n                            this.layoutTabs();\n                            this.setupDraggabilly();\n                        });\n                    });\n                });\n            });\n            draggabilly.on('dragMove', (event, pointer, moveVector) => {\n                // Current index be computed within the event since it can change during the dragMove\n                const currentIndex = this.tabEls.indexOf(tabEl);\n                const currentTabPositionX = originalTabPositionX + moveVector.x;\n                const destinationIndexTarget = closest(currentTabPositionX, tabPositions);\n                const destinationIndex = Math.max(0, Math.min(this.tabEls.length, destinationIndexTarget));\n                if (currentIndex !== destinationIndex) {\n                    this.animateTabMove(tabEl, currentIndex, destinationIndex);\n                }\n            });\n        });\n    }\n    animateTabMove(tabEl, originIndex, destinationIndex) {\n        if (destinationIndex < originIndex) {\n            tabEl.parentNode.insertBefore(tabEl, this.tabEls[destinationIndex]);\n        }\n        else {\n            tabEl.parentNode.insertBefore(tabEl, this.tabEls[destinationIndex + 1]);\n        }\n        this.emit('tabReorder', { tabEl, originIndex, destinationIndex });\n        this.layoutTabs();\n    }\n}\nexport default ChromeTabs;\n"]}]}