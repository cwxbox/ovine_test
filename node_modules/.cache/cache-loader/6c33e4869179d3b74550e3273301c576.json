{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--5-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\routes\\exports.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\routes\\exports.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoqCiAqIOi3r+eUseebuOWFs+W3peWFt+WHveaVsAogKiBUT0RPOiDmt7vliqAgdW5pdCB0ZXN0CiAqLwp2YXIgX19hd2FpdGVyID0gdGhpcyAmJiB0aGlzLl9fYXdhaXRlciB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7CiAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlc29sdmUodmFsdWUpOwogICAgfSk7CiAgfQoKICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7CiAgICAgIHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOwogICAgfQoKICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTsKICB9KTsKfTsKCmltcG9ydCB7IGNsb25lRGVlcCwgZ2V0LCBpc0Z1bmN0aW9uLCBpc1BsYWluT2JqZWN0IH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IHsgYXBwIH0gZnJvbSAiLi4vYXBwIjsKaW1wb3J0IHsgZGVmTG9hZFBhZ2VTY2hlbWEsIHJvb3RSb3V0ZSB9IGZyb20gIi4uL2NvbnN0YW50cyI7CmltcG9ydCBsb2dnZXIgZnJvbSAiLi4vdXRpbHMvbG9nZ2VyIjsKaW1wb3J0IHsgaXNTdWJTdHIsIHJldHJ5UHJvbWlzZSwgbG9hZFNjcmlwdEFzeW5jLCBkZXNlcmlhbGl6ZSB9IGZyb20gIi4uL3V0aWxzL3Rvb2wiOwp2YXIgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignbGliOnJvdXRlczpleHBvcnRzJyk7CnZhciByZXF1ZXN0Q29tcG9uZW50ID0gJ3JlcXVlc3Q6Ly9wYXRoVG9Db21wb25lbnQnOyAvLyDorqHnrpcg6Lev55SxIHBhdGgKCmV4cG9ydCBmdW5jdGlvbiBnZXRSb3V0ZVBhdGgocGF0aCkgewogIHZhciBvcmlnaW4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogIHZhciByb3V0ZVByZWZpeCA9IGFwcC5jb25zdGFudHMucm91dGVQcmVmaXggfHwgcm9vdFJvdXRlOwogIHZhciBjdXJyUHRoU3RyID0gY3VyclBhdGgocGF0aCk7CiAgdmFyIHBhdGhTdHIgPSAiIi5jb25jYXQocm9vdFJvdXRlKS5jb25jYXQoY3VyclB0aFN0cik7CiAgdmFyIHdpdGhCYXNlVXJsID0gaXNTdWJTdHIocGF0aFN0ciwgcm91dGVQcmVmaXgsIDApOwogIHZhciByb3V0ZVBhdGggPSAiIi5jb25jYXQod2l0aEJhc2VVcmwgPyByb290Um91dGUgOiByb3V0ZVByZWZpeCkuY29uY2F0KGN1cnJQdGhTdHIpOwoKICBpZiAob3JpZ2luKSB7CiAgICByb3V0ZVBhdGggPSBwYXRoU3RyLnJlcGxhY2UobmV3IFJlZ0V4cCgiXiIuY29uY2F0KHJvdXRlUHJlZml4KSksIHJvb3RSb3V0ZSk7CiAgfQoKICByZXR1cm4gcm91dGVQYXRoOwp9CmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyUm91dGVQYXRoKCkgewogIHJldHVybiBnZXRSb3V0ZVBhdGgod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLCB0cnVlKTsKfSAvLyDliKTmlq3mmK/lkKbmmK/mnKzlnLDmlofku7blnLDlnYAKCmZ1bmN0aW9uIGlzTG9jYWxGaWxlKHVybCkgewogIHJldHVybiAhKHVybC5pbmRleE9mKCc6Ly8nKSA+IC0xIHx8IHVybC5zdGFydHNXaXRoKCcvLycpKTsKfSAvLyDojrflj5YgcGFnZXMg5YaF57uE5Lu25paH5Lu25Zyo6aG555uu5YaF5pys5Zyw55qE55u45a+56Lev5b6EIOaIluiAhSDov5znqIvmnI3liqHlmajot6/lvoTvvIwKCgpleHBvcnQgZnVuY3Rpb24gZ2V0UGFnZUZpbGVQYXRoKG9wdGlvbikgewogIHZhciB7CiAgICBwYXRoVG9Db21wb25lbnQsCiAgICBub2RlUGF0aCA9ICcnLAogICAgcGF0aCA9ICcnCiAgfSA9IG9wdGlvbjsgLy8gcGF0aFRvQ29tcG9uZW50IOS4uiByZXFPcHQg5pe277yMIOebtOaOpei/lOWbniDkuIDkuKog5Zu65a6a5qCH56S65a2X56ym5LiyCgogIGlmIChpc1BsYWluT2JqZWN0KHBhdGhUb0NvbXBvbmVudCkgJiYgZ2V0KHBhdGhUb0NvbXBvbmVudCwgJ3VybCcpKSB7CiAgICByZXR1cm4gcmVxdWVzdENvbXBvbmVudDsKICB9CgogIHZhciB1cmwgPSB0eXBlb2YgcGF0aFRvQ29tcG9uZW50ID09PSAnc3RyaW5nJyAvLyDku7vmhI/ot6/lvoQKICA/IHBhdGhUb0NvbXBvbmVudCA6IHBhdGhUb0NvbXBvbmVudCA9PT0gdHJ1ZSAvLyBwYXRoVG9Db21wb25lbnQg6buY6K6kIOS9v+eUqCBub2RlUGF0aCDlpoLmnpzorr7nva7kuLogdHJ1ZSzooajnpLog5L2/55SoICBwYXRoIOi3r+W+hAogID8gcGF0aCB8fCBub2RlUGF0aCA6IG5vZGVQYXRoIHx8IHBhdGg7IC8vIOacrOWcsOaWh+S7tui3r+W+hAoKICBpZiAoaXNMb2NhbEZpbGUodXJsKSkgewogICAgcmV0dXJuIGN1cnJQYXRoKHVybCk7CiAgfSAvLyDlvZPliY3ln5/lkI3mnI3liqHlmajkuIvot6/lvoQKCgogIGlmICh1cmwuc3RhcnRzV2l0aCgncm9vdDovLycpKSB7CiAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIHVybC5zdWJzdHJpbmcoNik7CiAgfSAvLyDov5znqIvmnI3liqHlmajkuIsg6Lev5b6ECgoKICBpZiAodXJsLnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSB8fCB1cmwuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKSkgewogICAgcmV0dXJuIHVybDsKICB9IC8vIOWuveazm+WNj+iurgoKCiAgaWYgKHVybC5zdGFydHNXaXRoKCcvLycpKSB7CiAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgdXJsOwogIH0KCiAgcmV0dXJuICcnOwp9IC8vIOiOt+WPliDpobXpnaLpooTorr7lgLzjgILpu5jorqTkuLogIHBhZ2VzL3h4eC9wcmVzZXQudHMg6K+l5paH5Lu25piv5p2D6ZmQ6K6+572u5b+F6aG75paH5Lu2CgpleHBvcnQgZnVuY3Rpb24gZ2V0UGFnZVByZXNldChvcHRpb24pIHsKICB2YXIgX2E7CgogIHZhciBmaWxlUGF0aCA9IGdldFBhZ2VGaWxlUGF0aChvcHRpb24pOwoKICBpZiAoKChfYSA9IGFwcC5hc3luY1BhZ2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wcmVzZXQpICYmIG9wdGlvbi5ub2RlUGF0aCAmJiBhcHAuYXN5bmNQYWdlLnByZXNldFtvcHRpb24ubm9kZVBhdGhdKSB7CiAgICByZXR1cm4gY2xvbmVEZWVwKGFwcC5hc3luY1BhZ2UucHJlc2V0W29wdGlvbi5ub2RlUGF0aF0pOwogIH0gLy8g5Yqg6L295pys5Zyw5paH5Lu2CgoKICBpZiAoaXNMb2NhbEZpbGUoZmlsZVBhdGgpKSB7CiAgICB0cnkgewogICAgICAvKiB3ZWJwYWNrSW5jbHVkZTogL3BhZ2VzW1xcL10uKltcXC9dcHJlc2V0XC5bdHxqXXN4PyQvICovCiAgICAgIHZhciBwYWdlUGVzdCA9IHJlcXVpcmUoIn4vcGFnZXMvIi5jb25jYXQoZmlsZVBhdGgsICIvcHJlc2V0IikpLmRlZmF1bHQ7CgogICAgICByZXR1cm4gaXNGdW5jdGlvbihwYWdlUGVzdCkgPyBwYWdlUGVzdChvcHRpb24pIDogcGFnZVBlc3Q7CiAgICB9IGNhdGNoIChlKSB7Ly8KICAgIH0KICB9CgogIHJldHVybiB1bmRlZmluZWQ7Cn0gLy8g6I635Y+WIG1vY2vjgILpu5jorqTkuLogIHBhZ2VzL3h4eC9tb2NrLnRzIOWtmOWcqOivpeaWh+S7tu+8jOWwhuiHquWKqOazqOWFpW1vY2vliLBwcmVzdOavj+S4gOS4qiBhcGkKCmV4cG9ydCBmdW5jdGlvbiBnZXRQYWdlTW9ja1NvdXJjZShvcHRpb24pIHsKICB2YXIgX2E7CgogIGlmICghYXBwLmVudi5pc01vY2spIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBpZiAoKChfYSA9IGFwcC5hc3luY1BhZ2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tb2NrKSAmJiBvcHRpb24ubm9kZVBhdGggJiYgYXBwLmFzeW5jUGFnZS5tb2NrW29wdGlvbi5ub2RlUGF0aF0pIHsKICAgIHJldHVybiBjbG9uZURlZXAoYXBwLmFzeW5jUGFnZS5tb2NrW29wdGlvbi5ub2RlUGF0aF0pOwogIH0KCiAgdmFyIGZpbGVQYXRoID0gZ2V0UGFnZUZpbGVQYXRoKG9wdGlvbik7IC8vIOWKoOi9veacrOWcsOaWh+S7tgoKICBpZiAoaXNMb2NhbEZpbGUoZmlsZVBhdGgpKSB7CiAgICB0cnkgewogICAgICAvKiB3ZWJwYWNrSW5jbHVkZTogL3BhZ2VzW1xcL10uKltcXC9dbW9ja1wuW3R8al1zeD8kLyAqLwogICAgICB2YXIgcGFnZVBlc3QgPSByZXF1aXJlKCJ+L3BhZ2VzLyIuY29uY2F0KGZpbGVQYXRoLCAiL21vY2siKSk7CgogICAgICByZXR1cm4gcGFnZVBlc3QuZGVmYXVsdDsKICAgIH0gY2F0Y2ggKGUpIHsvLwogICAgfQogIH0KCiAgcmV0dXJuIHVuZGVmaW5lZDsKfSAvLyDlvILmraXojrflj5bpobXpnaLmlofku7YKCmV4cG9ydCBmdW5jdGlvbiBnZXRQYWdlRmlsZUFzeW5jKG9wdGlvbikgewogIHZhciBfYTsKCiAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsKICAgIHZhciBmaWxlUGF0aCA9IGdldFBhZ2VGaWxlUGF0aChvcHRpb24pOyAvLyBUT0RPOiDmlK/mjIHkvKDlhaUg6aG16Z2i5Ye66ZSZIOiHquWumuS5iSBzY2hlbWHvvIzlubblsIbms6jlhaXlj4LmlbAKCiAgICB2YXIgcGFnZUFsaWFzID0gb3B0aW9uLm5vZGVQYXRoOyAvLyDliqDovb3mnKzlnLDmlofku7YKCiAgICBpZiAoaXNMb2NhbEZpbGUoZmlsZVBhdGgpKSB7CiAgICAgIHJldHVybiByZXRyeVByb21pc2UoKCkgPT4gaW1wb3J0KAogICAgICAvKiB3ZWJwYWNrSW5jbHVkZTogL1tcXC9dc3JjW1xcL11wYWdlc1tcXC9dLipbXFwvXWluZGV4XC5bdHxqXXN4PyQvICovCgogICAgICAvKiB3ZWJwYWNrQ2h1bmtOYW1lOiAicF9bcmVxdWVzdF0iICovCiAgICAgICJ+L3BhZ2VzLyIuY29uY2F0KGZpbGVQYXRoLCAiL2luZGV4IikpKTsKICAgIH0KCiAgICBpZiAoIXBhZ2VBbGlhcykgewogICAgICByZXR1cm4gZGVmTG9hZFBhZ2VTY2hlbWE7CiAgICB9CgogICAgaWYgKCgoX2EgPSBhcHAuYXN5bmNQYWdlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2NoZW1hKSAmJiBhcHAuYXN5bmNQYWdlLnNjaGVtYVtwYWdlQWxpYXNdKSB7CiAgICAgIHJldHVybiBjbG9uZURlZXAoYXBwLmFzeW5jUGFnZS5zY2hlbWFbcGFnZUFsaWFzXSk7CiAgICB9IC8vIOWKqOaAgea4suafk+mhtemdogoKCiAgICByZXR1cm4gcmV0cnlQcm9taXNlKCgpID0+IHsKICAgICAgdmFyIF9hOwoKICAgICAgYXBwLmFzeW5jUGFnZS5zY2hlbWEgPSAoKF9hID0gYXBwLmFzeW5jUGFnZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNjaGVtYSkgfHwge307IC8vIOW8guatpeWKoOi9veiEmuacrO+8jOinhOiMgyB3aW5kb3cub3ZpbmUuYWRkUGFnZVNjaGVtYUpzKG9wdGlvbi5ub2RlUGF0aCwge2RlZmF1bHQ/LHNjaGVtYX0pCgogICAgICBpZiAoL1wuanMvLnRlc3QoZmlsZVBhdGgpKSB7CiAgICAgICAgcmV0dXJuIGxvYWRTY3JpcHRBc3luYyhmaWxlUGF0aCkudGhlbigoKSA9PiB7CiAgICAgICAgICBpZiAoIWFwcC5hc3luY1BhZ2Uuc2NoZW1hW3BhZ2VBbGlhc10pIHsKICAgICAgICAgICAgbG9nLmVycm9yKCJQbGVhc2UgYWRkIHBhZ2Ugc2NoZW1hIGZvciBcIiIuY29uY2F0KHBhZ2VBbGlhcywgIlwiIGJ5IHVzaW5nICd3aW5kb3cub3ZpbmUuYWRkUGFnZVNjaGVtYUpzKCknLiIpKTsKICAgICAgICAgICAgcmV0dXJuIGRlZkxvYWRQYWdlU2NoZW1hOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBjbG9uZURlZXAoYXBwLmFzeW5jUGFnZS5zY2hlbWFbcGFnZUFsaWFzXSk7CiAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgIGxvZy5lcnJvcignQW4gZXJyb3Igb2NjdXJyZWQgYnkgbG9hZCBqcyBzY3JpcHRzLicsIGVycik7CiAgICAgICAgICByZXR1cm4gZGVmTG9hZFBhZ2VTY2hlbWE7CiAgICAgICAgfSk7CiAgICAgIH0gLy8g5o6l5Y+j6I635Y+WICBzY2hlbWEsIOS4jee8k+WtmOmhtemdogoKCiAgICAgIHJldHVybiBhcHAucmVxdWVzdChmaWxlUGF0aCA9PT0gcmVxdWVzdENvbXBvbmVudCA/IG9wdGlvbi5wYXRoVG9Db21wb25lbnQgOiB7CiAgICAgICAgbWV0aG9kOiAnR0VUJywKICAgICAgICB1cmw6IGZpbGVQYXRoCiAgICAgIH0pLnRoZW4oKF9yZWYpID0+IHsKICAgICAgICB2YXIgewogICAgICAgICAgZGF0YQogICAgICAgIH0gPSBfcmVmOwogICAgICAgIHZhciB7CiAgICAgICAgICBzY2hlbWE6IHJlc1NjaGVtYQogICAgICAgIH0gPSAoZGF0YSA9PT0gbnVsbCB8fCBkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkYXRhLmRhdGEpIHx8IHt9OwogICAgICAgIHZhciBzY2hlbWEgPSBpc1BsYWluT2JqZWN0KHJlc1NjaGVtYSkgPyByZXNTY2hlbWEgOiBkZXNlcmlhbGl6ZShyZXNTY2hlbWEgfHwgJycpOwoKICAgICAgICBpZiAoIXNjaGVtYSkgewogICAgICAgICAgbG9nLmVycm9yKCJQbGVhc2UgYWRkIHBhZ2Ugc2NoZW1hIHN0cmluZyBmb3IgXCIiLmNvbmNhdChwYWdlQWxpYXMsICJcIiBieSBodHRwIHNlcnZlciBhcGkuIikpOwogICAgICAgICAgcmV0dXJuIGRlZkxvYWRQYWdlU2NoZW1hOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBhZ2VTY2hlbWEgPSB7CiAgICAgICAgICBzY2hlbWEKICAgICAgICB9OwogICAgICAgIHJldHVybiBwYWdlU2NoZW1hOwogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIGxvZy5lcnJvcignQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBmZXRjaCBwYWdlIHNjaGVtYS4nLCBlcnIpOwogICAgICAgIHJldHVybiBkZWZMb2FkUGFnZVNjaGVtYTsKICAgICAgfSk7CiAgICB9KTsKICB9KTsKfSAvLyDojrflj5Ygbm9kZVBhdGgKCmV4cG9ydCBmdW5jdGlvbiBnZXROb2RlUGF0aChvcHRpb24pIHsKICByZXR1cm4gb3B0aW9uLm5vZGVQYXRoIHx8IGdldFBhZ2VGaWxlUGF0aChvcHRpb24pOwp9IC8vIOW9k+WJjei3r+W+hCzljrvpmaTlpJrkvZnliY3nvIAvLOS/neaMgeS4gOiHtOaApyAgL2xvZ2luID09PiBsb2dpbgoKZXhwb3J0IGZ1bmN0aW9uIGN1cnJQYXRoKHBhdGgpIHsKICB2YXIgZGVmYXVsdFBhdGggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcnOwoKICBpZiAoIXBhdGggfHwgcGF0aCA9PT0gcm9vdFJvdXRlKSB7CiAgICByZXR1cm4gZGVmYXVsdFBhdGg7CiAgfQoKICByZXR1cm4gIWlzU3ViU3RyKHBhdGgsIHJvb3RSb3V0ZSwgMCkgPyBwYXRoIDogcGF0aC5zdWJzdHJpbmcoMSk7Cn0gLy8gYW1pcyDlrpjmlrkg5qC85byP5YyW6aG555uu5YaFIOmTvuaOpQoKZXhwb3J0IHZhciBub3JtYWxpemVMaW5rID0gb3B0aW9uID0+IHsKICB2YXIgewogICAgbG9jYXRpb246IGxvYyA9IHdpbmRvdy5sb2NhdGlvbiwKICAgIHRvOiB0b0xpbmsKICB9ID0gb3B0aW9uOwogIHZhciBsb2NhdGlvbiA9IE9iamVjdC5hc3NpZ24oewogICAgcGF0aG5hbWU6IHJvb3RSb3V0ZSwKICAgIHNlYXJjaDogJycsCiAgICBoYXNoOiAnJwogIH0sIGxvYyk7CiAgdmFyIHRvID0gdG9MaW5rIHx8ICcnOwoKICBpZiAodG8gJiYgdG9bMF0gPT09ICcjJykgewogICAgdG8gPSBsb2NhdGlvbi5wYXRobmFtZSArIGxvY2F0aW9uLnNlYXJjaCArIHRvOwogIH0gZWxzZSBpZiAodG8gJiYgdG9bMF0gPT09ICc/JykgewogICAgdG8gPSBsb2NhdGlvbi5wYXRobmFtZSArIHRvOwogIH0KCiAgdmFyIHNlYXJjaElkeCA9IHRvLmluZGV4T2YoJz8nKTsKICB2YXIgaGFzaElkeCA9IHRvLmluZGV4T2YoJyMnKTsKICB2YXIgaXNTZWFyY2ggPSBzZWFyY2hJZHggPiAtMTsKICB2YXIgaXNIYXNoID0gaGFzaElkeCA+IC0xOwogIHZhciBwYXRobmFtZSA9IGlzU2VhcmNoID8gdG8uc3Vic3RyaW5nKDAsIHNlYXJjaElkeCkgOiBpc0hhc2ggPyB0by5zdWJzdHJpbmcoMCwgaGFzaElkeCkgOiB0bzsKICB2YXIgc2VhcmNoID0gaXNTZWFyY2ggPyB0by5zdWJzdHJpbmcoc2VhcmNoSWR4LCBpc0hhc2ggPyBoYXNoSWR4IDogdW5kZWZpbmVkKSA6ICcnOwogIHZhciBoYXNoID0gaXNIYXNoID8gdG8uc3Vic3RyaW5nKGhhc2hJZHgpIDogbG9jYXRpb24uaGFzaDsKCiAgaWYgKCFwYXRobmFtZSkgewogICAgcGF0aG5hbWUgPSBsb2NhdGlvbi5wYXRobmFtZTsKICB9IGVsc2UgaWYgKHBhdGhuYW1lWzBdICE9PSByb290Um91dGUgJiYgIS9eaHR0cHM/OlwvXC8vLnRlc3QocGF0aG5hbWUpKSB7CiAgICB2YXIgcmVsYXRpdmVCYXNlID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICB2YXIgcGF0aHMgPSByZWxhdGl2ZUJhc2Uuc3BsaXQocm9vdFJvdXRlKTsKICAgIHBhdGhzLnBvcCgpOwogICAgdmFyIG0gPSAvXlwuXC4/XC8vLmV4ZWMocGF0aG5hbWUpOwoKICAgIHdoaWxlIChtKSB7CiAgICAgIGlmIChtWzBdID09PSAnLi4vJykgewogICAgICAgIHBhdGhzLnBvcCgpOwogICAgICB9CgogICAgICBwYXRobmFtZSA9IHBhdGhuYW1lLnN1YnN0cmluZyhtWzBdLmxlbmd0aCk7CiAgICAgIG0gPSAvXlwuXC4/XC8vLmV4ZWMocGF0aG5hbWUpOwogICAgfQoKICAgIHBhdGhuYW1lID0gcGF0aHMuY29uY2F0KHBhdGhuYW1lKS5qb2luKHJvb3RSb3V0ZSk7CiAgfQoKICByZXR1cm4gewogICAgaHJlZjogcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoLAogICAgcGF0aG5hbWUsCiAgICBzZWFyY2gsCiAgICBoYXNoCiAgfTsKfTsKZXhwb3J0IGZ1bmN0aW9uIGp1bXBUbyhsaW5rKSB7CiAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgdmFyIHsKICAgIGhyZWYKICB9ID0gbm9ybWFsaXplTGluayh7CiAgICB0bzogbGluawogIH0pOwogIHZhciB7CiAgICBibGFuaywKICAgIHJlcGxhY2UsCiAgICBvcmlnaW4gPSB0cnVlCiAgfSA9IG9wdGlvbjsKCiAgaWYgKC9eaHR0cHM/OlwvXC8vLnRlc3QoaHJlZikpIHsKICAgIGlmIChibGFuaykgewogICAgICB3aW5kb3cub3BlbihocmVmLCAnX2JsYW5rJyk7CiAgICB9IGVsc2UgaWYgKHJlcGxhY2UpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoaHJlZik7CiAgICB9IGVsc2UgewogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGhyZWY7CiAgICB9CgogICAgcmV0dXJuOwogIH0KCiAgaWYgKGJsYW5rKSB7CiAgICB3aW5kb3cub3BlbigiIi5jb25jYXQod2luZG93LmxvY2F0aW9uLm9yaWdpbikuY29uY2F0KGhyZWYpLCAnX2JsYW5rJyk7CiAgfSBlbHNlIHsKICAgIHZhciBtZXRob2QgPSByZXBsYWNlID8gJ3JlcGxhY2UnIDogJ3B1c2gnOyAvLyBUT0RPOiDnoa7lrprmmK/lkKbmnInkuI3pnIDopoHmm7/mjaIgdXJsIOeahOWcuuaZrwoKICAgIGFwcC5yb3V0ZXJIaXN0b3J5W21ldGhvZF0oZ2V0Um91dGVQYXRoKGhyZWYsIG9yaWdpbikpOwogIH0KfQ=="},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/routes/exports.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","cloneDeep","get","isFunction","isPlainObject","app","defLoadPageSchema","rootRoute","logger","isSubStr","retryPromise","loadScriptAsync","deserialize","log","getLogger","requestComponent","getRoutePath","path","origin","routePrefix","constants","currPthStr","currPath","pathStr","withBaseUrl","routePath","replace","RegExp","getCurrRoutePath","window","location","pathname","isLocalFile","url","indexOf","startsWith","getPageFilePath","option","pathToComponent","nodePath","substring","protocol","getPagePreset","_a","filePath","asyncPage","preset","pagePest","require","default","undefined","getPageMockSource","env","isMock","mock","getPageFileAsync","pageAlias","schema","test","error","catch","err","request","method","data","resSchema","pageSchema","getNodePath","defaultPath","normalizeLink","loc","to","toLink","Object","assign","search","hash","searchIdx","hashIdx","isSearch","isHash","relativeBase","paths","split","pop","m","exec","length","concat","join","href","jumpTo","link","blank","open","routerHistory"],"mappings":"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","sourcesContent":["/**\n * 路由相关工具函数\n * TODO: 添加 unit test\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { cloneDeep, get, isFunction, isPlainObject } from 'lodash';\nimport { app } from \"../app\";\nimport { defLoadPageSchema, rootRoute } from \"../constants\";\nimport logger from \"../utils/logger\";\nimport { isSubStr, retryPromise, loadScriptAsync, deserialize } from \"../utils/tool\";\nconst log = logger.getLogger('lib:routes:exports');\nconst requestComponent = 'request://pathToComponent';\n// 计算 路由 path\nexport function getRoutePath(path, origin = false) {\n    const routePrefix = app.constants.routePrefix || rootRoute;\n    const currPthStr = currPath(path);\n    const pathStr = `${rootRoute}${currPthStr}`;\n    const withBaseUrl = isSubStr(pathStr, routePrefix, 0);\n    let routePath = `${withBaseUrl ? rootRoute : routePrefix}${currPthStr}`;\n    if (origin) {\n        routePath = pathStr.replace(new RegExp(`^${routePrefix}`), rootRoute);\n    }\n    return routePath;\n}\nexport function getCurrRoutePath() {\n    return getRoutePath(window.location.pathname, true);\n}\n// 判断是否是本地文件地址\nfunction isLocalFile(url) {\n    return !(url.indexOf('://') > -1 || url.startsWith('//'));\n}\n// 获取 pages 内组件文件在项目内本地的相对路径 或者 远程服务器路径，\nexport function getPageFilePath(option) {\n    const { pathToComponent, nodePath = '', path = '' } = option;\n    // pathToComponent 为 reqOpt 时， 直接返回 一个 固定标示字符串\n    if (isPlainObject(pathToComponent) && get(pathToComponent, 'url')) {\n        return requestComponent;\n    }\n    const url = typeof pathToComponent === 'string' // 任意路径\n        ? pathToComponent\n        : pathToComponent === true // pathToComponent 默认 使用 nodePath 如果设置为 true,表示 使用  path 路径\n            ? path || nodePath\n            : nodePath || path;\n    // 本地文件路径\n    if (isLocalFile(url)) {\n        return currPath(url);\n    }\n    // 当前域名服务器下路径\n    if (url.startsWith('root://')) {\n        return window.location.origin + url.substring(6);\n    }\n    // 远程服务器下 路径\n    if (url.startsWith('http://') || url.startsWith('https://')) {\n        return url;\n    }\n    // 宽泛协议\n    if (url.startsWith('//')) {\n        return window.location.protocol + url;\n    }\n    return '';\n}\n// 获取 页面预设值。默认为  pages/xxx/preset.ts 该文件是权限设置必须文件\nexport function getPagePreset(option) {\n    var _a;\n    const filePath = getPageFilePath(option);\n    if (((_a = app.asyncPage) === null || _a === void 0 ? void 0 : _a.preset) && option.nodePath && app.asyncPage.preset[option.nodePath]) {\n        return cloneDeep(app.asyncPage.preset[option.nodePath]);\n    }\n    // 加载本地文件\n    if (isLocalFile(filePath)) {\n        try {\n            /* webpackInclude: /pages[\\\\/].*[\\\\/]preset\\.[t|j]sx?$/ */\n            const pagePest = require(`~/pages/${filePath}/preset`).default;\n            return isFunction(pagePest) ? pagePest(option) : pagePest;\n        }\n        catch (e) {\n            //\n        }\n    }\n    return undefined;\n}\n// 获取 mock。默认为  pages/xxx/mock.ts 存在该文件，将自动注入mock到prest每一个 api\nexport function getPageMockSource(option) {\n    var _a;\n    if (!app.env.isMock) {\n        return undefined;\n    }\n    if (((_a = app.asyncPage) === null || _a === void 0 ? void 0 : _a.mock) && option.nodePath && app.asyncPage.mock[option.nodePath]) {\n        return cloneDeep(app.asyncPage.mock[option.nodePath]);\n    }\n    const filePath = getPageFilePath(option);\n    // 加载本地文件\n    if (isLocalFile(filePath)) {\n        try {\n            /* webpackInclude: /pages[\\\\/].*[\\\\/]mock\\.[t|j]sx?$/ */\n            const pagePest = require(`~/pages/${filePath}/mock`);\n            return pagePest.default;\n        }\n        catch (e) {\n            //\n        }\n    }\n    return undefined;\n}\n// 异步获取页面文件\nexport function getPageFileAsync(option) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n        const filePath = getPageFilePath(option);\n        // TODO: 支持传入 页面出错 自定义 schema，并将注入参数\n        const pageAlias = option.nodePath;\n        // 加载本地文件\n        if (isLocalFile(filePath)) {\n            return retryPromise(() => import(\n            /* webpackInclude: /[\\\\/]src[\\\\/]pages[\\\\/].*[\\\\/]index\\.[t|j]sx?$/ */\n            /* webpackChunkName: \"p_[request]\" */\n            `~/pages/${filePath}/index`));\n        }\n        if (!pageAlias) {\n            return defLoadPageSchema;\n        }\n        if (((_a = app.asyncPage) === null || _a === void 0 ? void 0 : _a.schema) && app.asyncPage.schema[pageAlias]) {\n            return cloneDeep(app.asyncPage.schema[pageAlias]);\n        }\n        // 动态渲染页面\n        return retryPromise(() => {\n            var _a;\n            app.asyncPage.schema = ((_a = app.asyncPage) === null || _a === void 0 ? void 0 : _a.schema) || {};\n            // 异步加载脚本，规范 window.ovine.addPageSchemaJs(option.nodePath, {default?,schema})\n            if (/\\.js/.test(filePath)) {\n                return loadScriptAsync(filePath)\n                    .then(() => {\n                    if (!app.asyncPage.schema[pageAlias]) {\n                        log.error(`Please add page schema for \"${pageAlias}\" by using 'window.ovine.addPageSchemaJs()'.`);\n                        return defLoadPageSchema;\n                    }\n                    return cloneDeep(app.asyncPage.schema[pageAlias]);\n                })\n                    .catch((err) => {\n                    log.error('An error occurred by load js scripts.', err);\n                    return defLoadPageSchema;\n                });\n            }\n            // 接口获取  schema, 不缓存页面\n            return app\n                .request(filePath === requestComponent\n                ? option.pathToComponent\n                : {\n                    method: 'GET',\n                    url: filePath,\n                })\n                .then(({ data }) => {\n                const { schema: resSchema } = (data === null || data === void 0 ? void 0 : data.data) || {};\n                const schema = isPlainObject(resSchema) ? resSchema : deserialize(resSchema || '');\n                if (!schema) {\n                    log.error(`Please add page schema string for \"${pageAlias}\" by http server api.`);\n                    return defLoadPageSchema;\n                }\n                const pageSchema = { schema };\n                return pageSchema;\n            })\n                .catch((err) => {\n                log.error('An error occurred when fetch page schema.', err);\n                return defLoadPageSchema;\n            });\n        });\n    });\n}\n// 获取 nodePath\nexport function getNodePath(option) {\n    return option.nodePath || getPageFilePath(option);\n}\n// 当前路径,去除多余前缀/,保持一致性  /login ==> login\nexport function currPath(path, defaultPath = '') {\n    if (!path || path === rootRoute) {\n        return defaultPath;\n    }\n    return !isSubStr(path, rootRoute, 0) ? path : path.substring(1);\n}\n// amis 官方 格式化项目内 链接\nexport const normalizeLink = (option) => {\n    const { location: loc = window.location, to: toLink } = option;\n    const location = Object.assign({ pathname: rootRoute, search: '', hash: '' }, loc);\n    let to = toLink || '';\n    if (to && to[0] === '#') {\n        to = location.pathname + location.search + to;\n    }\n    else if (to && to[0] === '?') {\n        to = location.pathname + to;\n    }\n    const searchIdx = to.indexOf('?');\n    const hashIdx = to.indexOf('#');\n    const isSearch = searchIdx > -1;\n    const isHash = hashIdx > -1;\n    let pathname = isSearch ? to.substring(0, searchIdx) : isHash ? to.substring(0, hashIdx) : to;\n    const search = isSearch ? to.substring(searchIdx, isHash ? hashIdx : undefined) : '';\n    const hash = isHash ? to.substring(hashIdx) : location.hash;\n    if (!pathname) {\n        pathname = location.pathname;\n    }\n    else if (pathname[0] !== rootRoute && !/^https?:\\/\\//.test(pathname)) {\n        const relativeBase = location.pathname;\n        const paths = relativeBase.split(rootRoute);\n        paths.pop();\n        let m = /^\\.\\.?\\//.exec(pathname);\n        while (m) {\n            if (m[0] === '../') {\n                paths.pop();\n            }\n            pathname = pathname.substring(m[0].length);\n            m = /^\\.\\.?\\//.exec(pathname);\n        }\n        pathname = paths.concat(pathname).join(rootRoute);\n    }\n    return {\n        href: pathname + search + hash,\n        pathname,\n        search,\n        hash,\n    };\n};\nexport function jumpTo(link, option = {}) {\n    const { href } = normalizeLink({ to: link });\n    const { blank, replace, origin = true } = option;\n    if (/^https?:\\/\\//.test(href)) {\n        if (blank) {\n            window.open(href, '_blank');\n        }\n        else if (replace) {\n            window.location.replace(href);\n        }\n        else {\n            window.location.href = href;\n        }\n        return;\n    }\n    if (blank) {\n        window.open(`${window.location.origin}${href}`, '_blank');\n    }\n    else {\n        const method = replace ? 'replace' : 'push';\n        // TODO: 确定是否有不需要替换 url 的场景\n        app.routerHistory[method](getRoutePath(href, origin));\n    }\n}\n"]}]}