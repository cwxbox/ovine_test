{"remainingRequest":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js??ref--4-1!C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\amis\\schema\\index.js","dependencies":[{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\@ovine\\core\\lib\\components\\amis\\schema\\index.js","mtime":1618319234665},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616400859944},{"path":"C:\\Users\\cwx\\Desktop\\editor-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1617798315061}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:KGZ1bmN0aW9uICgpIHsKICB2YXIgZW50ZXJNb2R1bGUgPSB0eXBlb2YgcmVhY3RIb3RMb2FkZXJHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gcmVhY3RIb3RMb2FkZXJHbG9iYWwuZW50ZXJNb2R1bGUgOiB1bmRlZmluZWQ7CiAgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsKfSkoKTsKCnZhciBfX3NpZ25hdHVyZV9fID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmRlZmF1bHQuc2lnbmF0dXJlIDogZnVuY3Rpb24gKGEpIHsKICByZXR1cm4gYTsKfTsKCmltcG9ydCB7IGlzRW1wdHksIGNsb25lRGVlcCwgaXNPYmplY3QgfSBmcm9tICdsb2Rhc2gnOwppbXBvcnQgUmVhY3QsIHsgdXNlTWVtbywgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBUaGVtZUNvbnN1bWVyIH0gZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnOwppbXBvcnQgeyBhcHAgfSBmcm9tICIuLi8uLi8uLi9hcHAiOwppbXBvcnQgeyB1c2VBcHBDb250ZXh0IH0gZnJvbSAiLi4vLi4vYXBwL2NvbnRleHQiOwppbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAiLi4vLi4vLi4vY29uc3RhbnRzIjsKaW1wb3J0IHsgZ2V0R2xvYmFsLCBzZXRHbG9iYWwgfSBmcm9tICIuLi8uLi8uLi91dGlscy9zdG9yZSI7CmltcG9ydCBBbWlzQ29tcG9uZW50IGZyb20gIi4vYW1pcyI7CmltcG9ydCB7IHJlc29sdmVMaWJTY2hlbWEsIHdyYXBDc3MgfSBmcm9tICIuL2Z1bmMiOyAvLyDmlofmoaMgaHR0cHM6Ly9iYWlkdS5naXRodWIuaW8vYW1pcy9kb2NzL3N0YXJ0L2dldHRpbmctc3RhcnRlZAovLyDmupDnoIEgaHR0cHM6Ly9naXRodWIuY29tL2JhaWR1L2FtaXMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvY29tcG9uZW50cy9BcHAuanN4CgpleHBvcnQgdmFyIEFtaXMgPSBwcm9wcyA9PiB7CiAgdmFyIHsKICAgIHNjaGVtYTogcmF3U2NoZW1hLAogICAgcHJvcHM6IGFtaXNQcm9wcyA9IHt9LAogICAgb3B0aW9uID0ge30KICB9ID0gcHJvcHM7CiAgdmFyIGNvZGVTdG9yZSA9IGdldEdsb2JhbChzdG9yYWdlLmRldi5jb2RlKSB8fCB7fTsKICB2YXIgewogICAgZW5hYmxlUm91dGVUYWJzLAogICAgbG9jYWxlCiAgfSA9IHVzZUFwcENvbnRleHQoKTsgLy8g5pS55Y+Y5Zu65a6a55qE6auY5bqmCiAgLy8gQHRzLWlnbm9yZQoKICBpZiAoIWFtaXNQcm9wcy5hZmZpeE9mZnNldFRvcCAmJiBnZXRHbG9iYWwoc3RvcmFnZS5zdXBwb3J0Um91dGVUYWJzKSkgewogICAgLy8gQHRzLWlnbm9yZQogICAgYW1pc1Byb3BzLmFmZml4T2Zmc2V0VG9wID0gZW5hYmxlUm91dGVUYWJzID8gMTAwIDogNTA7CiAgfQoKICB1c2VFZmZlY3QoKCkgPT4gewogICAgcmV0dXJuICgpID0+IHsKICAgICAgaWYgKGNvZGVTdG9yZS5lbmFibGUpIHsKICAgICAgICBzZXRHbG9iYWwoc3RvcmFnZS5kZXYuY29kZSwgewogICAgICAgICAgZW5hYmxlOiB0cnVlLAogICAgICAgICAgc2NoZW1hOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9CiAgICB9OwogIH0sIFtdKTsKICB2YXIgZW52U2NoZW1hID0gdXNlTWVtbygoKSA9PiB7CiAgICBpZiAoIXJhd1NjaGVtYSB8fCAhaXNPYmplY3QocmF3U2NoZW1hKSB8fCBpc0VtcHR5KHJhd1NjaGVtYSkpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAnaHRtbCcsCiAgICAgICAgaHRtbDogJ+ivt+S8oOWFpeacieaViOeahCBzY2hlbWEnCiAgICAgIH07CiAgICB9IC8vIEF2b2lkIG1vZGlmeSByYXdTY2hlbWEgb2YgcHJvcHMKCgogICAgdmFyIHNjaGVtYSA9IGNsb25lRGVlcChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHJhd1NjaGVtYSksIHsKICAgICAgLy8gTWVyZ2UgYW1pcyBnbG9iYWwgZGVmaW5pdGlvbnMKICAgICAgY29uc3RhbnRzOiBhcHAuYW1pcy5jb25zdGFudHMsCiAgICAgIGRlZmluaXRpb25zOiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGFwcC5hbWlzLmRlZmluaXRpb25zKSwgcmF3U2NoZW1hLmRlZmluaXRpb25zKQogICAgfSkpOwogICAgdmFyIGxpYlNjaGVtYSA9IHJlc29sdmVMaWJTY2hlbWEod3JhcENzcyhzY2hlbWEpKTsKCiAgICBpZiAoY29kZVN0b3JlLmVuYWJsZSAmJiBzY2hlbWEudHlwZSA9PT0gJ3BhZ2UnKSB7CiAgICAgIHNldEdsb2JhbChzdG9yYWdlLmRldi5jb2RlLCB7CiAgICAgICAgZW5hYmxlOiB0cnVlLAogICAgICAgIHNjaGVtYTogbGliU2NoZW1hCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBsaWJTY2hlbWE7CiAgfSwgW3Jhd1NjaGVtYV0pOwogIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUaGVtZUNvbnN1bWVyLCBudWxsLCB0aGVtZSA9PiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChBbWlzQ29tcG9uZW50LCB7CiAgICBrZXk6IHRoZW1lLm5hbWUsCiAgICBvcHRpb246IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9uKSwgewogICAgICB0aGVtZTogdGhlbWUubmFtZSwKICAgICAgbG9jYWxlCiAgICB9KSwKICAgIHNjaGVtYTogZW52U2NoZW1hLAogICAgcHJvcHM6IGFtaXNQcm9wcwogIH0pKTsKfTsKCl9fc2lnbmF0dXJlX18oQW1pcywgInVzZUFwcENvbnRleHR7eyBlbmFibGVSb3V0ZVRhYnMsIGxvY2FsZSB9fVxudXNlRWZmZWN0e31cbnVzZU1lbW97ZW52U2NoZW1hfSIsICgpID0+IFt1c2VBcHBDb250ZXh0XSk7Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciByZWFjdEhvdExvYWRlciA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5kZWZhdWx0IDogdW5kZWZpbmVkOwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihBbWlzLCAiQW1pcyIsICJDOlxcVXNlcnNcXGN3eFxcRGVza3RvcFxcZWRpdG9yLWRlbW9cXG5vZGVfbW9kdWxlc1xcQG92aW5lXFxjb3JlXFxsaWJcXGNvbXBvbmVudHNcXGFtaXNcXHNjaGVtYVxcaW5kZXguanMiKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmxlYXZlTW9kdWxlIDogdW5kZWZpbmVkOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["C:/Users/cwx/Desktop/editor-demo/node_modules/@ovine/core/lib/components/amis/schema/index.js"],"names":["isEmpty","cloneDeep","isObject","React","useMemo","useEffect","ThemeConsumer","app","useAppContext","storage","getGlobal","setGlobal","AmisComponent","resolveLibSchema","wrapCss","Amis","props","schema","rawSchema","amisProps","option","codeStore","dev","code","enableRouteTabs","locale","affixOffsetTop","supportRouteTabs","enable","envSchema","type","html","Object","assign","constants","amis","definitions","libSchema","createElement","theme","key","name"],"mappings":"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","sourcesContent":["import { isEmpty, cloneDeep, isObject } from 'lodash';\nimport React, { useMemo, useEffect } from 'react';\nimport { ThemeConsumer } from 'styled-components';\nimport { app } from \"../../../app\";\nimport { useAppContext } from \"../../app/context\";\nimport { storage } from \"../../../constants\";\nimport { getGlobal, setGlobal } from \"../../../utils/store\";\nimport AmisComponent from \"./amis\";\nimport { resolveLibSchema, wrapCss } from \"./func\";\n// 文档 https://baidu.github.io/amis/docs/start/getting-started\n// 源码 https://github.com/baidu/amis/blob/master/examples/components/App.jsx\nexport const Amis = (props) => {\n    const { schema: rawSchema, props: amisProps = {}, option = {} } = props;\n    const codeStore = getGlobal(storage.dev.code) || {};\n    const { enableRouteTabs, locale } = useAppContext();\n    // 改变固定的高度\n    // @ts-ignore\n    if (!amisProps.affixOffsetTop && getGlobal(storage.supportRouteTabs)) {\n        // @ts-ignore\n        amisProps.affixOffsetTop = enableRouteTabs ? 100 : 50;\n    }\n    useEffect(() => {\n        return () => {\n            if (codeStore.enable) {\n                setGlobal(storage.dev.code, {\n                    enable: true,\n                    schema: false,\n                });\n            }\n        };\n    }, []);\n    const envSchema = useMemo(() => {\n        if (!rawSchema || !isObject(rawSchema) || isEmpty(rawSchema)) {\n            return {\n                type: 'html',\n                html: '请传入有效的 schema',\n            };\n        }\n        // Avoid modify rawSchema of props\n        const schema = cloneDeep(Object.assign(Object.assign({}, rawSchema), { \n            // Merge amis global definitions\n            constants: app.amis.constants, definitions: Object.assign(Object.assign({}, app.amis.definitions), rawSchema.definitions) }));\n        const libSchema = resolveLibSchema(wrapCss(schema));\n        if (codeStore.enable && schema.type === 'page') {\n            setGlobal(storage.dev.code, {\n                enable: true,\n                schema: libSchema,\n            });\n        }\n        return libSchema;\n    }, [rawSchema]);\n    return (React.createElement(ThemeConsumer, null, (theme) => (React.createElement(AmisComponent, { key: theme.name, option: Object.assign(Object.assign({}, option), { theme: theme.name, locale }), schema: envSchema, props: amisProps }))));\n};\n"]}]}